/*!
 * messenger
 * @version: 2.5.3
 * @license: Genesys Telecom Labs
 */
(("undefined"!=typeof self?self:this).webpackJsonp_Messenger=("undefined"!=typeof self?self:this).webpackJsonp_Messenger||[]).push([[31],{216:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(14),o=window.newrelic||{},a=o&&Object.keys(o).length;function i(){return{messengerOpen:function(){if(a)return o.interaction().setName(r.K).save()},conversationSetup:function(){if(a)return o.interaction().setName(r.j).save()},conversationRestore:function(){if(a)return o.interaction().setName(r.i).save()},fetchPreviousMessages:function(){if(a)return o.interaction().setName(r.o).save()},sendMessageRoundTrip:function(){if(a)return o.interaction().setName(r.E).save()},autoStart:function(){if(a)return o.interaction().setName(r.g).save()},autoStartFirstSystemMessage:function(){if(a)return o.interaction().setName(r.h).save()},messageReceivedOutOfOrder:function(){if(a)return o.interaction().setName(r.D).save()},sessionCleared:function(){if(a)return o.interaction().setName(r.N).save()}}}},598:function(e,t,n){var r=n(605),o=n(606),a=n(105),i=n(607);e.exports=function(e){return r(e)||o(e)||a(e)||i()},e.exports.__esModule=!0,e.exports.default=e.exports},600:function(e,t,n){e.exports=n(420)(1)},601:function(e,t,n){e.exports=n(420)(0)},602:function(e,t,n){var r=n(332),o=n(616);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var a={insert:"head",singleton:!1};r(o,a);e.exports=o.locals||{}},603:function(e,t,n){"use strict";e.exports=n(604)},604:function(e,t,n){"use strict";
/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=60103,o=60106,a=60107,i=60108,s=60114,c=60109,l=60110,u=60112,d=60113,p=60120,g=60115,f=60116,m=60121,h=60122,b=60117,v=60129,y=60131;if("function"==typeof Symbol&&Symbol.for){var x=Symbol.for;r=x("react.element"),o=x("react.portal"),a=x("react.fragment"),i=x("react.strict_mode"),s=x("react.profiler"),c=x("react.provider"),l=x("react.context"),u=x("react.forward_ref"),d=x("react.suspense"),p=x("react.suspense_list"),g=x("react.memo"),f=x("react.lazy"),m=x("react.block"),h=x("react.server.block"),b=x("react.fundamental"),v=x("react.debug_trace_mode"),y=x("react.legacy_hidden")}function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case a:case s:case i:case d:case p:return e;default:switch(e=e&&e.$$typeof){case l:case u:case f:case g:case c:return e;default:return t}}case o:return t}}}var O=c,S=r,E=u,C=a,k=f,R=g,T=o,j=s,D=i,P=d;t.ContextConsumer=l,t.ContextProvider=O,t.Element=S,t.ForwardRef=E,t.Fragment=C,t.Lazy=k,t.Memo=R,t.Portal=T,t.Profiler=j,t.StrictMode=D,t.Suspense=P,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return w(e)===l},t.isContextProvider=function(e){return w(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===u},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===f},t.isMemo=function(e){return w(e)===g},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===i},t.isSuspense=function(e){return w(e)===d},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===s||e===v||e===i||e===d||e===p||e===y||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===g||e.$$typeof===c||e.$$typeof===l||e.$$typeof===u||e.$$typeof===b||e.$$typeof===m||e[0]===h)},t.typeOf=w},605:function(e,t,n){var r=n(106);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},606:function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},607:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},608:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isImmutable,n=void 0===t?a.default:t,s=e.ignore,u=i.default.bind(null,n,s);return function(e){var t=e.getState,n=t(),a=u(n),i=void 0;return function(e){return function(s){n=t(),i=a.detectMutations(),a=u(n),(0,r.default)(!i.wasMutated,c,(i.path||[]).join("."));var d=e(s);return n=t(),i=a.detectMutations(),a=u(n),i.wasMutated&&(0,r.default)(!i.wasMutated,l,(i.path||[]).join("."),(0,o.default)(s)),d}}}};var r=s(n(609)),o=s(n(610)),a=s(n(611)),i=s(n(612));function s(e){return e&&e.__esModule?e:{default:e}}var c=["A state mutation was detected between dispatches, in the path `%s`.","This may cause incorrect behavior.","(http://redux.js.org/docs/Troubleshooting.html#never-mutate-reducer-arguments)"].join(" "),l=["A state mutation was detected inside a dispatch, in the path: `%s`.","Take a look at the reducer(s) handling the action %s.","(http://redux.js.org/docs/Troubleshooting.html#never-mutate-reducer-arguments)"].join(" ")},609:function(e,t,n){"use strict";e.exports=function(e,t,n,r,o,a,i,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,o,a,i,s],u=0;(c=new Error(t.replace(/%s/g,(function(){return l[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},610:function(e,t){function n(e,t){var n=[],r=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(t)).join(".")+"]"}),function(o,a){if(n.length>0){var i=n.indexOf(this);~i?n.splice(i+1):n.push(this),~i?r.splice(i,1/0,o):r.push(o),~n.indexOf(a)&&(a=t.call(this,o,a))}else n.push(a);return null==e?a:e.call(this,o,a)}}(e.exports=function(e,t,r,o){return JSON.stringify(e,n(t,o),r)}).getSerialize=n},611:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e){return"object"!==(void 0===e?"undefined":r(e))||null==e}},612:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a={value:r};if(!t(r))for(var i in a.children={},r){var s=o.concat(i);n.length&&-1!==n.indexOf(s.join("."))||(a.children[i]=e(t,n,r[i],s))}return a}(e,t,n);return{detectMutations:function(){return function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2],o=arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=r?r.value:void 0,c=s===o;if(a&&!c&&!Number.isNaN(o))return{wasMutated:!0,path:i};if(t(s)||t(o))return{wasMutated:!1};var l={};Object.keys(r.children).forEach((function(e){l[e]=!0})),Object.keys(o).forEach((function(e){l[e]=!0}));for(var u=Object.keys(l),d=0;d<u.length;d++){var p=u[d],g=i.concat(p);if(!n.length||-1===n.indexOf(g.join("."))){var f=e(t,n,r.children[p],o[p],c,g);if(f.wasMutated)return f}}return{wasMutated:!1}}(e,t,r,n)}}}},613:function(e,t,n){var r=n(332),o=n(614);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var a={insert:"head",singleton:!1};r(o,a);e.exports=o.locals||{}},614:function(e,t,n){(t=n(333)(!1)).push([e.i,".mxg-home .mxg-home-card h2{font-size:1.1rem}",""]),e.exports=t},615:function(e,t){},616:function(e,t,n){(t=n(333)(!1)).push([e.i,".mxg-conversation{height:100%;border-radius:0px}.mxg-conversation .mxg-conversation-container{background-color:inherit}.mxg-conversation .mxg-conversation-container .mxg-input-container{position:absolute;bottom:0px;left:0px;width:100%;overflow-y:auto;height:auto;max-height:40%;background-color:inherit;z-index:1}.mxg-conversation .mxg-conversation-container .mxg-input-container .mxg-send-icon{float:right}.mxg-conversation .mxg-conversation-container .mxg-transcript a{color:inherit}.mxg-typing-indicator-dot{height:6px;width:6px;border-radius:100%;display:inline-block;margin:1px;animation:1.5s typing-dot ease-in-out infinite;animation-delay:calc(var(--animation-order)*150ms)}@keyframes typing-dot{15%{transform:translateY(-35%);opacity:.5}30%{transform:translateY(0%);opacity:1}}",""]),e.exports=t},640:function(e,t,n){"use strict";n.r(t);var r=n(49),o=n.n(r),a=n(50),i=n.n(a),s=n(17),c=n.n(s),l=n(66),u=n.n(l),d=n(67),p=n.n(d),g=n(39),f=n.n(g),m=n(11),h=n.n(m),b=n(0),v=n.n(b),y=n(7),x=n.n(y),w=v.a.createContext(null);var O=function(e){e()};function S(){var e=O,t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,o=n={callback:e,next:null,prev:n};return o.prev?o.prev.next=o:t=o,function(){r&&null!==t&&(r=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}var E={notify:function(){},get:function(){return[]}};function C(e,t){var n,r=E;function o(){i.onStateChange&&i.onStateChange()}function a(){n||(n=t?t.addNestedSub(o):e.subscribe(o),r=S())}var i={addNestedSub:function(e){return a(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return Boolean(n)},trySubscribe:a,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=E)},getListeners:function(){return r}};return i}var k="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?b.useLayoutEffect:b.useEffect;var R=function(e){var t=e.store,n=e.context,r=e.children,o=Object(b.useMemo)((function(){var e=C(t);return{store:t,subscription:e}}),[t]),a=Object(b.useMemo)((function(){return t.getState()}),[t]);k((function(){var e=o.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),a!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[o,a]);var i=n||w;return v.a.createElement(i.Provider,{value:o},r)},T=n(1),j=n(5),D=n(92),P=n.n(D),M=n(603),A=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],I=["reactReduxForwardedRef"],N=[],F=[null,null];function L(e,t){var n=e[1];return[t.payload,n+1]}function B(e,t,n){k((function(){return e.apply(void 0,t)}),n)}function H(e,t,n,r,o,a,i){e.current=r,t.current=o,n.current=!1,a.current&&(a.current=null,i())}function K(e,t,n,r,o,a,i,s,c,l){if(e){var u=!1,d=null,p=function(){if(!u){var e,n,p=t.getState();try{e=r(p,o.current)}catch(e){n=e,d=e}n||(d=null),e===a.current?i.current||c():(a.current=e,s.current=e,i.current=!0,l({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=p,n.trySubscribe(),p();return function(){if(u=!0,n.tryUnsubscribe(),n.onStateChange=null,d)throw d}}}var z=function(){return[null,0]};function q(e,t){void 0===t&&(t={});var n=t,r=n.getDisplayName,o=void 0===r?function(e){return"ConnectAdvanced("+e+")"}:r,a=n.methodName,i=void 0===a?"connectAdvanced":a,s=n.renderCountProp,c=void 0===s?void 0:s,l=n.shouldHandleStateChanges,u=void 0===l||l,d=n.storeKey,p=void 0===d?"store":d,g=(n.withRef,n.forwardRef),f=void 0!==g&&g,m=n.context,h=void 0===m?w:m,y=Object(j.a)(n,A),x=h;return function(t){var n=t.displayName||t.name||"Component",r=o(n),a=Object(T.a)({},y,{getDisplayName:o,methodName:i,renderCountProp:c,shouldHandleStateChanges:u,storeKey:p,displayName:r,wrappedComponentName:n,WrappedComponent:t}),s=y.pure;var l=s?b.useMemo:function(e){return e()};function d(n){var r=Object(b.useMemo)((function(){var e=n.reactReduxForwardedRef,t=Object(j.a)(n,I);return[n.context,e,t]}),[n]),o=r[0],i=r[1],s=r[2],c=Object(b.useMemo)((function(){return o&&o.Consumer&&Object(M.isContextConsumer)(v.a.createElement(o.Consumer,null))?o:x}),[o,x]),d=Object(b.useContext)(c),p=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(d)&&Boolean(d.store);var g=p?n.store:d.store,f=Object(b.useMemo)((function(){return function(t){return e(t.dispatch,a)}(g)}),[g]),m=Object(b.useMemo)((function(){if(!u)return F;var e=C(g,p?null:d.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[g,p,d]),h=m[0],y=m[1],w=Object(b.useMemo)((function(){return p?d:Object(T.a)({},d,{subscription:h})}),[p,d,h]),O=Object(b.useReducer)(L,N,z),S=O[0][0],E=O[1];if(S&&S.error)throw S.error;var k=Object(b.useRef)(),R=Object(b.useRef)(s),D=Object(b.useRef)(),P=Object(b.useRef)(!1),A=l((function(){return D.current&&s===R.current?D.current:f(g.getState(),s)}),[g,S,s]);B(H,[R,k,P,s,A,D,y]),B(K,[u,g,h,f,R,k,P,D,y,E],[g,h,f]);var q=Object(b.useMemo)((function(){return v.a.createElement(t,Object(T.a)({},A,{ref:i}))}),[i,t,A]);return Object(b.useMemo)((function(){return u?v.a.createElement(c.Provider,{value:w},q):q}),[c,q,w])}var g=s?v.a.memo(d):d;if(g.WrappedComponent=t,g.displayName=d.displayName=r,f){var m=v.a.forwardRef((function(e,t){return v.a.createElement(g,Object(T.a)({},e,{reactReduxForwardedRef:t}))}));return m.displayName=r,m.WrappedComponent=t,P()(m,t)}return P()(g,t)}}function U(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function _(e,t){if(U(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!Object.prototype.hasOwnProperty.call(t,n[o])||!U(e[n[o]],t[n[o]]))return!1;return!0}function W(e){return function(t,n){var r=e(t,n);function o(){return r}return o.dependsOnOwnProps=!1,o}}function V(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function G(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=V(e);var o=r(t,n);return"function"==typeof o&&(r.mapToProps=o,r.dependsOnOwnProps=V(o),o=r(t,n)),o},r}}var $=[function(e){return"function"==typeof e?G(e):void 0},function(e){return e?void 0:W((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?W((function(t){return function(e,t){var n={},r=function(r){var o=e[r];"function"==typeof o&&(n[r]=function(){return t(o.apply(void 0,arguments))})};for(var o in e)r(o);return n}(e,t)})):void 0}];var Y=[function(e){return"function"==typeof e?G(e):void 0},function(e){return e?void 0:W((function(){return{}}))}];function Q(e,t,n){return Object(T.a)({},n,e,t)}var X=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var r,o=n.pure,a=n.areMergedPropsEqual,i=!1;return function(t,n,s){var c=e(t,n,s);return i?o&&a(c,r)||(r=c):(i=!0,r=c),r}}}(e):void 0},function(e){return e?void 0:function(){return Q}}];var J=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function Z(e,t,n,r){return function(o,a){return n(e(o,a),t(r,a),a)}}function ee(e,t,n,r,o){var a,i,s,c,l,u=o.areStatesEqual,d=o.areOwnPropsEqual,p=o.areStatePropsEqual,g=!1;function f(o,g){var f,m,h=!d(g,i),b=!u(o,a,g,i);return a=o,i=g,h&&b?(s=e(a,i),t.dependsOnOwnProps&&(c=t(r,i)),l=n(s,c,i)):h?(e.dependsOnOwnProps&&(s=e(a,i)),t.dependsOnOwnProps&&(c=t(r,i)),l=n(s,c,i)):b?(f=e(a,i),m=!p(f,s),s=f,m&&(l=n(s,c,i)),l):l}return function(o,u){return g?f(o,u):(s=e(a=o,i=u),c=t(r,i),l=n(s,c,i),g=!0,l)}}function te(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,o=t.initMergeProps,a=Object(j.a)(t,J),i=n(e,a),s=r(e,a),c=o(e,a);return(a.pure?ee:Z)(i,s,c,e,a)}var ne=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function re(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function oe(e,t){return e===t}function ae(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?q:n,o=t.mapStateToPropsFactories,a=void 0===o?Y:o,i=t.mapDispatchToPropsFactories,s=void 0===i?$:i,c=t.mergePropsFactories,l=void 0===c?X:c,u=t.selectorFactory,d=void 0===u?te:u;return function(e,t,n,o){void 0===o&&(o={});var i=o,c=i.pure,u=void 0===c||c,p=i.areStatesEqual,g=void 0===p?oe:p,f=i.areOwnPropsEqual,m=void 0===f?_:f,h=i.areStatePropsEqual,b=void 0===h?_:h,v=i.areMergedPropsEqual,y=void 0===v?_:v,x=Object(j.a)(i,ne),w=re(e,a,"mapStateToProps"),O=re(t,s,"mapDispatchToProps"),S=re(n,l,"mergeProps");return r(d,Object(T.a)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:w,initMapDispatchToProps:O,initMergeProps:S,pure:u,areStatesEqual:g,areOwnPropsEqual:m,areStatePropsEqual:b,areMergedPropsEqual:y},x))}}var ie=ae();var se,ce=n(38);function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}se=ce.unstable_batchedUpdates,O=se;var ge="function"==typeof Symbol&&Symbol.observable||"@@observable",fe=function(){return Math.random().toString(36).substring(7).split("").join(".")},me={INIT:"@@redux/INIT"+fe(),REPLACE:"@@redux/REPLACE"+fe(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+fe()}};function he(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function be(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(pe(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(pe(1));return n(be)(e,t)}if("function"!=typeof e)throw new Error(pe(2));var o=e,a=t,i=[],s=i,c=!1;function l(){s===i&&(s=i.slice())}function u(){if(c)throw new Error(pe(3));return a}function d(e){if("function"!=typeof e)throw new Error(pe(4));if(c)throw new Error(pe(5));var t=!0;return l(),s.push(e),function(){if(t){if(c)throw new Error(pe(6));t=!1,l();var n=s.indexOf(e);s.splice(n,1),i=null}}}function p(e){if(!he(e))throw new Error(pe(7));if(void 0===e.type)throw new Error(pe(8));if(c)throw new Error(pe(9));try{c=!0,a=o(a,e)}finally{c=!1}for(var t=i=s,n=0;n<t.length;n++){(0,t[n])()}return e}function g(e){if("function"!=typeof e)throw new Error(pe(10));o=e,p({type:me.REPLACE})}function f(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(pe(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[ge]=function(){return this},e}return p({type:me.INIT}),(r={dispatch:p,subscribe:d,getState:u,replaceReducer:g})[ge]=f,r}function ve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var ye=n(598),xe=n.n(ye),we={route:"conversations.home",routeStack:["conversations.home"],messages:[]};function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee={},Ce={};function ke(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we||{},t=arguments.length>1?arguments[1]:void 0,n=xe()(e.routeStack);switch(1==n.length&&Object.keys(Ee)&&Object.keys(Ee).length>1&&(n=xe()(Ee.routeStack)),t.type){case"CONFIRM_CHAT":return-1===n.indexOf(t.route)&&n.push(t.route),Object.assign({},e,{route:t.route,routeStack:n,documentId:""});case"OPEN_CONVERSATIONS":return-1===(n=n.filter((function(e){return-1!==e.indexOf("conversations.home")}))).indexOf(t.route)&&n.push(t.route),Ee=Object.assign({},Ee,{route:t.route,routeStack:n,categoryData:{}}),Object.assign({},e,{route:t.route,routeStack:n,categoryData:{},documentId:""});case"OPEN_KNOWLEDGE_ARTICLE":return-1===n.indexOf(t.route)&&n.push(t.route),Ee=Object.assign({},Ee,{route:t.route,routeStack:n,documentId:t.documentId}),Object.assign({},e,{route:t.route,routeStack:n,documentId:t.documentId});case"OPEN_PREVIEW":return-1===n.indexOf(t.route)&&n.push(t.route),Ee=Object.assign({},Ee,{route:t.route,routeStack:n,file:t.file}),Object.assign({},e,{route:t.route,routeStack:n,file:t.file});case"OPEN_KNOWLEDGE_ARTICLE_DIRECT":return-1===n.indexOf(t.route)&&(-1===n.indexOf("knowledge.search")?n.push("knowledge.search",t.route):n.push(t.route)),Object.assign({},e,{route:t.route,routeStack:n,documentId:t.documentId});case"OPEN_KNOWLEDGE_SEARCH":return-1===(n=n.filter((function(e){return-1!==e.indexOf("conversations.home")}))).indexOf(t.route)&&n.push(t.route),Ee=Object.assign({},Ee,{route:t.route,routeStack:n,categoryData:{},documentId:""}),Object.assign({},e,{route:t.route,routeStack:n,categoryData:{},documentId:"",categoryId:""});case"OPEN_KNOWLEDGE_CATEGORY":var r=t.route.split(".")[2];return n.push(t.route),Ce=Object.assign({},Ce,h()({},r,t.categoryData)),Ee=Object.assign({},Ee,{route:t.route,routeStack:n,categoryData:Ce,categoryId:"",documentId:""}),Object.assign({},e,{route:t.route,routeStack:n,categoryData:Ce,categoryId:"",documentId:""});case"RESET_CATEGORIES":return n=n.filter((function(e){return-1===e.indexOf("knowledge.category")})),Object.assign({},e,{route:"knowledge.search",routeStack:n,categoryData:{},categoryId:"",documentId:""});case"NAVIGATE_TO_HOME":return n=n.filter((function(e){return-1!==e.indexOf("conversations.home")})),Ee=Object.assign({},Ee,{route:n[n.length-1],routeStack:n,categoryData:{},documentId:""}),Object.assign({},e,{route:"conversations.home",routeStack:n,categoryId:"",documentId:""});case"NAVIGATE_BACK":return n.pop(),Ee=Object.assign({},Ee,{route:n[n.length-1],routeStack:n,documentId:"",file:""}),Object.assign({},e,{route:n[n.length-1],routeStack:n,documentId:"",file:""});case"OPEN-WITH-STORE":return Object.assign({},e,Se(Se({},e),Ee));case"CLOSED":return Ee=e,e;default:return e}}function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var je={status:"pending",connection:"",connectionStatus:"",sendingMessage:!1,error:"",messages:[],allowedMediaPresence:!1,allowedFileTypes:[],maxFileSizeInKB:"",typingNotification:{},messageOutofOrderIndex:"",files:{removed:{}},resetSession:!1,readOnly:!1,capabilities:{enableSend:!1},userTyping:!1,bRestoring:!1},De=!1,Pe={inbound:{fileTypes:[{type:"image/jpeg"},{type:"image/gif"},{type:"image/png"}],maxFileSizeKB:10240}},Me={};function Ae(e,t){var n=t.data||{},r=n.messageType,o=n.timestamp,a=(e||{}).messages,i="",s=[t.data].concat(xe()(e.messages.map((function(e){return Object.assign({},e)}))));if(a&&a.length&&r&&"outbound"===r){var c=a[0]&&a[0].timestamp;if(new Date(o)<new Date(c)){var l=s.splice(0,5);l.sort((function(e,t){return new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()})),s=l.concat(s),l.every((function(t,n){var r=e.messages[n]?e.messages[n].timestamp:"";return!r||t.timestamp==r||(i=n,!1)}))}}return Object.assign({},e,Te(Te({},e),{},{sendingMessage:!1,previousStatus:e.status,status:"connected",message:t.data,messages:s,error:"",typingNotification:{},messageOutofOrderIndex:i}))}function Ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te({},je),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONNECTING":return Object.assign({},e,Te(Te({},e),{},{resetSession:!1,readOnly:e.readOnly,previousStatus:e.status,status:"connecting",userTyping:!1,error:"",messageOutofOrderIndex:""}));case"RECONNECTING":return Object.assign({},e,Te(Te({},e),{},{resetSession:!1,readOnly:e.readOnly,previousStatus:e.status,status:"reconnecting",userTyping:!1,error:"",messageOutofOrderIndex:""}));case"CONNECTED":return Object.assign({},e,Te(Te({},e),{},{resetSession:!1,readOnly:e.readOnly,connection:"opened",previousStatus:e.status,status:"connected",sendingMessage:!1,error:"",userTyping:!1,connectionStatus:"online",messageOutofOrderIndex:""}));case"READYTOSEND":return Object.assign({},e,Te(Te({},e),{},{capabilities:{enableSend:!0},userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"RESTORING":return Object.assign({},e,Te(Te({},e),{},{resetSession:!1,readOnly:e.readOnly,previousStatus:e.status,status:"restoring",bRestoring:!0,userTyping:!1,error:"",messageOutofOrderIndex:""}));case"RESTORED":return Object.assign({},e,Te(Te(Te({},e),{},{previousStatus:e.status,status:"restored",bRestoring:!1,messages:t.data.messages,sendingMessage:!1,error:"",userTyping:!1},t.data),{},{messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"REOPEN":var n=[].concat(xe()(t.data.messages),xe()(e.messages.map((function(e){return Object.assign({},e)})))),r=new Set,o=n.filter((function(e){return!r.has(e.timestamp)&&(r.add(e.timestamp),!0)}),r);return Object.assign({},e,Te(Te(Te({},e),{},{previousStatus:e.status,status:"restored",bRestoring:!1,connection:"opened"},t.data),{},{messages:o,sendingMessage:!1,userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"FETCHINGHISTORY":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"fetchingHistory",userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"HISTORYFETCHED":return Object.assign({},e,Te(Te(Te({},e),{},{prevStatus:e.status,status:"historyFetched"},t.data),{},{messages:[].concat(xe()(e.messages.map((function(e){return Object.assign({},e)}))),xe()(t.data.messages)),sendingMessage:!1,userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"HISTORYCOMPLETE":return Object.assign({},e,Te(Te(Te({},e),{},{prevStatus:e.status,status:"historyComplete"},t.data),{},{messages:xe()(e.messages.map((function(e){return Object.assign({},e)}))),sendingMessage:!1,userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"SENDING":return Object.assign({},e,{sendingMessage:"sending",files:{removed:e.files.removed},error:"",typingNotification:{},userTyping:!1,messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly});case"SENDINGTEXTBACK":return Object.assign({},e,{sendingMessage:"sending",error:"",typingNotification:{},userTyping:!1});case"ADDMESSAGES":return e&&"closed"===e.status?Me=Object.assign({},e,Te(Te({},e),{},{files:Te(Te({},e.files),t.data.files),sendingMessage:!1,messages:[].concat(xe()(t.data),xe()(e.messages.map((function(e){return Object.assign({},e)})))),userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly})):Object.assign({},e,Te(Te({},e),{},{sendingMessage:!1,files:Te(Te({},e.files),t.data.files),messages:[].concat(xe()(t.data),xe()(e.messages.map((function(e){return Object.assign({},e)})))),userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"RECEIVED":if(e&&("closed"===e.status||"closed"===e.prevStatus&&"disconnected"===e.status||"disconnected"===e.status)){var a=Ae(e,t);return Me=Object.assign({},a,Te(Te({},a),{},{prevStatus:e.status,status:"closed"}))}return Ae(e,t);case"USERTYPING":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,userTyping:!0,messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"RECEIVEDTYPING":return e&&"closed"===e.status?Me=Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,sendingMessage:!1,status:"closed",typingNotification:t.data,userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly})):Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,sendingMessage:!1,status:"receivedTyping",typingNotification:t.data,userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"RESETTYPING":return e&&"closed"===e.status?Me=Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"closed",typingNotification:{},userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly})):Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"resetTyping",typingNotification:{},userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"DISCONNECTED":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"disconnected",resetSession:!1,readOnly:t.data.readOnly||!1,sendingMessage:!1,files:{removed:{}},error:""}));case"CLOSED":var i=e.connection,s=e.status;return Me="connectionClosed"===s&&"closed"===i?Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,messages:[],files:{removed:{}},status:"closed",sendingMessage:!1,userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly})):Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"closed",sendingMessage:!1,userTyping:!1,messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"REQUESTINGFILE":return Object.assign({},e,{previousStatus:e.status,status:"requestingFile",sendingMessage:!1,files:Te(Te({},e.files),{},{newDownloadUrl:"",downloadUrl:e.files.newDownloadUrl||e.files.downloadUrl}),userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly});case"REFRESHINGFILES":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"refreshingFiles",sendingMessage:!1,userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"REQUESTINGUPLOAD":var c={};return t.data[0]&&(c={name:t.data[0].name,size:t.data[0].size,type:t.data[0].type}),Object.assign({},e,{previousStatus:e.status,status:"requestingUpload",files:Te(Te({removed:Te({},e.files.removed)},c),{},{percentage:0}),sendingMessage:!1,userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly});case"UPLOADAPPROVED":return Object.assign({},e,Te(Te({},e),{},{sendingMessage:!1,previousStatus:e.status,status:"uploadApproved",userTyping:!1,files:Te(Te({},e.files),{},{percentage:0},t.data),messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"FILEUPLOADING":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"uploading",userTyping:!1,files:Te(Te({},e.files),{},{percentage:t.data.percentage}),messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"FILEUPLOADED":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"fileUploaded",userTyping:!1,files:Te(Te({},e.files),{},{percentage:100},t.data),messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"MESSAGESUPDATED":var l=JSON.parse(JSON.stringify(e.messages));return t.data.updatedMessages.forEach((function(e){l.forEach((function(t,n){t.id==e.id&&(l[n]=e)}))})),e&&"closed"===e.status?Me=Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"closed",files:Te(Te({},e.files),t.data.files),sendingMessage:!1,messages:xe()(l),userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly})):Object.assign({},e,Te(Te({},e),{},{sendingMessage:!1,previousStatus:e.status,status:"messagesUpdated",files:Te(Te({},e.files),t.data.files),messages:xe()(l),userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"FILEDELETED":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"fileDeleted",userTyping:!1,files:{removed:t.data},messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"ENDED":return Object.assign({},e,{sendingMessage:!1,error:"",userTyping:!1});case"LOGOUT":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"logout",sendingMessage:!1,files:{removed:{}},messages:[],userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"REAUTHENTICATE":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,userTyping:!1,status:"reAuthenticating",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"READONLY":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"readOnly",resetSession:!1,readOnly:t.data.readOnly}));case"STARTFAILED":return Object.assign({},e,Te(Te({},e),{},{error:t.data,previousStatus:e.status,userTyping:!1,status:"connectionFailed",bRestoring:!1,messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"SENDFAILED":return Object.assign({},e,Te(Te({},e),{},{erro:t.data,previousStatus:e.status,userTyping:!1,sendingMessage:"failed",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"SESSIONEXPIRED":return e&&"closed"===e.status?Me=Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"sessionExpired",resetSession:!1,readOnly:!1,connection:"closed",sendingMessage:!1,files:{removed:{}},capabilities:{enableSend:!1},messages:[],userTyping:!1,error:"",messageOutofOrderIndex:""})):Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"sessionExpired",connection:"closed",resetSession:!1,readOnly:!1,sendingMessage:!1,files:{removed:{}},capabilities:{enableSend:!1},messages:[],userTyping:!1,error:"",messageOutofOrderIndex:""}));case"CONVERSATIONNOTFOUND":return e&&"closed"===e.status?Me=Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"conversationNotFound",connection:"closed",sendingMessage:!1,files:{removed:{}},capabilities:{enableSend:!1},messages:[],userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly})):Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"conversationNotFound",connection:"closed",sendingMessage:!1,files:{removed:{}},capabilities:{enableSend:!1},messages:[],userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"SESSIONCLEARED":var u=t.data||{},d=u.resetSession;return Object.assign({},e,Te(Te({},e),{},{resetSession:d||!1,previousStatus:e.status,connection:d&&"boolean"==typeof d?"closed":e.connection,status:"sessionCleared",sendingMessage:!1,files:{removed:{}},message:{},readOnly:!1,capabilities:{enableSend:!1},messages:[],userTyping:!1,error:"",messageOutofOrderIndex:""}));case"FETCHHISTORYFAILED":return Object.assign({},e,Te(Te({error:t.data},e),{},{previousStatus:e.status,userTyping:!1,status:"fetchHistoryFailed",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"ERROR":var p=t.data.errorKey,g=e.files;switch(p){case"fileTypeInvalid":case"fileSizeZero":case"fileTooLarge":case"fileNameInvalid":case"fileNameTooLong":case"fileContentInvalid":default:g={removed:{}}}return Object.assign({},e,Te(Te({},e),{},{files:g,userTyping:!1,error:t.data,messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"CLEARERROR":return Object.assign({},e,Te(Te({},e),{},{error:""}));case"RESTOREFAILED":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"restoreFailed",bRestoring:!1,sendingMessage:!1,userTyping:!1,error:t.data,messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"PENDING":return Object.assign({},e,Te(Te({},e),{},{previousStatus:e.status,status:"pending",userTyping:!1,error:"",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"OFFLINE":return Object.assign({},e,Te(Te({},e),{},{message:{},previousStatus:e.status,status:"offline",userTyping:!1,connectionStatus:"offline",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"RECONNECTED":return Object.assign({},e,Te(Te({},e),{},{connection:"opened",previousStatus:e.status,status:"connected",userTyping:!1,connectionStatus:"online",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"CONVERSATIONCLEARED":return e&&"closed"===e.status?Me=Object.assign({},e,Te(Te({},e),{},{messages:[],files:{removed:{}},previousStatus:e.status,userTyping:!1,bRestoring:!1,status:"cleared",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly})):Object.assign({},e,Te(Te({},e),{},{messages:[],files:{removed:{}},previousStatus:e.status,userTyping:!1,bRestoring:!1,status:"cleared",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"CONNECTIONCLOSED":return e&&"closed"===e.status?Me=Object.assign({},e,Te(Te({},e),{},{connection:"closed",bRestoring:!1,messages:[],previousStatus:e.status,userTyping:!1,status:"connectionClosed",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly})):Object.assign({},e,Te(Te({},e),{},{connection:"closed",bRestoring:!1,previousStatus:e.status,userTyping:!1,status:"connectionClosed",messageOutofOrderIndex:"",resetSession:!1,readOnly:e.readOnly}));case"OPEN-WITH-STORE":return Object.assign({},e,Te(Te(Te({},e),Me),{},{connection:Me.connection,previousStatus:e.status,userTyping:!1,status:"opened",messageOutofOrderIndex:"",resetSession:!1,readOnly:Me.readOnly}));case"ALLOWEDFILETYPESUPDATED":t.data&&!0===t.data.hasOwnProperty("allowedMedia")?De=!0:t.data&&!1===t.data.hasOwnProperty("allowedMedia")&&(De=!1,t.data.allowedMedia=Pe);var f=t.data||{},m=f.allowedMedia,h=m||{},b=h.inbound,v=b||{},y=v.fileTypes,x=v.maxFileSizeKB,w=[];return y&&y.length&&y.forEach((function(e){var t=(e||{}).type;w.push(t)})),Object.assign({},e,Te(Te({},e),{},{status:"allowedfiletypesupdated",allowedFileTypes:w,maxFileSizeInKB:x,allowedMediaPresence:De}));default:return e}}function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Le={knowledge:{}};function Be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe({},Le)||{},t=arguments.length>1?arguments[1]:void 0;return t.type,e}var He=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{messengerStore:ke(e.messengerStore,t),conversationStore:Ie(e.conversationStore,t),knowledgeStore:Be(e.knowledgeStore,t)}},Ke=n(608),ze=n.n(Ke),qe=n(551);function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function We(e){var t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ve,n=_e({},we);return e&&Object.keys(e).length>0&&(n=_e(_e({},n),e)),be(He,n,t(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(pe(15))},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(o)}));return r=ve.apply(void 0,a)(n.dispatch),de(de({},n),{},{dispatch:r})}}}(qe.default,ze()())))}var Ve=n(32),Ge=n.n(Ve),$e=n(419),Ye=n.n($e),Qe=n(48),Xe=n.n(Qe),Je=n(418),Ze=n.n(Je);const et=e=>new Proxy({},{get:(t,n)=>{if("string"==typeof n)return Object(b.lazy)(()=>e(n).then(e=>({default:e[n]})))}});var tt=n(600);function nt(e){return{type:"OPEN_KNOWLEDGE_SEARCH",route:e.route}}var rt,ot=n(601),at=(n(139),n(374)),it=n(136),st=n(556),ct=n.n(st),lt=n(553),ut=n.n(lt),dt=n(555),pt=n.n(dt),gt=n(554),ft=n.n(gt);function mt(){return(mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var ht=function(e){return b.createElement("svg",mt({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 -960 960 960",fill:"currentColor"},e),rt||(rt=b.createElement("path",{d:"M261-120q-24.75 0-42.375-17.625T201-180v-570h-41v-60h188v-30h264v30h188v60h-41v570q0 24-18 42t-42 18H261zm438-630H261v570h438v-570zM367-266h60v-399h-60v399zm166 0h60v-399h-60v399zM261-750v570-570z"})))},bt=n(254),vt=n.n(bt),yt=n(260),xt=n(4),wt=n(75),Ot=n(16),St=n(585);function Et(e,t){var n=e||{},r=n.direction,o=n.sImageUrl,a=n.bShowHomeIcon,i=t||{},s=i.direction,c=i.sImageUrl,l=i.bShowHomeIcon;return r===s&&o===c&&a===l}var Ct=Object(xt.a)("div")((function(e){e.theme,e.props;return{"&.messenger-logo-row":{display:"flex",flexDirection:"row",alignItems:"center",margin:"auto",padding:"12px 6px 6px 6px",overflow:"hidden"},"& img":{maxHeight:"70px",minHeight:"20px",display:"block",objectFit:"fill",width:"auto",height:"auto"},"& .logo-image-home":{margin:"14px 0px 0px 14px",padding:"6px 6px 2px 6px",maxWidth:"200px"},"& .logo-image-view":{maxWidth:"70px",cursor:"pointer"}}})),kt=function(e){var t="right",n="left";"rtl"===e.direction&&(n="right",t="left");var r=Object(b.useRef)(null),o=Object(b.useState)(!1),a=Ge()(o,2),i=a[0],s=a[1];e.bShowHomeIcon&&e.onImageLoaded&&e.onImageLoaded(!1);var c=function(t){var n=e||{},r=n.route,o=n.navigateToHome;r&&"conversations.home"!==r&&o&&o(t)};return v.a.createElement(St.a,{direction:"backward"==e.slideDirection?t:n,in:!0,appear:null!==e.slideDirection,key:e.route,mountOnEnter:!0,unmountOnExit:!0},v.a.createElement(Ct,{className:"mxg-header-logo-container ".concat(e.bShowHomeIcon?"":"messenger-logo-row")},!i&&v.a.createElement("img",{className:"mxg-header-logo-img ".concat(e.bShowHomeIcon?"logo-image-home":"logo-image-view"),ref:r,src:e.sImageUrl,alt:"Company Logo",role:e.route&&"conversations.home"!==e.route?"link":"",onLoad:function(){setTimeout((function(){r.current&&r.current.naturalWidth>0&&r.current.naturalHeight>0&&e.bShowHomeIcon&&e.onImageLoaded&&e.onImageLoaded(!0)}),100)},onKeyDown:function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||(e.preventDefault(),c(e))},onClick:c,onError:function(e){i||s(!0)},tabIndex:e.route&&"conversations.home"!==e.route?0:-1})))},Rt=v.a.memo(kt,Et),Tt=n(331);function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pt=!1,Mt=Object(xt.a)("div")((function(e){e.theme;return{position:"relative",maxWidth:"90%",marginBottom:"16px",marginLeft:"18px"}})),At=Object(xt.a)("div")((function(e){e.theme;return{position:"absolute",right:"6px",cursor:"pointer",top:"6px"}})),It=Object(xt.a)("div")((function(e){e.theme;var t=e.props,n=e.bFabVisible;return{maxWidth:t.deleteButton&&(Pt||!n&&(t.closeButton||t.backButton))?"65%":"90%",minHeight:t.expand?"86px":"34px",marginTop:"14px",marginBottom:t.expand?"25px":"12px",paddingLeft:t.backButton||t.closeButton?"0px":"16px",transition:"all 100ms ease-out 0s",wordBreak:"break-word",wordWrap:"break-word"}})),Nt=Object(xt.a)("div")((function(e){e.theme;var t,n=e.props;return{cursor:"pointer",position:null!==(t=n.config.homeScreen)&&void 0!==t&&t.enabled&&"conversations.conversations"!==n.route&&"conversations.filePreview"!==n.route?"absolute":"relative",top:"6px",left:"0px"}})),Ft=Object(xt.a)("div")((function(e){e.theme,e.props;var t=e.bFabVisible;return{cursor:"pointer",position:"absolute",top:"6px",right:Pt||!t?"44px":"0px"}})),Lt=Object(xt.a)("div")((function(e){e.theme,e.props;return{cursor:"pointer",position:"relative",top:"6px",left:"0px"}})),Bt=Object(xt.a)("div")((function(e){e.theme;var t,n=e.props;return{"&.mxg-header-main":{display:"flex",flexDirection:"row",overflow:"hidden",padding:"conversations.conversations"==n.route||"conversations.filePreview"==n.route?"0":"knowledge.article"==n.route?"0px 8px 14px 0px":"0px 8px 8px 0px",placeContent:null!==(t=n.config.homeScreen)&&void 0!==t&&t.logoUrl&&"conversations.conversations"!==n.route&&"conversations.filePreview"!==n.route?"center":"flex-start"},"&.mxg-header-home-view":{display:"flex",overflow:"hidden",flexDirection:"column"},"& .mxg-header-subTitle":{paddingBottom:"22px"},"& .mxg-header-collapsed":{height:"64px"}}})),Ht=v.a.forwardRef((function(e,t){var n=e||{},r=n.expandMessenger,o=n.collapseMessenger,a=n.handleNavigation,i=n.route,s=n.isHeaderUpdated,c=n.bTablet,l=n.messengerRef,u=(n.markdownMessages,n.deleteButton),d=Object(Ot.n)(),p=(e||{}).slideDirection,g=Object(Ot.l)();Object(b.useLayoutEffect)((function(){var n=(t||{}).current;i&&"conversations.home"!==i&&s&&s(!1),n&&setTimeout((function(){e.onHeaderUpdated({height:n.offsetHeight})}),200)}));var f=function(t,n){13!==t.which&&32!==t.which||t.ctrlKey||t.shiftKey?9===t.which&&t.shiftKey&&!t.ctrlKey&&(!i||"knowledge.search"!=i&&"knowledge.category"!=i&&"knowledge.article"!=i||(t.preventDefault(),e.homeScreenRef&&e.homeScreenRef.current&&e.homeScreenRef.current.focus())):n(t)},m=Object(b.useState)(!1),h=Ge()(m,2),y=(h[0],h[1],Object(b.useState)(!1)),x=Ge()(y,2),w=x[0],O=x[1],S=function(e){w?(o(),O(!1)):(r(),O(!0)),e.preventDefault()},E=function(e){e.preventDefault(),O(!1),o(),a()},C=function(e){e.preventDefault(),O(!1),o(),a({route:"conversations.home"})};i&&w&&"knowledge.article"!=i&&(O(!1),o());var k,R=e.config||{},T=R.homeScreen,j=R.theme,D=R.fullScreen,P=(j||{}).direction,M=(T||{}).logoUrl,A=[];l&&l.current&&(A=l.current.classList.value.split(" ")),k=!(!M||""==M);var I="conversations.home"===i&&k,N="conversations.conversations"!==i&&"conversations.filePreview"!==i,F="knowledge.article"===i&&!d&&!g,L={width:"26px",height:"26px",display:"flex",alignItems:"inherit",justifyContent:"inherit"},B="";return"conversations.home"===i?B="mxg-home-header":"knowledge.search"!==i&&"knowledge.category"!==i&&"knowledge.article"!==i||(B="mxg-search-header"),Pt=!1,D||A.includes("cx-mxg-tablet-landscape")?Pt=!0:c?Pt=!1:(d||g)&&(Pt=!0),v.a.createElement(at.a,{ref:t,className:"mxg-header ".concat(B),sx:function(t){return{position:"relative!important",borderRadius:"4px 4px 0px 0px",background:t.palette[e.color].main+"!important",color:t.palette[e.color].contrastText+"!important"}}},v.a.createElement(wt.a.Consumer,null,(function(t){t.expandLauncher;var n=t.toggleLauncher,r=t.oDisableInputs,o=t.onHeaderDeleteButtonClick,a=t.bFabVisible;return v.a.createElement(Bt,{className:I?"mxg-header-home-view":"mxg-header-main",props:e},e.backButton&&v.a.createElement(Nt,{props:e},v.a.createElement(yt.a,{color:"inherit",children:v.a.createElement(Tt.a,{icon:ut.a,customStyle:L}),onClick:E,"aria-label":e.ariaBack,tabIndex:0,onKeyDown:function(e){return f(e,E)}})),e.closeButton&&v.a.createElement(Lt,{props:e},v.a.createElement(yt.a,{color:"inherit",children:v.a.createElement(vt.a,{"aria-hidden":"true",alt:"",sx:Dt({},L)}),onClick:E,"aria-label":e.ariaClose,tabIndex:0,onKeyDown:function(e){return f(e,E)}})),k&&N&&v.a.createElement(Rt,{key:M,slideDirection:p,bShowHomeIcon:I,sImageUrl:M,route:i,direction:P,navigateToHome:C,onImageLoaded:s}),v.a.createElement(It,{className:"mxg-heading",props:e,bFabVisible:a},v.a.createElement("div",null,e.showHeaderTitle&&v.a.createElement(it.a,{variant:"h1","aria-label":e.title},e.title),e.showHeaderSubTitle&&v.a.createElement(it.a,{variant:"subtitle2",className:"mxg-header-subTitle",variantMapping:{subtitle2:"h2"},"aria-label":e.subTitle},e.subTitle))),v.a.createElement(At,null,v.a.createElement(v.a.Fragment,null,F&&v.a.createElement(yt.a,{color:"inherit","aria-label":e.ariaExpand,children:w?v.a.createElement(ft.a,{fontSize:"default","aria-hidden":"true",alt:"",sx:Dt({},L)}):v.a.createElement(pt.a,{fontSize:"default","aria-hidden":"true",alt:"",sx:Dt({},L)}),onClick:S}),(Pt||!a)&&v.a.createElement(yt.a,{color:"inherit",children:v.a.createElement(ct.a,{fontSize:"default","aria-hidden":"true",alt:"",sx:Dt({},L)}),"aria-label":e.ariaMinimize,tabIndex:r.bHeaderMinimizeIcon,onClick:function(){return function(e){e()}(n)},onKeyPress:function(t){return function(t,n){13!==t.which&&32!==t.which||t.ctrlKey||t.shiftKey||(t.preventDefault(),n({launcherRef:e.launcherRef},t))}(t,n)}}))),u&&v.a.createElement(Ft,{props:e,bFabVisible:a},v.a.createElement(yt.a,{color:"inherit",children:v.a.createElement(ht,{style:Dt({},L)}),onClick:o,"aria-label":e.ariaDeleteLabel,tabIndex:0,title:e.ariaDeleteTitle,onKeyPress:function(e){return function(e,t){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||(e.preventDefault(),t())}(e,o)}})))})),!!e.children&&v.a.createElement(Mt,null,e.children))}));Ht.propTypes={title:x.a.string,subTitle:x.a.string,ariaMinimize:x.a.string,ariaDeleteTitle:x.a.string,ariaDeleteLabel:x.a.string,color:x.a.string,expand:x.a.bool.isRequired,backButton:x.a.bool,showHeaderTitle:x.a.bool.isRequired,showHeaderSubTitle:x.a.bool.isRequired,handleNavigation:x.a.func.isRequired,expandMessenger:x.a.func.isRequired,collapseMessenger:x.a.func.isRequired,config:x.a.object,onHeaderUpdated:x.a.func,launcherRef:x.a.object,route:x.a.string.isRequired,bTablet:x.a.bool,markdownMessages:x.a.array};var Kt=Ht,zt=n(371),qt=n(270),Ut=n(83),_t=n(400),Wt=n(388),Vt=n(376),Gt=n(383),$t=n(384),Yt=n(385),Qt=n(386);function Xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var Jt=function(e){u()(n,e);var t=Xt(n);function n(){return o()(this,n),t.apply(this,arguments)}return i()(n,[{key:"render",value:function(){var e=this,t=function(e){var t=e.children,n=Object(b.createRef)();return Object(b.useLayoutEffect)((function(){e.bFocusVisible&&n.current&&n.current.focusVisible()}),[e.bFocusVisible]),v.a.createElement(Vt.a,{action:n,sx:{marginBottom:"0px"},onClick:e.onClick,color:e.color||"inherit",variant:e.variant||"inherit",disabled:e.disabled},t)},n=function(t){e.props.onAlertDialogExiting(t)},r=this.props.sAlertDialogButtonPrimary&&this.props.sAlertDialogButtonSecondary||!1;return v.a.createElement("div",null,v.a.createElement(Gt.a,{open:this.props.bShowAlertDialog&&!!this.props.sAlertDialogMessage,onClose:function(e,t){"backdropClick"!==t&&n(e)},container:function(){return e.props.container.current},fullScreen:!1,style:{position:"absolute",textAlign:"center"},BackdropProps:{style:{position:"absolute"}},disableScrollLock:!0,"aria-labelledby":"alert-dialog-description",disableEnforceFocus:!0,TransitionProps:{onEntering:function(t){e.props.onAlertDialogEntering(t)},onEntered:function(t){e.props.onAlertDialogEntered(t)},onExiting:function(t){e.props.onAlertDialogExiting},onExited:n}},"progress"==this.props.status&&v.a.createElement(Wt.a,{variant:"query"}),v.a.createElement(Yt.a,null,v.a.createElement(Qt.a,{id:"alert-dialog-description"},this.props.sAlertDialogMessage),v.a.createElement($t.a,{style:{justifyContent:"center",WebkitBoxPack:"center",marginTop:"10px"}},v.a.createElement(t,{onClick:function(t){e.props.onAlertDialogButtonPrimary(t),e.props.preventDefault||e.props.closeAlertDialog("primary")},color:this.props.sAlertDialogButtonPrimaryColor||this.props.color||"inherit",variant:this.props.sAlertDialogButtonPrimaryVariant||"contained",bFocusVisible:!0,disabled:"progress"==this.props.status},this.props.sAlertDialogButtonPrimary),r&&v.a.createElement(t,{onClick:function(t){e.props.onAlertDialogButtonSecondary(t),e.props.preventDefault||e.props.closeAlertDialog("secondary")},disabled:"progress"==this.props.status},this.props.sAlertDialogButtonSecondary)))))}}]),n}(v.a.Component);Jt.propTypes={color:x.a.string,route:x.a.string,status:x.a.string,container:x.a.object,bShowAlertDialog:x.a.bool,sAlertDialogMessage:x.a.string,sAlertDialogButtonPrimary:x.a.string,sAlertDialogButtonSecondary:x.a.string,onAlertDialogEntering:x.a.func,onAlertDialogEntered:x.a.func,onAlertDialogExiting:x.a.func,onAlertDialogExited:x.a.func,onAlertDialogButtonPrimary:x.a.func,onAlertDialogButtonSecondary:x.a.func};var Zt,en=(Zt=Jt,function(e){return v.a.createElement(wt.a.Consumer,null,(function(t){var n=t.route,r=t.bShowAlertDialog,o=t.showAlertDialog,a=t.closeAlertDialog,i=t.sAlertDialogMessage,s=t.sAlertDialogButtonPrimary,c=t.sAlertDialogButtonSecondary,l=t.onAlertDialogEntering,u=t.onAlertDialogEntered,d=t.onAlertDialogExiting,p=t.onAlertDialogExited,g=t.onAlertDialogButtonPrimary,f=t.onAlertDialogButtonSecondary,m=t.sAlertDialogButtonPrimaryColor,h=t.sAlertDialogButtonPrimaryVariant;return v.a.createElement(Zt,Xe()({},e,{route:n,bShowAlertDialog:r,showAlertDialog:o,closeAlertDialog:a,sAlertDialogMessage:i,sAlertDialogButtonPrimary:s,sAlertDialogButtonPrimaryColor:m,sAlertDialogButtonPrimaryVariant:h,sAlertDialogButtonSecondary:c,onAlertDialogEntering:l,onAlertDialogEntered:u,onAlertDialogExiting:d,onAlertDialogExited:p,onAlertDialogButtonPrimary:g,onAlertDialogButtonSecondary:f}))}))}),tn=n(389),nn=n(390),rn=n(377),on=n(380),an=n(552),sn=n.n(an),cn=n(24),ln=n.n(cn),un=n(399),dn=n(557),pn=n.n(dn),gn={avatar:"".concat("IconAvatar","-root"),image:"".concat("IconAvatar","-image"),fallbackIcon:"".concat("IconAvatar","-fallbackIcon")},fn=Object(xt.a)("div")((function(e){var t;e.theme,e.props;return t={},h()(t,"& .".concat(gn.image),{maxHeight:"100%",maxWidth:"100%",minWidth:"75%",minHeight:"75%"}),h()(t,"& .".concat(gn.fallbackIcon),{width:"1em!important",height:"1em!important"}),t})),mn=function(e){var t,n,r=e.humanizeConfig,o=e.message,a=e.showAgentAvatar,i=e.showBotAvatar,s=r||{},c=s.bot,l=s.enabled,u=c||{},d=u.name,p=u.avatarUrl,g=o||{},f=g.messageType,m=g.originatingEntity,h=g.from||{},b=h.name,y=h.avatar,x="";return l&&"outbound"==f&&("Human"==m?(n=y,x=b):"Bot"==m&&(n=y||p,x=b||d)),v.a.createElement("div",null,l&&(a||i)&&v.a.createElement(fn,null,v.a.createElement(un.a,{src:n,alt:x,classes:{img:gn.image,fallback:gn.fallbackIcon},children:"Human"==m?x?null===(t=x[0])||void 0===t?void 0:t.toUpperCase():v.a.createElement(un.a,{classes:{img:gn.image,fallback:gn.fallbackIcon}}):v.a.createElement(un.a,null,v.a.createElement(pn.a,{className:gn.fallbackIcon}))}))||null)},hn=mn;mn.propTypes={styles:x.a.object};var bn=n(20),vn=n(330);function yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yn(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wn=Object(xt.a)(rn.a)((function(e){var t,n=e.theme;return{width:"100%",backgroundColor:"transparent!important","& .Cx-MuiCardContent-root":{display:"flex",paddingBottom:"16px!important",position:"relative"},"& .mxg-card-title-container":{width:"100%",paddingTop:"4px"},"& .mxg-card-title-content":{display:"block",width:"100%",whiteSpace:"pre"},"& .mxg-card-message":{lineHeight:"unset"},"& .mxg-chevron-right":{display:"inline-block",float:"right",cursor:"pointer",position:"relative",marginLeft:"auto",left:"9px",width:"26px",height:"26px"},"& .mxg-message-caption":{color:n.palette.common.mediumGrey,fontWeight:"600",whiteSpace:"pre",display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",width:"100%",verticalAlign:"text-bottom"},"& .card-container":{width:"100%"},"& .mxg-avatar":{display:"inline-block",width:"81%",float:"left",position:"relative",paddingTop:"4px"},"& .mxg-card-textContent":{display:"inline-block",width:"84%",float:"left",position:"relative"},"& .mxg-card-column1":{display:"inline-block",position:"relative",float:"left",bottom:"0px",maxWidth:"14%",marginRight:"10px",paddingTop:"9px"},"& .mxg-card-column2":{display:"inline-block",width:"100%",paddingTop:"4px"},"& .mxg-card-column3":{display:"inline-block",float:"right",width:"15%",padding:"10px 2px 0px 0px"},"& .mxg-text-message-caption":{color:n.palette.common.mediumGrey,display:"block",float:"left",whiteSpace:"nowrap",overflow:"hidden",width:"100%",textOverflow:"ellipsis",pointerEvents:"none",maxWidth:"91%"},"& .mxg-message-date":(t={color:n.palette.common.mediumGrey,width:"100%",fontSize:"0.75rem",float:"right",textAlign:"end"},h()(t,"fontSize","0.75rem"),h()(t,"whiteSpace","pre"),t),"& .Cx-MuiButton-contained":{margin:"0px 5px 0px 0px",boxShadow:"none",display:"flex",maxWidth:"100%",float:"left"},"& .mxg-message-container":{display:"flex",position:"relative"},"& .mxg-card-buttons":{display:"inline-block",paddingTop:"15px"},"& .mxg-markdown":{"& pre":{padding:"9px",borderRadius:"4px",border:"1px solid",textOverflow:"ellipsis",overflow:"hidden",margin:"0px",whiteSpace:"nowrap",display:"inline-block",maxWidth:"inherit"}},"& .mxg-secondary-btn":{color:n.palette.common.textColor,backgroundColor:n.palette.common.lightGrey,"&:hover":{backgroundColor:n.palette.common.smokeGrey}},"& .mxg-clear-button":{float:"right",position:"absolute",right:0,margin:"-7px 5px 0px 0px",clear:"both"}}})),On=function(e,t,n){var r=e||{},o=r.messageType,a=r.originatingEntity,i=(r.from||{}).name,s=n||{},c=s.bot,l=s.enabled,u=t||{},d=u.customerDefaultName,p=u.botDefaultName,g=u.agentDefaultName,f=(c||{}).name,m="";if(o){switch(o){case"inbound":m=d;break;case"outbound":"Bot"===a?(m=p,l&&(f||i)&&(m=i||f)):(m=g,l&&i&&(m=i))}return m}};function Sn(e){var t=e||{},n=t.i18n,r=t.openConversation,o=t.startNewConversation,a=t.config.apps,i=t.conversationStore,s=t.humanizeConfig,c=t.disconnectType,l=t.markdownMessages,u=t.color,d=t.handleConversationCardKeyDown,p=t.onHeaderDeleteButtonClick,g=i||{},f=(g.messages,g.readOnly),m=(a||{}).conversations||{},h=m.conversationDisconnect,b=m.conversationClear,y=h||{},x=y.enabled,w=(y.type,(b||{}).enabled),O=(s||{}).enabled,S=function(){r(),"function"==typeof p&&p()},E="",C="",k="",R="",T="",j="",D=!1,P=!1,M=!1,A="";if(l&&l.length&&(E=l.find((function(e){var t=e||{},n=t.text,r=t.contentType,o=t.files,a=t.eventType,i=(t.presence||{}).type;if(e)return n||r||o&&o.length||a&&a.toLowerCase()==bn.F&&i&&i.toLowerCase()==bn.m}))),E){var I=E||{},N=I.timestamp,F=I.text,L=I.contentType,B=I.carousel,H=I.card,K=I.eventType,z=I.presence,q=I.messageType,U=(z||{}).type,_=(B||{}).cards;switch(k=ln()(N),F&&(T=F),L&&"string"==typeof L&&(j=L.toLowerCase()),j){case"carousel":_&&_.length&&!T&&(T=_[0].title||_[0].description);break;case"card":H&&H.title&&!T&&(T=H.title)}K&&K.toLowerCase()==bn.F&&U&&U.toLowerCase()==bn.m&&(M=!0,T=c&&"send"==c.toLowerCase()&&!f?n.disconnectMessage+". "+n.disconnectMessageSend:n.disconnectMessage||""),x&&f&&"boolean"==typeof P&&!P&&M&&(P=!0),R=On(E,n,s),D=q&&"outbound"===q||!1,A=E,T||(C=l.find((function(e){return e&&e.text})))&&C.text&&(R=On(C,n,s),T=C.text,C.timestamp&&(k=ln()(C.timestamp)),D=C.messageType&&"outbound"===C.messageType||!1,A=C),T&&T.match(/<a/)&&(T=T.replaceAll("<a target='_blank'","<a target='_blank' tabindex='-1'"))}return v.a.createElement(wn,{elevation:2,raised:!0},v.a.createElement(on.a,{id:"card_content"},v.a.createElement("div",{className:"card-container"},v.a.createElement("div",{className:"mxg-card-title-content"},v.a.createElement(it.a,{variant:"h3"},E&&P?n.yourConversationCardTitle:E?n.continueConversationCardTitle:n.startConversationCardTitle)),E&&v.a.createElement("div",{className:"mxg-message-container"},v.a.createElement("div",{className:"mxg-card-textContent"},O&&D&&v.a.createElement("div",{className:"mxg-card-column1"},v.a.createElement(hn,{humanizeConfig:s,message:A,showAgentAvatar:D,styles:{avatar:{margin:"2px 6px 0px 0px"}}})),v.a.createElement("div",{className:O&&D?"mxg-avatar":"mxg-card-column2"},E&&T&&v.a.createElement("div",{className:"mxg-card-title-container"},R&&v.a.createElement(it.a,{className:"mxg-message-caption",variant:"caption"},"".concat(R," ")),T&&v.a.createElement(it.a,{className:"mxg-text-message-caption mxg-card-message mxg-markdown",variant:"caption",dangerouslySetInnerHTML:{__html:Object(vn.b)(T)}}),v.a.createElement("div",{role:"alert",className:"cx-messenger-screen-reader",tabIndex:-1,"aria-labelledby":"card_content"})))),v.a.createElement("div",{className:"mxg-card-column3"},k&&v.a.createElement(it.a,{className:"mxg-message-date",variant:"caption"},ln()(k.$d).format("LT")))),v.a.createElement("div",{className:"mxg-card-buttons"},v.a.createElement(Vt.a,{variant:"contained",startIcon:v.a.createElement(Tt.a,{icon:sn.a,alt:"",customStyle:{width:"20px",height:"20px",display:"flex",alignItems:"inherit",justifyContent:"inherit"}}),size:"medium",dir:"auto",color:u,tabIndex:0,"aria-label":E&&P?n.openConversationButtonTitle+"-"+n.ariaOpenConversation:E?n.continueConversationButtonTitle+"-"+n.ariaContinueConversation:n.startConversationButtonTitle+"-"+n.ariaStartNewConversation,onClick:r,onKeyDown:d},v.a.createElement("span",{className:"mxg-button-text"},E&&P?n.openConversationButtonTitle:E?n.continueConversationButtonTitle:n.startConversationButtonTitle)),P&&v.a.createElement(Vt.a,{id:"startNewConversation_text",variant:"contained",size:"medium",dir:"auto",className:"mxg-secondary-btn",tabIndex:0,"aria-label":n&&n.startNewConversation+"-"+n.ariaStartNewConversation||"",onClick:o},n&&n.startNewConversation||""),w&&E&&v.a.createElement(yt.a,{className:"mxg-clear-button",color:"inherit",children:v.a.createElement(ht,{style:xn({},{width:"26px",height:"26px",display:"flex",alignItems:"inherit",justifyContent:"inherit"})}),onClick:S,"aria-label":n.ariaActionsClearButtonLabel,title:n.ariaActionsClearButtonTitle,tabIndex:0,onKeyPress:function(e){var t;13!==(t=e).which&&32!==t.which||t.ctrlKey||t.shiftKey||(t.preventDefault(),S())}})))))}Sn.propTypes={openConversation:x.a.func.isRequired,i18n:x.a.object.isRequired,conversationStore:x.a.object,onHeaderDeleteButtonClick:x.a.func};var En=n(372);n(613);function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var Tn=Object(Ot.i)().browser||"",jn=!(!Tn||"Safari"!==Tn),Dn=et((function(){return Promise.resolve().then(n.bind(null,372))})),Pn=Dn.KnowledgeCard,Mn=Dn.KnowledgeResults,An=Dn.KnowledgeArticle,In=Dn.KnowledgeCategories,Nn=Object(xt.a)("div")((function(e){var t=e.theme,n=e.props;return{position:"absolute",inset:"-32px 0 0 0",width:"92%",overflowY:"auto",overflowX:"hidden",backgroundColor:"inherit",margin:"0px 16px 16px 16px",borderRadius:"4px","&.mxg-app":{position:"initial",margin:"0px"},"& .mxg-knowledge-container":{position:"absolute",right:"0px",boxSizing:"border-box",overflow:"hidden auto",overscrollBehavior:"contain",width:"100%",height:"100%",scrollBehavior:"smooth",fontFamily:t.typography.fontFamily},"& .mxg-knowledge-wrapper":{height:"100%"},"& .mxg-toaster-listItem":{marginBottom:n.bToaster?"16px!important":"0!important"}}})),Fn={padding:"1px","& .Cx-MuiListItem-root":{display:"flex",margin:"0px 0px 16px 0px",padding:"0",listStyle:"none","&:hover":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent"},"&:focus-visible":{backgroundColor:"transparent",outline:"1px auto",outlineOffset:jn?"-7px":"unset"},"&:last-child":{marginBottom:"0px"}},"& .Cx-MuiListItem-button.Mui-focusVisible":{backgroundColor:"transparent",outline:"1px auto",outlineOffset:jn?"-7px":"unset"}},Ln=function(e){u()(n,e);var t=Rn(n);function n(e){var r;o()(this,n),r=t.call(this,e),h()(c()(r),"setHomeDimensions",(function(){var e=r.props||{},t=e.headerRef,n=e.homeScreenRef,o=e.sOSBrowser,a=e.iHomeScreenHeight,i=e.setHomeScreenHeight,s=e.updateHomeHeight,c=e.knowledgeEnabled,l=e.bTablet,u=e.bToaster,d=e.iToasterHeight,p=(r.state||{}).homeScreenHeight;if("conversations.home"===r.route){if(n&&n.current&&t&&t.current){var g=n.current.children[0]&&n.current.children[0].firstElementChild&&n.current.children[0].firstElementChild.clientHeight||r.homeScreenCardHeight,f=t.current.clientHeight+g;if(u&&d&&(f+=d),l&&c&&f<=368&&(f=368),!c&&f<245&&(f=245),s&&i({homeScreenHeight:a,bAddTransition:s}),(!p||p!==f)&&(r.homeScreenCardHeight=g,r.homeScreenCardHeight&&r.homeScreenCardHeight<bn.s&&(r.homeScreenCardHeight=bn.s),r.homeScreenCardHeight>=bn.s&&r.homeScreenCardHeight<=bn.r)){r.setState({homeScreenHeight:f});var m=f+50;i({homeScreenHeight:m,bAddTransition:s}),r.oHome&&r.oHome.command("MessengerHelper.setDimension",{conversations:{height:"".concat(m,"px"),width:bn.y,removeClass:["genesys-mxg-conversation"],addClass:["genesys-mxg-homescreen",o]}})}}}else p&&(r.setState({homeScreenHeight:0}),i&&i({homeScreenHeight:0,bAddTransition:!1}),r.oHome&&r.oHome.command("MessengerHelper.setDimension",{conversations:{height:bn.x,width:bn.y,removeClass:["genesys-mxg-homescreen",o,"genesys-mxg-frame-transition"],addClass:["genesys-mxg-conversation"]}}))})),h()(c()(r),"openArticle",(function(e){var t,n,o=e.data,a=e.showProgress;r.knowledge.articleData=o||{},r.slideDirection="backward",r.bShowProgress=a,r.props.dispatch((n=(((t=e)||{}).data||{}).documentId,{type:"OPEN_KNOWLEDGE_ARTICLE",route:t.route,documentId:n||""}))})),h()(c()(r),"openCategory",(function(e){var t,n=e.data,o=e.route,a=(e.showProgress,o.split(".")),i=Ge()(a,3);r.app=i[0],r.view=i[1],r.subView=i[2],r.route="".concat(r.app,".").concat(r.view),r.knowledge.categoryData[r.subView]=n||{},r.slideDirection="forward",r.bShowProgress=r.showProgress,r.props.dispatch({type:"OPEN_KNOWLEDGE_CATEGORY",route:(t=e).route,categoryData:t.data})})),h()(c()(r),"showProgress",(function(){r.setState((function(){return{showArticleProgress:!0}}))})),h()(c()(r),"stopProgress",(function(){r.setState((function(){return{showArticleProgress:!1}}))})),h()(c()(r),"showCategoriesProgress",(function(){r.setState((function(){return{showCategoriesProgress:!0}}))})),h()(c()(r),"stopCategoriesProgress",(function(){r.setState((function(){return{showCategoriesProgress:!1}}))})),h()(c()(r),"openSearch",(function(e){r.sOpeningView="search",r.slideDirection="forward",r.props.dispatch(nt(e))})),h()(c()(r),"openConversation",(function(){r.sOpeningView="conversations",r.props.dispatch(tt.openConversations({route:"conversations.conversations"}))})),h()(c()(r),"startNewConversation",(function(){((((r.props.config||{}).apps||{}).conversations||{}).conversationDisconnect||{}).enabled&&(r.props.dispatch(ot.resetConversation()),r.openConversation())})),h()(c()(r),"setMarkdown",function(){var e=Ye()(Ze.a.mark((function e(t){var n,o,a,i;return Ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.props||{},o=n.awaitMarkdown,e.next=3,o(t);case 3:r.markdownMessages=e.sent,a=r.state||{},i=a.newMessage,r.markdownMessages.length&&r.markdownMessages[0].timestamp!==i.timestamp?(r.props.setMarkdownMessages(r.markdownMessages),r.setState((function(){return{newMessage:r.markdownMessages[0]}}))):r.setState((function(){return{newMessage:{}}}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(c()(r),"setStorage",(function(e,t,n){r.oMessengerPlugin.command(r.storage+".set",{name:e,value:t,expireInSecs:n})})),h()(c()(r),"removeStorage",(function(e){r.oMessengerPlugin.command(r.storage+".remove",{name:e})})),h()(c()(r),"verifyStorageAndRemove",(function(){var e=r.knowledgeStoragePrefix+r.subKnowledgeArticleIdStorage;r.oMessengerPlugin.command(r.storage+".get",{name:e}).then((function(t){var n=t.split(":"),o=Ge()(n,2),a=o[0],i=o[1];a&&"string"==typeof a&&!i&&r.removeStorage(e)}))})),h()(c()(r),"handleConversationCardKeyDown",(function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||(e.preventDefault(),r.openConversation())})),h()(c()(r),"handleKnowledgeCardKeyDown",(function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||(e.preventDefault(),r.openSearch({route:"knowledge.search"}))}));var a=e||{},i=a.config,s=a.plugins,l=a.knowledgeEnabled,u=a.knowledge,d=a.conversationStore,p=i||{},g=p.deploymentId,f=p.appType;(d||{}).status;return r.sPluginName="Home",r.knowledgeStoragePrefix=":gcmk",r.subKnowledgeArticleIdStorage="aid",r.oMessengerPlugin=s.Messenger,r.oHome="",r.route="",r.bShowProgress=!1,r.sOpeningView="",r.knowledge={articleData:{},categoryData:{}},r.slideDirection=r.props.slideDirection,r.state={showArticleProgress:!1,showCategoriesProgress:!1,homeScreenHeight:0,newMessage:{}},r.homeScreenCardHeight=bn.s,r.storage=Object(Ot.j)(i),r.markdownMessages=[],g&&(r.knowledgeStoragePrefix=g+r.knowledgeStoragePrefix),l&&u&&(!s.KnowledgeService&&f&&Object(En.initKnowledgeServicePlugin)(i).then((function(e){r.props.setPlugin("KnowledgeService",e)})),r.oMessengerPlugin.command(r.storage+".get",{name:r.knowledgeStoragePrefix+r.subKnowledgeArticleIdStorage}).then((function(e){var t,n=e.split(":"),o=Ge()(n,2),a=o[0],i=o[1];if(a&&"string"==typeof a&&!i&&r.route&&"knowledge.article"!==r.route){r.route="knowledge.article";var s=r.route.split("."),c=Ge()(s,3);r.app=c[0],r.view=c[1],r.subView=c[2],r.props.dispatch({type:"OPEN_KNOWLEDGE_ARTICLE_DIRECT",route:(t={route:"knowledge.article",documentId:a}).route,documentId:t.documentId})}}))),r}return i()(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.oPlugins,r=t.route,o=t.bTablet;if(n&&n[this.sPluginName]?this.oHome=n[this.sPluginName]:Genesys("registerPlugin",this.sPluginName,(function(t){e.oHome=t,e.oHome.ready()})),this.route&&(!Object(Ot.n)()&&!Object(Ot.l)()||o)&&this.setHomeDimensions(),r)switch(r){case"conversations.conversations":this.openConversation(),this.props.resetRoute();break;case"knowledge.search":this.openSearch({route:r}),this.props.resetRoute()}}},{key:"componentDidUpdate",value:function(){!this.route||Object(Ot.n)()||Object(Ot.l)()||this.setHomeDimensions()}},{key:"componentWillUnmount",value:function(){this.props.setPlugin(this.sPluginName,this.oHome),this.sOpeningView||this.props.dispatch(ot.closed()),this.sOpeningView=""}},{key:"shouldComponentUpdate",value:function(e,t){var n=this,r=e.conversationStore,o=e.markdownMessages,a=r||{},i=a.messages,s=a.status,c=(t||{}).newMessage,l=(this.state||{}).newMessage,u=this.props||{},d=u.setMarkdownMessages,p=u.awaitMarkdown,g=function(e){var t=(e||{}).propertyName,r=Object(vn.c)(n.markdownMessages,i,t);return r&&r.length?(n.setMarkdown(r),!1):!function(e,t){return!(!t||!e||t.timestamp!=e.timestamp)}(l,c)};return i&&i.length?(this.markdownMessages.length||o.length!==i.length||(this.markdownMessages=o),"messagesUpdated"===s&&i.length===this.markdownMessages.length?g({propertyName:"updatedTime"}):i.length===this.markdownMessages.length||g({propertyName:"timestamp"})):(i.length||!this.markdownMessages.length&&!o.length||(this.markdownMessages=[],p([]),d([])),!0)}},{key:"updateView",value:function(){var e,t=this.props,n=t.messengerStore,r=t.route,o=t.knowledgeStore,a=t.knowledge,i=t.resetKnowledgeState,s=(n||{}).route.split("."),c=Ge()(s,3);(this.app=c[0],this.view=c[1],this.subView=c[2],this.route="".concat(this.app,".").concat(this.view),this.route&&"knowledge.article"===this.route&&r&&("knowledge.search"===r?this.route="knowledge.search":"conversations.conversations"===r&&(this.route="conversations.conversations")),this.route&&"conversations.home"===this.route)&&(!!(null!=o&&o.inputValue||null!=a&&null!==(e=a.results)&&void 0!==e&&e.searchQuery)&&i())}},{key:"render",value:function(){var e=this,t=this.props,n=t.knowledgeEnabled,r=t.knowledge,o=t.showProgress,a=t.config,i=t.i18n,s=t.setKnowledgeStore,c=t.knowledgeStore,l=t.messengerStore,u=t.conversationStore,d=t.setKnowledgePlugin,p=t.plugins,g=t.onError,f=t.knowledgeWrapperRef,m=t.handleSearchContentNavigation,h=t.homeScreenRef,y=t.color,x=t.Toaster,w=t.oPlugins,O=(t.markdownMessages,t.setMarkdownMessages,t.onHeaderDeleteButtonClick),S=t.bConversationApp,E=this.state,C=E.showArticleProgress,k=E.showCategoriesProgress,R=this.knowledge||{},T=R.articleData,j=R.categoryData,D=(r||{}).results,P=!!Object.keys(D).length,M=((a||{}).apps||{}).conversations,A=((M||{}).conversationDisconnect||{}).type,I=(M||{}).humanize,N=(I||{}).enabled;this.updateView();var F="",L="";"knowledge.search"!==this.route&&"knowledge.article"!==this.route&&"knowledge.category"!==this.route||(F="mxg-app",L=" mxg-app-body");var B=((i||{}).knowledge||{}).ariaLoading,H=this.route&&("knowledge.search"==this.route||"knowledge.category"==this.route||"knowledge.article"==this.route);return v.a.createElement(St.a,{direction:"right",in:!0,appear:null!==this.slideDirection,mountOnEnter:!0,unmountOnExit:!0},v.a.createElement(Ut.a,{elevation:0,className:"mxg-home".concat(L),sx:function(e){return kn(kn({},{"&.Cx-MuiPaper-root":{position:"relative",flex:"1 1 0%",zIndex:"9999","&:focus-visible":{outline:"none"}},"&.mxg-app-body":{zIndex:"999"}}),{},{left:"0"})},square:!0,role:"main",ref:h,tabIndex:H?0:-1,"aria-label":"HomeScreen"},v.a.createElement(Nn,{className:F,props:this.props},function(){switch(e.route){case"knowledge.category":case"knowledge.search":return e.verifyStorageAndRemove(),v.a.createElement("div",{className:"mxg-knowledge-container"},v.a.createElement(St.a,{direction:"forward"===e.slideDirection?"left":"right",in:!0,appear:!0},v.a.createElement("div",null,v.a.createElement(x,{plugin:w.Toaster,config:a}),v.a.createElement("div",{className:"mxg-knowledge-wrapper",ref:f,onKeyDown:function(e){return m(e)}},n&&(o||k)&&v.a.createElement(Wt.a,{variant:"query","aria-busy":"true",role:"alert","aria-label":B}),!P&&v.a.isValidElement(v.a.createElement(In,null))&&v.a.createElement(In,{config:a,i18n:i.knowledge,setStore:s,showProgress:e.showCategoriesProgress,stopProgress:e.stopCategoriesProgress,data:j[e.subView]&&Object.keys(j[e.subView]).length?j[e.subView]:l.categoryData&&l.categoryData[e.subView],store:c||{},openCategory:e.openCategory,openArticle:e.openArticle,onError:g}),n&&P&&v.a.createElement(Mn,{openArticle:e.openArticle,data:D,config:a,setStore:s,store:c||{},setPlugin:d,plugin:p.Knowledge||"",i18n:i.knowledge,onError:g})))));case"knowledge.article":if(e.knowledge&&T&&Object.keys(T).length){var t=T.documentId;t&&e.setStorage(e.knowledgeStoragePrefix+e.subKnowledgeArticleIdStorage,t,bn.l)}return v.a.createElement(St.a,{direction:"left",in:!0,appear:!0,className:"mxg-knowledge-container"},v.a.createElement("div",null,v.a.createElement(x,{plugin:w.Toaster,config:a}),v.a.createElement("div",{ref:f,onKeyDown:function(e){return m(e)}},n&&(e.bShowProgress||C)&&v.a.createElement(Wt.a,{variant:"query","aria-busy":"true",role:"alert","aria-label":B}),n&&v.a.createElement(An,{data:T&&Object.keys(T).length?T:{documentId:l.documentId},showProgress:e.showProgress,stopProgress:e.stopProgress,openArticle:e.openArticle,config:a,i18n:i.knowledge,setStore:s,store:c||{},setPlugin:d,plugin:p.Knowledge||"",onError:g}))));default:return e.verifyStorageAndRemove(),v.a.createElement(St.a,{direction:"right",in:!0,appear:null!==e.slideDirection,timeout:{appear:200,enter:200,exit:0}},v.a.createElement(tn.a,{sx:kn({},Fn)},v.a.createElement(nn.a,{component:"li",role:"listitem",tabIndex:0,className:"mxg-toaster-listItem"},v.a.createElement("div",{style:{width:"100%"}},v.a.createElement(x,{plugin:w.Toaster,config:a}))),S&&v.a.createElement(nn.a,{component:"li",role:"listitem",tabIndex:0},v.a.createElement(Sn,{openConversation:e.openConversation,startNewConversation:e.startNewConversation,config:a,plugin:e.oHome||"",i18n:i.conversations,conversationStore:u,humanizeConfig:N?I:{},disconnectType:A,color:y,handleConversationCardKeyDown:e.handleConversationCardKeyDown,markdownMessages:e.markdownMessages,onHeaderDeleteButtonClick:O})),n&&v.a.isValidElement(v.a.createElement(Pn,null))&&v.a.createElement(b.Suspense,{fallback:v.a.createElement("div",null)},v.a.createElement(nn.a,{button:!0,component:"li",role:"listitem",tabIndex:0,onKeyDown:e.handleKnowledgeCardKeyDown},v.a.createElement(Pn,{openSearch:e.openSearch,config:a,setStore:s,store:c||{},setPlugin:d,plugin:p.Knowledge||"",i18n:i.knowledge,muiCardProps:{elevation:2,raised:!0}})))))}}())))}}]),n}(v.a.Component);Ln.propTypes={knowledgeEnabled:x.a.bool,knowledge:x.a.object,showProgress:x.a.bool,config:x.a.object,setKnowledgePlugin:x.a.func.isRequired,setKnowledgeStore:x.a.func.isRequired,knowledgeStore:x.a.object.isRequired,oPlugins:x.a.object.isRequired,setPlugin:x.a.func.isRequired,plugins:x.a.object.isRequired,i18n:x.a.object.isRequired,resetRoute:x.a.func.isRequired,bTablet:x.a.bool,Toaster:x.a.elementType.isRequired};var Bn=ie((function(e){return{messengerStore:e.messengerStore,conversationStore:e.conversationStore}}))(function(e){return function(t){return v.a.createElement(wt.a.Consumer,null,(function(n){var r=n.oPlugins,o=n.setPlugin,a=n.route,i=n.resetRoute,s=n.markdownMessages,c=n.setMarkdownMessages,l=n.iHomeScreenHeight,u=n.setHomeScreenHeight,d=n.bToaster,p=n.iToasterHeight,g=n.onHeaderDeleteButtonClick;return v.a.createElement(e,Xe()({},t,{oPlugins:r,setPlugin:o,route:a,resetRoute:i,iHomeScreenHeight:l,setHomeScreenHeight:u,markdownMessages:s,setMarkdownMessages:c,bToaster:d,iToasterHeight:p,onHeaderDeleteButtonClick:g}))}))}}(Ln)),Hn=n(52),Kn=n.n(Hn),zn=n(396),qn=n(397),Un=function(e){return v.a.createElement(qn.a,Xe()({sx:function(e){return{"&.Cx-MuiAlert-filledError":{justifyContent:"center",zIndex:"1",position:"relative",width:"100%",padding:"0px",marginBottom:"16px"},"&.Cx-MuiAlert-filledWarning":{justifyContent:"center",zIndex:"1",position:"relative",width:"100%",padding:"0px",marginBottom:"16px"},"&.MuiAlert-filledInfo":{justifyContent:"center",zIndex:"1",position:"relative",width:"100%",padding:"0px",marginBottom:"16px"}}},elevation:6,variant:"filled"},e))},_n=(n(615),n(382)),Wn=n(395),Vn=n(37),Gn=n(315),$n=n(589),Yn=n(588),Qn=n(587),Xn=n(591),Jn=n(590),Zn=n(326),er=n(558),tr=n.n(er);function nr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var rr=v.a.createRef,or=Object(xt.a)("ul")((function(e){e.theme;return{listStyle:"none",position:"relative",clear:"both",margin:"0",padding:"10px 0px",display:"inline-flex",flexFlow:"row-reverse",flexWrap:"wrap-reverse",float:"right",justifyContent:"flex-start",maxWidth:"84%","& li":{padding:"4px",maxWidth:"100%"}}})),ar=!1,ir=function(e){u()(n,e);var t=nr(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"setIsOverflow",(function(){var e=r.props.reply;if(r.setState({isOverflown:!1}),r.chipRef.current){var t=e.imageUrl?r.chipRef.current.children[1]:r.chipRef.current.children[0];t.scrollWidth>t.offsetWidth&&r.setState({isOverflown:!0})}})),r.state={isOverflown:!1},r.chipRef=rr(),r}return i()(n,[{key:"componentDidMount",value:function(){this.setIsOverflow(),window.addEventListener("orientationchange",this.setIsOverflow),window.addEventListener("resize",this.setIsOverflow)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("orientationchange",this.setIsOverflow),window.removeEventListener("resize",this.setIsOverflow)}},{key:"render",value:function(){var e=this.props,t=e.removeFocus,n=e.reply,r=e.i18n,o=e.containerRef,a=e.oCallbacks,i=e.selectedReplyId,s=a.handleSelection,c=this.state.isOverflown;return v.a.createElement(Wn.a,{componentsProps:{tooltip:{sx:{width:"93%",maxHeight:"100px",overflowY:"auto",margin:"10px 0"}}},title:n.text,PopperProps:{container:o.current},disableHoverListener:!c,disableFocusListener:!c,disableTouchListener:!c},v.a.createElement(Zn.a,{sx:{"& .Cx-MuiAvatar-root":{width:"24px",height:"24px",marginLeft:"4px",marginRight:"-6px"},"&.Cx-MuiChip-outlined":{height:"100%",maxWidth:"100%",padding:"6px 0px 0px 4px"},"&.Cx-MuiChip-root":{float:"right",height:"100%",maxWidth:"100%",padding:"6px 0px"}},ref:this.chipRef,variant:i&&i===n.id?"filled":"outlined",clickable:!i,avatar:n.imageUrl?v.a.createElement(un.a,{src:n.imageUrl,alt:""},v.a.createElement(tr.a,null)):null,label:v.a.createElement("span",{dir:"auto"},n.text),onClick:function(){return s(n)},"aria-label":n.text+". - "+r.ariaQuickReply,tabIndex:t?-1:0}))}}]),n}(v.a.Component),sr=function(e){u()(n,e);var t=nr(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"handleSelection",(function(e){var t=r.props.onReplySelection;e&&!r.selectedReplyId&&(r.selectedReplyId=e.id,t({type:"quickReply",postback:e}))})),h()(c()(r),"removeQuickReply",(function(){r.setState({removeMe:!0})})),r.selectedReplyId="",r.state={removeMe:!1},r.handleSelection=r.handleSelection.bind(c()(r)),r.removeQuickReply=r.removeQuickReply.bind(c()(r)),r}return i()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.mode,r=t.data,o=this.state.removeMe;return"advanced"===n&&(ar=!0),!r||!r.length||this.selectedReplyId&&!ar||o?null:v.a.createElement(or,null,r.map((function(t,n){return v.a.createElement("li",{"aria-posinset":n+1,key:t.id||n},v.a.createElement(ir,Xe()({selectedReplyId:e.selectedReplyId,reply:t,oCallbacks:{handleSelection:e.handleSelection}},e.props)))})).reverse())}}]),n}(v.a.Component);sr.propTypes={mode:x.a.string,data:x.a.array.isRequired,i18n:x.a.object.isRequired,onReplySelection:x.a.func.isRequired,containerRef:x.a.object.isRequired};var cr=sr,lr=n(378),ur=n(381),dr=n(379);function pr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var gr=Object(Ot.i)().browser||"",fr=Object(xt.a)(rn.a)((function(e){var t=e.theme;return{width:"230px",marginTop:"10px",border:"1px solid #DEE4ED",borderRadius:"0 10px 10px 10px",boxShadow:"none",whiteSpace:"pre-wrap",wordBreak:"break-word",wordWrap:"break-word",overflowWrap:"break-word",display:"flex",flexDirection:"column-reverse","&:focus-within":{outlineStyle:"Firefox"==gr?"solid":"auto",outlineWidth:"1px",outlineColor:"Firefox"==gr?"light"==t.palette.type?t.palette.getContrastText(t.palette.background.default):"inherit":"-webkit-focus-ring-color"},"&:-moz-focusring":{outlineColor:function(){return"light"==t.palette.type?t.palette.getContrastText(t.palette.background.default):"inherit"},outlineStyle:"solid"},"&.mxg-card-first":{borderRadius:"0 0px 0px 10px !important"},"&.mxg-card-last":{borderRadius:"0 10px 10px 0px !important"},"&.mxg-card-carousel":{borderRadius:"0!important"},"& .Cx-MuiCardMedia-media":{borderRadius:"0 10px 0px 0px",maxWidth:"100%",maxHeight:"100%"},"& .mxg-media-last":{borderRadius:"0 10px 0px 0px !important"},"& .mxg-media-carousel":{borderRadius:"0!important"},"& .Cx-MuiCardMedia-img":{height:"117px",objectFit:"cover"},"& .Cx-MuiButton-contained":{margin:"0",boxShadow:"none",display:"inline-block",maxWidth:"100%",lineHeight:"1.2",height:"30px",fontSize:"0.875rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},"& .Cx-MuiTypography-subtitle2":{fontSize:"0.875rem",fontWeight:"600"},"& .Cx-MuiTypography-body2":{fontSize:"0.875rem"},"& .Cx-MuiCardContent-root":{display:"flex",flexDirection:"column-reverse",padding:"8px 12px"},"& .Cx-MuiCardActions-root":{padding:"0px 12px 4px 12px",justifyContent:"center","&:first-of-type":{paddingBottom:"8px"}},"& .mxg-card-button":{display:"flex",flexDirection:"column-reverse",flex:"1"}}})),mr=function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||e.target.click()},hr=function(e){u()(n,e);var t=pr(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"onImageLoaded",(function(){r.setState({loaded:!0})})),h()(c()(r),"onImageLoadError",(function(){r.setState({loaded:!1})})),r.state={loaded:!1,bEnableScrollDown:!1},r.imageRef=Object(b.createRef)(),r.mediaStyles="",r}return i()(n,[{key:"componentDidUpdate",value:function(){var e=this.state,t=e.loaded,n=e.bEnableScrollDown,r=this.props.onContentAdded;t&&!n&&this.imageRef.current&&this.imageRef.current.complete&&this.imageRef.current.naturalWidth>0&&this.imageRef.current.naturalHeight>0&&(this.setState({bEnableScrollDown:!0}),r(t))}},{key:"render",value:function(){var e=this.props,t=e.removeFocus,n=e.imageUrl,r=e.actions,o=e.i18n,a=e.id,i=e.bCarousel,s=e.bLastSlide,c=(r||{}).url,l=this.state.loaded;return this.mediaStyles=i?s?"mxg-media-last":"mxg-media-carousel":"",c?v.a.createElement(lr.a,{component:"a",href:c,target:"_blank",tabIndex:t?-1:0,"aria-label":o.ariaImageLabel||"",onKeyPress:function(e){mr(e)},id:"cardImage_"+a},!l&&v.a.createElement(Gn.a,{variant:"rectangular",height:118}),v.a.createElement(ur.a,{className:this.mediaStyles,src:n,alt:"",component:"img",onLoad:this.onImageLoaded,onError:this.onImageLoadError,style:l?{}:{display:"none"},ref:this.imageRef})):v.a.createElement("div",{id:"cardImage_"+a},!l&&v.a.createElement(Gn.a,{variant:"rectangular",height:118}),v.a.createElement(ur.a,{className:this.mediaStyles,src:n,alt:"",component:"img",onLoad:this.onImageLoaded,onError:this.onImageLoadError,style:l?{}:{display:"none"},tabIndex:t?-1:0,"aria-label":o.ariaImageLabel||"",ref:this.imageRef}))}}]),n}(v.a.Component),br=function(e){var t=e.text,n=(e.i18n,e.actions),r=e.removeFocus,o=e.maxTextLength,a=e.containerRef,i=e.id,s=Object(Ot.q)(t,o),c=s.text,l=s.truncated,u=(n||{}).url;return v.a.createElement(Wn.a,{componentsProps:{tooltip:{sx:{width:"93%",maxHeight:"100px",overflowY:"auto",margin:"10px 0"}}},title:t,PopperProps:{container:a.current},disableHoverListener:!l,disableFocusListener:!l,disableTouchListener:!l},v.a.createElement("div",{id:"cardTitle_"+i},u?v.a.createElement(lr.a,{component:"a",href:u,target:"_blank",tabIndex:r?-1:0,"aria-label":t,onKeyPress:function(e){mr(e)}},v.a.createElement(it.a,{variant:"subtitle2",gutterBottom:!0,component:"h2",dir:"auto"},c)):v.a.createElement(it.a,{variant:"subtitle2",gutterBottom:!0,component:"h2",dir:"auto",tabIndex:r?-1:0,"aria-label":t},c)))},vr=function(e){var t=e.text,n=(e.i18n,e.actions),r=e.removeFocus,o=e.maxTextLength,a=e.containerRef,i=e.id,s=(n||{}).url,c=Object(Ot.q)(t,o),l=c.text,u=c.truncated;return v.a.createElement(Wn.a,{componentsProps:{tooltip:{sx:{width:"93%",maxHeight:"100px",overflowY:"auto",margin:"10px 0"}}},title:t,PopperProps:{container:a.current},disableHoverListener:!u,disableFocusListener:!u,disableTouchListener:!u},v.a.createElement("div",{id:"cardDescription_"+i},s?v.a.createElement(lr.a,{component:"a",href:s,target:"_blank",tabIndex:r?-1:0,"aria-label":t,onKeyPress:function(e){mr(e)}},v.a.createElement(it.a,{dir:"auto",variant:"body2"},l)):v.a.createElement(it.a,{dir:"auto",variant:"body2",component:"p",role:"text",tabIndex:r?-1:0,"aria-label":t},l)))},yr=function(e){var t=e.button,n=e.index,r=e.i18n,o=e.maxButtonsLimit,a=e.onReplySelection,i=e.cardActionLabel,s=t.title,c=t.actions,l=t.type,u=t.text,d=c||{},p=d.url,g=d.textback,f=p||"Link"==l||!1,m=g&&null!==g||"Postback"==l||!1,h=Object(b.createRef)(),y="";return f?y=r.ariaCardActionLink:m&&(y=i||r.ariaCardActionPostback),n<o?v.a.createElement(xr,Xe()({key:"button-"+n,text:s||u,ariaLabel:y,actions:c||t,bLink:f,bTextBack:m,onReplySelection:a,buttonRef:h},e)):null},xr=function(e){u()(n,e);var t=pr(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"setIsOverflow",(function(){var e=r.props.buttonRef;e.current&&(r.setState({isOverflown:!1}),e.current.scrollWidth>e.current.offsetWidth&&r.setState({isOverflown:!0}))})),r.state={isOverflown:!1},r}return i()(n,[{key:"componentDidMount",value:function(){this.setIsOverflow(),window.addEventListener("orientationchange",this.setIsOverflow),window.addEventListener("resize",this.setIsOverflow)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("orientationchange",this.setIsOverflow),window.removeEventListener("resize",this.setIsOverflow)}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.ariaLabel,r=e.actions,o=e.removeFocus,a=e.bLink,i=e.bTextBack,s=e.onReplySelection,c=e.buttonRef,l=e.containerRef,u=e.color,d=e.disableButton,p=e.textBackType,g=this.state.isOverflown,f=d||!1,m=function(){if(r&&Object.keys(r).length){var e=r||{},n=e.url,o=e.textback,c=e.payload;a?window.open(n,"_blank"):i&&((l=o||c)&&s({type:p||"card",postback:{text:t,payload:l}}))}var l};return v.a.createElement(dr.a,{disableSpacing:!0},f?v.a.createElement(Vt.a,{variant:"contained",size:"medium",dir:"auto",color:u,fullWidth:!0,tabIndex:o?-1:0,"aria-label":t,onClick:m,ref:c,disabled:f},t):v.a.createElement(Wn.a,{componentsProps:{tooltip:{sx:{width:"93%",maxHeight:"100px",overflowY:"auto",margin:"10px 0"}}},title:t,PopperProps:{container:l.current},disableHoverListener:!g,disableFocusListener:!g,disableTouchListener:!g},v.a.createElement(Vt.a,{variant:"contained",size:"medium",dir:"auto",color:u,fullWidth:!0,tabIndex:o?-1:0,"aria-label":t+". - "+n,onClick:m,ref:c,disabled:f},t)))}}]),n}(v.a.Component),wr=function(e){u()(n,e);var t=pr(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"handleKeyDown",(function(e){var t=(r.props||{}).handleKeyboardNavigation;e&&t&&t(e)})),h()(c()(r),"handleFocus",(function(e){var t=(r.props||{}).onFocus;e&&t&&t(e)})),h()(c()(r),"setAriaLabel",(function(e){var t=r.props||{},n=t.enableScreenReaderContent,o=t.statusText,a=n||!1,i=(t.oCallbacks||{}).personaLabel,s="";return a&&i&&(s=i()+" "),e&&(s+=e),a&&o&&(s=s+" "+o),s})),r.maxTextLength=80,r.maxButtonsLimit=3,r.cardRef=Object(b.createRef)(),r.handleKeyDown=r.handleKeyDown.bind(c()(r)),r.handleFocus=r.handleFocus.bind(c()(r)),r.cardStyles="",r}return i()(n,[{key:"componentDidUpdate",value:function(){var e=this,t=this.props||{},n=t.active,r=t.bEnableFocus,o=t.setFocusAndView,a=t.carouselRef;n&&this.cardRef.current&&r&&a.current&&(this.cardRef.current.focus(),setTimeout((function(){a.current.scrollTo(e.cardRef.current.offsetParent.offsetLeft-e.cardRef.current.offsetParent.offsetWidth/4,0)}),0),o(!1))}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.removeFocus,o=t.oCallbacks,a=t.transcriptContainerRef,i=t.time,s=t.toolTipPlacement,c=t.enableToolTip,l=t.bFirstSlide,u=t.bLastSlide,d=t.bCarousel,p=t.showTimer,g=t.progress,f=t.toolTipStyles,m=c||!1,h=(o||{}).onTooltipOpen;this.cardStyles=d?l?"mxg-card-first":u?"mxg-card-last":"mxg-card-carousel":"";var b=n||{},y=b.id,x=b.title,w=b.description,O=b.imageUrl,S=b.actions,E=b.buttons;return x&&null!==x?v.a.createElement(Wn.a,{componentsProps:{tooltip:{sx:function(e){return f(e)}},popper:{sx:{zIndex:0}}},disableInteractive:!0,enterDelay:500,title:i||" ",disableFocusListener:!m,disableHoverListener:!m,disableTouchListener:!m,PopperProps:{container:a&&a.current},placement:s||"right-start",onOpen:function(e){return h?h(e):""}},v.a.createElement(fr,{role:"region",className:this.cardStyles,ref:this.cardRef,tabIndex:r?-1:0,"aria-label":this.setAriaLabel(x),onKeyDown:function(t){return e.handleKeyDown(t)},onFocus:function(t){return e.handleFocus(t)}},p&&v.a.createElement(Wt.a,{sx:function(e){return function(e){return{"& .Cx-MuiLinearProgress-barColorPrimary":{backgroundColor:e.palette.primary.main},"&.Cx-MuiLinearProgress-colorPrimary":{backgroundColor:e.palette.background.paper}}}(e)},variant:"determinate",value:g||0}),v.a.createElement("div",{id:"cardButtons_"+y,className:"mxg-card-button"},E&&E.map((function(t,n){return v.a.createElement(yr,Xe()({key:n,button:t,index:n,maxButtonsLimit:e.maxButtonsLimit},e.props))})).reverse()),v.a.createElement(on.a,null,w&&v.a.createElement(vr,Xe()({text:w,actions:S,id:y,maxTextLength:this.maxTextLength},this.props)),x&&v.a.createElement(br,Xe()({text:x,actions:S,id:y,maxTextLength:this.maxTextLength},this.props))),O&&v.a.createElement(hr,Xe()({imageUrl:O,actions:S},this.props,{id:y})))):null}}]),n}(v.a.Component);wr.propTypes={color:x.a.string,data:x.a.object.isRequired,i18n:x.a.object.isRequired,onReplySelection:x.a.func.isRequired,removeFocus:x.a.bool,containerRef:x.a.object.isRequired};var Or=wr,Sr=n(597),Er=n(559),Cr=n.n(Er),kr=n(560),Rr=n.n(kr);function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var Pr=Object(Ot.n)(),Mr=Object(xt.a)("div")((function(e){var t;e.theme;return{position:"relative",width:null!==(t=e.props.humanizeConfig)&&void 0!==t&&t.enabled?"87%":"100%","& .Cx-Carousel":{display:"flex",flexWrap:"nowrap",overflowX:Pr?"auto":"hidden",clear:"both",position:"relative"},"& .Cx-Slide":{position:"relative",padding:"0 8px 5px 0px",display:"flex","&:first-of-type":{}},"&. Cx-SlideSingle":{maxWidth:"100%"}}})),Ar=function(e){return{position:"absolute",borderRadius:"50%",top:"109px",zIndex:"1",background:function(){return e.palette.background.default},boxShadow:"0px 3px 1px -2px rgba(0 0 0 / 20%), 0px 2px 2px 0px rgba(0 0 0 / 14%), 0px 1px 5px 0px rgba(0 0 0 / 12%)",transform:"rtl"===e.direction?"scaleX(-1)":void 0}},Ir=function(e){u()(n,e);var t=Dr(n);function n(e){var r;return o()(this,n),(r=t.call(this,e)).maxSlideLimit=10,r}return i()(n,[{key:"render",value:function(){switch((this.props||{}).carouselType){case"Cards":return v.a.createElement(Nr,Xe()({maxSlideLimit:this.maxSlideLimit},this.props));default:return null}}}]),n}(v.a.Component),Nr=function(e){u()(n,e);var t=Dr(n);function n(e){var r;return o()(this,n),(r=t.call(this,e)).totalSlides=0,r}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props||{},t=e.data,n=e.setSlideCount,r=e.maxSlideLimit,o=(t||{}).cards.filter((function(e){return e.title&&e.title.toString()}));o&&o.length&&r&&(o.length>r?n(r):n(o.length))}},{key:"beforeRender",value:function(){var e=this.props||{},t=e.data,n=e.maxSlideLimit,r=(t||{}).cards.filter((function(e){return e.title&&e.title.toString()}));r&&r.length&&n&&(r.length>n?this.totalSlides=n:this.totalSlides=r.length)}},{key:"render",value:function(){var e=this,t=this.props||{},n=t.data,r=t.removeFocus,o=t.onReplySelection,a=t.conversationRef,i=t.onContentAdded,s=t.i18n,c=t.color,l=t.maxSlideLimit,u=t.setTabIndex,d=t.handleKeyboardNavigation,p=t.slideIndex,g=t.bEnableFocus,f=t.setAriaLabel,m=t.setFocusAndView,h=t.carouselRef,b=t.bOrientationChanged,y=t.onFocus,x=(n||{}).cards.filter((function(e){return e.title&&e.title.toString()}));return this.beforeRender(),x&&x.length?v.a.createElement("div",{ref:h,className:"Cx-Carousel",tabIndex:-1},x.map((function(t,n){return n<l?v.a.createElement("div",{key:n,className:x.length>1?"Cx-Slide"+(p==n?" active":""):"Cx-SlideSingle"},v.a.createElement(Or,{data:t,color:c,i18n:s,onReplySelection:o,removeFocus:r||u(n),containerRef:a,onContentAdded:i,handleKeyboardNavigation:d,onFocus:y,bFirstSlide:x.length>1&&0==n||!1,bLastSlide:x.length>1&&n==e.totalSlides-1||!1,active:p==n||!1,bEnableFocus:g,enableScreenReaderContent:x.length>1,statusText:f(n),setFocusAndView:m,bOrientationChanged:b,bCarousel:x.length>1,carouselRef:h})):null}))):null}}]),n}(v.a.Component),Fr=function(e){u()(n,e);var t=Dr(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"handleLeftNavigation",(function(){var e=r.state.slideIndex;0!==e&&r.setState({slideIndex:e-1,bEnableFocus:!0})})),h()(c()(r),"handleRightNavigation",(function(){var e=r.state,t=e.slideIndex;t!==e.totalSlides-1&&r.setState({slideIndex:t+1,bEnableFocus:!0})})),h()(c()(r),"handleKeyboardNavigation",(function(e){var t=e||{},n=t.which,o=t.currentTarget,a=t.target,i=t.ctrlKey,s=t.shiftKey;switch(n||""){case 37:i||s||(e.preventDefault(),o&&o!==a?o.focus():r.handleLeftNavigation());break;case 39:i||s||(e.preventDefault(),o&&o!==a?o.focus():r.handleRightNavigation());break;case 9:if(s&&r.state.bFocussed){e.preventDefault();var c=o.querySelectorAll('*[tabindex="0"]');r.setState({bFocussed:!1}),o&&o==a&&c&&c[c.length-1].focus()}}})),h()(c()(r),"onFocus",(function(e){if(Pr){var t=(e||{}).currentTarget,n=t&&t.offsetParent.getBoundingClientRect();r.carouselRef.current&&n&&(n.left<0||n.right>(window.innerWidth||document.documentElement.clientWidth))&&setTimeout((function(){r.carouselRef.current&&r.carouselRef.current.scrollTo(t.offsetParent.offsetLeft-t.offsetParent.offsetWidth/4,0)}),0)}})),h()(c()(r),"onKeyPress",(function(e,t){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||(t&&("left"==t&&r.handleLeftNavigation(),"right"==t&&r.handleRightNavigation()),e.preventDefault())})),h()(c()(r),"setTabIndex",(function(e){var t=r.state,n=t.bShowArrowButtons,o=t.slideIndex;return!(!n||o===e)})),h()(c()(r),"setAriaLabel",(function(e){var t=r.props.i18n||{},n=t.ariaSlideActive,o=t.ariaTabKeyNavigation,a=t.ariaArrowKeyNavigation,i={"<%activeSlide%>":e+1,"<%totalSlides%>":r.state.totalSlides};if(n){for(var s in i)-1!==n.indexOf(s)&&(n=n.replace(s,i[s]));if(Pr||(n=n+" "+o),r.state.totalSlides>1)return Pr||(n=n+" "+a),n}})),h()(c()(r),"setFocusAndView",(function(e){r.setState({bEnableFocus:e,bFocussed:!0})})),h()(c()(r),"setSlideCount",(function(e){r.setState({totalSlides:e})})),h()(c()(r),"setArrowButtonVisibility",(function(e){var t=(e||{}).type;r.carouselRef.current&&(r.setState({bShowArrowButtons:!1,bOrientationChanged:t&&"orientationchange"==t||!1}),r.carouselRef.current.scrollWidth>r.carouselRef.current.offsetWidth&&!Pr&&r.setState({bShowArrowButtons:!0}))})),r.carouselRef=Object(b.createRef)(),r.state={slideIndex:0,bEnableFocus:!1,totalSlides:0,bShowArrowButtons:!1,bFocussed:!1,bOrientationChanged:!1},r.showLeftArrow=!1,r.showRightArrow=!1,r.setFocusAndView=r.setFocusAndView.bind(c()(r)),r.handleLeftNavigation=r.handleLeftNavigation.bind(c()(r)),r.handleRightNavigation=r.handleRightNavigation.bind(c()(r)),r.onKeyPress=r.onKeyPress.bind(c()(r)),r.setTabIndex=r.setTabIndex.bind(c()(r)),r.setArrowButtonVisibility=r.setArrowButtonVisibility.bind(c()(r)),r.onFocus=r.onFocus.bind(c()(r)),r}return i()(n,[{key:"componentDidUpdate",value:function(){var e=this;this.state.bOrientationChanged&&this.carouselRef.current&&Pr&&(setTimeout((function(){e.carouselRef.current.scrollTo({left:e.carouselRef.current.children[0].offsetLeft-10})}),0),this.setState({bOrientationChanged:!1}))}},{key:"componentDidMount",value:function(){this.setArrowButtonVisibility(),window.addEventListener("orientationchange",this.setArrowButtonVisibility),window.addEventListener("resize",this.setArrowButtonVisibility)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("orientationchange",this.setArrowButtonVisibility),window.removeEventListener("resize",this.setArrowButtonVisibility)}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.removeFocus,o=t.i18n,a=t.enableToolTip,i=t.time,s=t.oCallbacks,c=t.transcriptContainerRef,l=t.toolTipStyles,u=this.state||{},d=u.slideIndex,p=u.bEnableFocus,g=u.totalSlides,f=u.bShowArrowButtons,m=u.bOrientationChanged,h=a||!1,b=(s||{}).onTooltipOpen,y=o||{},x=y.ariaNextButton,w=y.ariaPreviousButton;this.showLeftArrow=d>0||!1,this.showRightArrow=d<g-1||!1;var O={width:"26px",height:"26px",display:"flex",alignItems:"inherit",justifyContent:"inherit"};return n&&Object.keys(n).length?v.a.createElement(Wn.a,{componentsProps:{tooltip:{sx:function(e){return l(e)}},popper:{sx:{zIndex:0}}},disableInteractive:!0,enterDelay:500,title:i||" ",disableFocusListener:!h,disableHoverListener:!h,disableTouchListener:!h,PopperProps:{container:c&&c.current},placement:"top-end",onOpen:function(e){return b?b(e):""}},v.a.createElement(Mr,{props:this.props},f&&this.showLeftArrow&&v.a.createElement(Sr.a,{sx:function(e){return jr(jr({},Ar(e)),{},{left:"0"})}},v.a.createElement(yt.a,{size:"small",sx:{padding:"3px"},children:v.a.createElement(Cr.a,{fontSize:"small","aria-hidden":"true",alt:"",sx:jr({},O)}),"aria-label":w,onClick:this.handleLeftNavigation,onKeyPress:function(t){e.onKeyPress(t,"left")},disabled:r||!1,tabIndex:r?-1:0})),f&&this.showRightArrow&&v.a.createElement(Sr.a,{sx:function(e){return jr(jr({},Ar(e)),{},{right:"0"})}},v.a.createElement(yt.a,{size:"small",sx:{padding:"3px"},children:v.a.createElement(Rr.a,{fontSize:"small","aria-hidden":"true",alt:"",sx:jr({},O)}),"aria-label":x,onClick:this.handleRightNavigation,onKeyPress:function(t){e.onKeyPress(t,"right")},disabled:r||!1,tabIndex:r?-1:0})),v.a.createElement(Ir,Xe()({slideIndex:d,bEnableFocus:p,setTabIndex:this.setTabIndex,handleKeyboardNavigation:this.handleKeyboardNavigation,setFocusAndView:this.setFocusAndView,setAriaLabel:this.setAriaLabel,setSlideCount:this.setSlideCount,carouselRef:this.carouselRef,bOrientationChanged:m,onFocus:this.onFocus},this.props)))):null}}]),n}(v.a.Component);Fr.propTypes={data:x.a.object.isRequired,carouselType:x.a.string.isRequired,color:x.a.string,i18n:x.a.object.isRequired,onReplySelection:x.a.func.isRequired,removeFocus:x.a.bool,conversationRef:x.a.object.isRequired};var Lr=Fr,Br=v.a.useRef,Hr=!1,Kr=!1;function zr(e){var t=Br(),n=e.message,r=e.color,o=e.i18n,a=e.onSelection,i=e.options,s=e.newMessage,c=e.bDisableTabStop,l=e.disableFocus,u=e.conversationRef,d=e.onContentAdded,p=e.showAgentAvatar,g=e.showBotAvatar,f=e.humanizeConfig,m=e.participantName,b=e.time,y=e.transcriptContainerRef,x=e.oCallbacks,w=e.toolTipPlacement,O=n||{},S=O.quickReplies,E=O.contentType,C=O.card,k=O.carousel,R=O.carouselType,T=(f||{}).enabled,j=((i||{}).quickReply||{}).mode,D=c||l;j&&"advanced"===j&&(Kr=!0);var P=function(e){Hr=!1,a(e)},M=Object(xt.a)(it.a)((function(e){return{color:e.theme.palette.common.mediumGrey,paddingLeft:"46px","& .ellipsis":{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre",maxWidth:"65%"}}})),A=Object(xt.a)("div")((function(){return{alignSelf:"flex-end",padding:"0px 6px 4px 0px",width:"40px",height:"40px"}})),I=Object(xt.a)("span")((function(){return{display:T?"flex":""}})),N=function(e){var t;return t={backgroundColor:e.palette.common.white,color:e.palette.common.mediumGrey,boxShadow:e.shadows[1],fontSize:"0.70rem",fontWeight:"400"},h()(t,"boxShadow","none"),h()(t,"padding","2px 8px"),t};switch(Hr&&s&&Object.keys(s).length&&n.id!==s.id&&!Kr&&t.current&&t.current.removeQuickReply(),E){case"quick-replies":return Hr=!0,v.a.createElement(v.a.Fragment,null,T&&(p||g)&&v.a.createElement(M,{variant:"caption"},v.a.createElement("span",{className:"ellipsis"},m),v.a.createElement("span",{className:"ellipsis"},m&&v.a.createElement("span",null,"  "),b)),v.a.createElement(cr,{ref:t,mode:j,data:S,color:r,i18n:o,onReplySelection:P,removeFocus:D,containerRef:u}));case"card":return v.a.createElement(I,null,T&&v.a.createElement(A,null,v.a.createElement(hn,{humanizeConfig:f,message:n,showAgentAvatar:p,showBotAvatar:g})),v.a.createElement(Or,{data:C,color:r,i18n:o,onReplySelection:P,removeFocus:D,containerRef:u,onContentAdded:d,enableToolTip:!0,transcriptContainerRef:y,oCallbacks:x,toolTipPlacement:w,time:b,toolTipStyles:N}));case"carousel":return v.a.createElement(I,null,T&&v.a.createElement(A,null,v.a.createElement(hn,{humanizeConfig:f,message:n,showAgentAvatar:p,showBotAvatar:g})),v.a.createElement(Lr,Xe()({data:k,enableToolTip:!0,carouselType:R,onReplySelection:P,removeFocus:D,toolTipStyles:N},e)));default:return null}}zr.propTypes={message:x.a.object.isRequired,newMessage:x.a.object,color:x.a.string.isRequired,i18n:x.a.object.isRequired,options:x.a.object.isRequired,onSelection:x.a.func.isRequired};var qr=n(196);function Ur(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var _r=function(e){u()(n,e);var t=Ur(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"handleOffer",(function(){var e=r.props,t=e.message,n=e.getCobrowseOfferState,o=e.bOfferAttended,a=e.bOfferExpired,i=(t||{}).coBrowse;if(i&&Object.keys(i).length){var s=i.type;s&&s===bn.z&&n(i).then((function(e){var t=e||{},n=t.offerState,i=t.sessionId,s=t.timeout,c=t.timestamp;n&&(n===bn.b&&(r.bShowTimer=!0,s&&c&&(r.iTimeout=s,r.iOfferTimeOut=Math.ceil((new Date(s)-new Date(c))/1e3),r.iProgress=Math.ceil(r.iOfferTimeOut/60*100))),r.setState({loaded:!0,offerState:n,attended:o,expired:a,sessionId:i,progress:r.iProgress}))})).catch((function(){}))}})),h()(c()(r),"setButtonText",(function(){var e=r.state||{},t=e.offerState,n=e.sessionId,o=((r.props||{}).i18n||{}).cobrowse;t&&n&&(r.offerMessage.buttons=[{title:o["".concat(t)]||"",actions:{textback:{sessionId:n}}}])})),h()(c()(r),"onReplySelection",(function(e){var t=r.props,n=t.onSelection,o=t.acceptCobrowseSession,a=t.declineCobrowseSession;if(e){var i=((e||{}).postback||{}).payload,s=(i||{}).type;s===bn.A?o(i):s===bn.C&&a(i),n(e)}})),r.cobrowseRef=Object(b.createRef)(),r.state={loaded:!1,offerState:"",attended:!1,expired:!1,sessionId:"",progress:100},r.bExpiredEvent=!1,r.bShowTimer=!1,r.iTimer=0,r.iTimerTimeout="",r.iOfferTimeOut=null,r.iTimeout=null,r.iProgress=null,r.bCobrowseScrollDown=!1,r.offerMessage={},r.aOfferStates=[bn.a,bn.G,bn.q],r.handleOffer=r.handleOffer.bind(c()(r)),r.onReplySelection=r.onReplySelection.bind(c()(r)),r.setButtonText=r.setButtonText.bind(c()(r)),r.setProgress=r.setProgress.bind(c()(r)),r.aScreenReadingIntervals=[75,50,25],r.toolTipStyles=function(e){var t;return t={backgroundColor:e.palette.common.white,color:e.palette.common.mediumGrey,boxShadow:e.shadows[1],fontSize:"0.70rem",fontWeight:"400"},h()(t,"boxShadow","none"),h()(t,"padding","2px 8px"),t},r}return i()(n,[{key:"setProgress",value:function(e){var t=this;this.iTimer=setTimeout((function(){0===e?t.bShowTimer=!1:t.setState({progress:e-1})}),600)}},{key:"componentDidMount",value:function(){this.handleOffer()}},{key:"componentDidUpdate",value:function(){var e=this.state,t=e.loaded,n=e.attended,r=e.expired,o=this.props,a=o.onContentAdded,i=o.message,s=o.bOfferAttended,c=o.bOfferExpired,l=o.scrollDown,u=(i||{}).coBrowse;if(t&&this.cobrowseRef.current&&this.bShowTimer&&100==this.iProgress?a():t&&this.cobrowseRef.current&&!this.bCobrowseScrollDown&&l&&(this.bCobrowseScrollDown=!0,a()),this.bShowTimer){var d=Math.floor((new Date(this.iTimeout)-new Date)/1e3);this.iProgress=Math.ceil(d/60*100),this.setProgress(this.iProgress)}u&&Object.keys(u).length&&((u||{}).sessionId&&(c?r?(this.bShowTimer=!1,clearTimeout(this.iTimer)):this.handleOffer():s&&(this.bShowTimer=!1,clearTimeout(this.iTimer),n||this.handleOffer())))}},{key:"render",value:function(){var e=this,t=this.props,n=t.bDisableTabStop,r=t.disableFocus,o=t.conversationRef,a=t.onContentAdded,i=t.i18n,s=t.message,c=[],l=this.state,u=l.offerState,d=l.loaded,p=l.progress,g=n||r,f=this.cobrowseRef,m=this.onReplySelection,h=this.aOfferStates,b=i||{},y=b.cobrowse,x=b.ariaLoading,w=b.ariaCobrowseActionPostback,O=b.ariaRemainingSeconds,S=y||{},E=S.offerTitle,C=S.offerDescription,k=S.acceptButton,R=S.declineButton,T=S.offerStatusNotification,j=(s||{}).coBrowse;if(j&&Object.keys(j).length){var D=j.id,P=j.sessionId,M=j.sessionJoinToken;this.offerMessage={id:D,title:E,description:C,buttons:[{title:k,actions:{textback:{type:bn.A,sessionId:P,sessionJoinToken:M}}},{title:R,actions:{textback:{type:bn.C,sessionId:P,sessionJoinToken:M}}}]}}u&&(u!==bn.b&&this.setButtonText(),c.push(this.offerMessage));var A=c&&c[0]||{},I=function(){var t="";if(d){if(T)if(u==bn.b&&100!=p){var n=Math.ceil(e.iOfferTimeOut*p/100);t=-1!=e.aScreenReadingIntervals.indexOf(p)?n+" "+O:""}else t=T.replace("<%state%>",u)}else t=x;return t},N=-1!==h.indexOf(u);return v.a.createElement("div",null,!d&&v.a.createElement(Gn.a,{width:230,variant:"rectangular",height:118,"aria-busy":"true",role:"alert","aria-label":x}),v.a.createElement(Or,Xe()({ref:f,data:A,removeFocus:g,containerRef:o,onContentAdded:a,disableButton:N,onReplySelection:m,statusText:I(),enableToolTip:!0,enableScreenReaderContent:!0,textBackType:bn.i,cardActionLabel:w,showTimer:this.bShowTimer,progress:this.state.progress,toolTipStyles:this.toolTipStyles},this.props)),v.a.createElement("div",{className:"cx-messenger-screen-reader","aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",tabIndex:-1,dangerouslySetInnerHTML:{__html:Object(vn.b)(I())}}))}}]),n}(v.a.Component);_r.propTypes={message:x.a.object.isRequired,color:x.a.string.isRequired,i18n:x.a.object.isRequired,conversationRef:x.a.object.isRequired,onSelection:x.a.func.isRequired};var Wr=function(e){return function(t){return v.a.createElement(wt.a.Consumer,null,(function(n){var r=n.getCobrowseOfferState,o=n.acceptCobrowseSession,a=n.declineCobrowseSession;return v.a.createElement(e,Xe()({},t,{getCobrowseOfferState:r,acceptCobrowseSession:o,declineCobrowseSession:a}))}))}}(_r),Vr=Object(xt.a)("div")((function(){return{"& .mxg-skeleton-image":{backgroundColor:"#eeeeee"},"& .mxg-image-bubble":{borderRadius:"8px 0px 8px 8px"}}})),Gr=function(e){var t=Object(b.useState)(!1),n=Ge()(t,2),r=n[0],o=n[1],a=e.file,i=e.messageType,s=e.onErrorLoadingFile,c=e.onOpenFilePrev,l=e.FilePrevComp,u=e.bDisableTabStop,d=e.i18n,p=(e.time,e.onContentAdded),g=Object(b.useRef)(null),f=d.ariaActionsImagePreviewTitle,m=d.ariaBusinessSaid,h=d.ariaYouSaid,y={};Object(vn.d)(a.downloadUrl)||(y.crossOrigin="anonymous");return v.a.createElement(Vr,null,!r&&v.a.createElement(Gn.a,{variant:"rectangular",height:118,width:256,className:"mxg-skeleton-image"}),v.a.createElement("div",{role:"link",tabIndex:u?-1:0,title:f,onKeyPress:function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||c(l,a,i)},className:"mxg-image-bubble"},v.a.createElement("img",Xe()({src:a.downloadUrl,key:a.downloadUrl,className:"mxg-image",onLoad:function(){o(!0);var e=setInterval((function(){g.current&&g.current.naturalWidth>0&&g.current.naturalHeight>0&&(clearInterval(e),p()),setTimeout((function(){e&&clearInterval(e)}),1e4)}),20)},onError:function(e){s(a),o(!1)},style:r?{}:{display:"none"},onClick:function(e){c(l,a,i),e.preventDefault()},alt:"","aria-label":"outbound"===i?m+" "+a.name:h+" "+a.name,ref:g},y))))},$r=n(592),Yr=n(593);function Qr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var Xr=v.a.createRef,Jr=function(e){u()(n,e);var t=Qr(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"setIsOverflow",(function(){r.props.text;if(r.setState({isOverflown:!1}),r.textRef.current){var e=r.textRef.current;e.scrollWidth>e.offsetWidth&&r.setState({isOverflown:!0})}})),r.state={isOverflown:!1},r.textRef=Xr(),r}return i()(n,[{key:"componentDidMount",value:function(){this.setIsOverflow(),window.addEventListener("orientationchange",this.setIsOverflow),window.addEventListener("resize",this.setIsOverflow)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("orientationchange",this.setIsOverflow),window.removeEventListener("resize",this.setIsOverflow)}},{key:"render",value:function(){var e=this.props.text,t=this.state.isOverflown;return v.a.createElement(Wn.a,{componentsProps:{tooltip:{sx:{width:"93%",maxHeight:"100px",overflowY:"auto",margin:"10px 0"}},popper:{sx:{zIndex:99999}}},title:e,disableHoverListener:!t,disableFocusListener:!t,disableTouchListener:!t,enterTouchDelay:1500},v.a.createElement(it.a,{variant:"body2",noWrap:!0,ref:this.textRef,dangerouslySetInnerHTML:{__html:"<span dir='auto' className='mxg-text'>"+Object(vn.b)(e)+"</span>"}}))}}]),n}(v.a.Component);Jr.propTypes={text:x.a.string.isRequired};var Zr=Jr;function eo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function to(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eo(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var no=Object(Ot.i)().browser||"",ro=!(!no||"Internet Explorer"!==no);Object(Ot.i)().os;function oo(e,t){var n=(e||{}).downloadUrl;return(t||{}).downloadUrl===n}var ao=function(e){var t=e.downloadUrl,n=e.mediaType,r=e.mimeType,o=e.name,a=e.size,i=e.downloadFile,s=e.i18n,c=e.direction,l=e.onMediaLinkExpired,u=e.file,d=(u||{}).updatedTime,p=r&&r.length?Object(Ot.g)(r):"",g=!(!n||"Image"!==n),f=!(!n||"Audio"!==n),m=!(!n||"Video"!==n),h=!(!r||"text/plain"!==r),y=!(!r||"application/pdf"!==r),x=!(!y&&!h),w=!(!p||-1===["Document","PDF","Presentation","Spreadsheet","Text"].indexOf(p)),O=!(!p||"File"!==p),S=Object(Ot.i)(),E=S.browser,C="iOS"==S.os&&"Chrome"==E,k=Object(b.useState)(!1),R=Ge()(k,2),T=R[0],j=R[1],D=Object(b.useState)(!1),P=Ge()(D,2),M=P[0],A=P[1],I=s.ariaLoading,N=Object(b.useRef)(null),F=Object(b.useRef)(null),L=Object(b.useRef)(null),B=Object(b.useRef)(null),H="",K=!1;(m||f)&&(H=Object(Ot.c)(n,r)),g&&(K=Object(Ot.d)(r));var z=!(!m||!H),q=!(!f||!H),U=!(!g||!K),_=!!(!x&&!z&&!q&&!U||m&&!H||f&&!H||g&&!K),W=!t||!(x||z||q||U),V={},G=Object(xt.a)("div")((function(e){e.theme,e.props;return{height:"100%",position:"relative",boxSizing:"border-box","& .mxg-file-preview":{height:"84%",padding:"8px",display:"flex",boxSizing:"border-box",alignItems:"center",justifyContent:"center"},"& .mxg-iconButton":{padding:"8px"},"& .mxg-file-preview-fileinfo":{width:"100%"},"& .mxg-file-preview-footer":{height:"60px",width:"100%",display:"flex",padding:"8px 4px",boxSizing:"border-box",position:"absolute",bottom:"0px"},"& .mxg-file-preview-footerRight":{width:"50%",textAlign:"right"},"& .mxg-file-preview-details":{textAlign:"center"},"& .mxg-file-preview-icon":{textAlign:"center"},"& .mxg-file-preview-filesize":{fontSize:"10px",lineHeight:"16px"},"& .mxg-file-preview-attachment-type":{fontSize:"10px",lineHeight:"16px"},"& .mxg-file-preview-video":{width:"100%",maxHeight:"100%",maxWidth:"100%",cursor:"pointer","&:-moz-focusring":{outlineColor:"#000",outlineStyle:"solid"}},"& .mxg-file-preview-audio":{width:"100%",maxHeight:"100%",maxWidth:"100%",cursor:"pointer","&:-moz-focusring":{outlineColor:"#000",outlineStyle:"solid"}}}})),$={popper:{top:"10px",zIndex:99999}},Y={width:"52px",height:"52px",margin:"auto"},Q=function(){j(!0)},X={showImage:{width:ro?"100%":"auto",maxHeight:"100%",maxWidth:"100%",display:"block",margin:"auto"},hideImage:{display:"none",maxHeight:"100%",maxWidth:"100%",margin:"auto"},showDocument:{display:"block",width:"100%",height:"100%",maxHeight:"100%",maxWidth:"100%",margin:"auto"},hideDocument:{display:"none",maxHeight:"100%",maxWidth:"100%",margin:"auto"},footerLeft:{display:"flex",padding:"0 12px",flexDirection:"column",width:"50%"},filename:{whiteSpace:"no-wrap",overflow:"hidden",textOverflow:"ellipsis"}},J={};Object(vn.d)(t)||(J.crossOrigin="anonymous");var Z=function(e){"function"==typeof i&&i({downloadUrl:t,name:o}),e.preventDefault()},ee=function(e){l(u),A("fetching")};t&&!C&&N.current&&N.current.focus();var te={width:"26px",height:"26px",display:"flex",alignItems:"inherit",justifyContent:"inherit"};return Object(b.useEffect)((function(){"fetching"===M&&A("fetched")}),[M]),(M&&"fetched"===M||d)&&(V.autoPlay=!0),M&&"fetching"===M&&L.current&&(L.current.style.opacity="0.5",L.current.style.pointerEvents="none"),M&&"fetching"===M&&B.current&&(B.current.style.opacity="0.5",B.current.style.pointerEvents="none"),v.a.createElement(G,{tabIndex:0,"aria-labelledby":"file_description"},v.a.createElement("div",{className:"mxg-file-preview ".concat(!g&&"mxg-multiple-files")},!T&&(x||z||q)&&v.a.createElement(Sr.a,{sx:{position:"relative",display:"inline-flex",transform:"rtl"===c?"scaleX(-1)":void 0}},v.a.createElement(_n.a,{"aria-busy":"true",role:"alert","aria-label":I})),t&&g&&U&&v.a.createElement("img",Xe()({src:t,key:t,style:T?X.showImage:X.hideImage,alt:"",onLoad:Q},J)),t&&y&&v.a.createElement("iframe",{title:s.pdfPreviewTitle,name:s.pdfPreviewTitle,ref:F,key:t,src:"".concat(t,"#view=fitH"),allow:"fullscreen",type:r,onLoad:Q,id:"mxg-file-preview-frame",style:T?X.showDocument:X.hideDocument}),t&&h&&v.a.createElement("iframe",{title:s.textFilePreviewTitle,name:s.textFilePreviewTitle,src:"".concat(t),key:t,allow:"fullscreen",type:r,onLoad:Q,id:"mxg-file-preview-text",style:T?X.showDocument:X.hideDocument}),t&&z&&v.a.createElement("video",Xe()({playsInline:!0,src:"".concat(t,"#t=0.001"),key:t,preload:"metadata",controls:!0,className:"mxg-file-preview-video",type:r,onLoadedMetadata:Q,onError:ee,style:T?{}:{display:"none"},ref:L},J,V)),t&&q&&v.a.createElement("audio",Xe()({src:t,key:t,preload:"metadata",controls:!0,className:"mxg-file-preview-audio",type:r,onLoadedMetadata:Q,onError:ee,ref:B,style:T?{}:{display:"none"}},J)),t&&_&&v.a.createElement("div",{className:"mxg-file-preview-fileinfo"},v.a.createElement("div",{className:"mxg-file-preview-icon"},g&&v.a.createElement(Qn.a,{sx:to({},Y)}),f&&v.a.createElement(Yn.a,{sx:to({},Y)}),m&&v.a.createElement($n.a,{sx:to({},Y)}),w&&v.a.createElement(Jn.a,{sx:to({},Y)}),O&&v.a.createElement(Xn.a,{sx:to({},Y)})),v.a.createElement("div",{className:"mxg-file-preview-details"},v.a.createElement(Zr,{className:"mxg-file-preview-filename",text:o}),a&&v.a.createElement(it.a,{className:"mxg-file-preview-filesize",variant:"body2"},Object(Ot.f)(a)),p&&v.a.createElement(it.a,{className:"mxg-file-preview-attachment-type",variant:"body2"},p))),M&&"fetching"===M&&v.a.createElement(_n.a,{"aria-busy":"true",role:"alert","aria-label":I,sx:{width:"60px",height:"60px",position:"absolute"}})),v.a.createElement("div",{className:"mxg-file-preview-footer"},v.a.createElement("div",{style:X.footerLeft,id:"file_description"},v.a.createElement(Zr,{className:"mxg-file-preview-footer-name",text:o}),a&&v.a.createElement(it.a,{variant:"body2",className:"mxg-file-preview-footer-size"},Object(Ot.f)(a))),v.a.createElement("div",{className:"mxg-file-preview-footerRight"},!C&&v.a.createElement(Wn.a,{disableInteractive:!0,componentsProps:{popper:{sx:$.popper}},enterDelay:1500,title:s.downloadButton,placement:"top-start"},v.a.createElement(yt.a,{ref:N,onClick:Z,className:"mxg-iconButton mxg-file-preview-downloadBtn",children:v.a.createElement($r.a,{"aria-hidden":"true",alt:"",sx:to({},te)}),"aria-label":s.ariaDownloadButton,tabIndex:0,onKeyUp:function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||Z(e)},disabled:!t,size:"large"})),v.a.createElement(Wn.a,{disableInteractive:!0,componentsProps:{popper:{sx:$.popper}},enterDelay:1500,title:s.openInNewTabButton,placement:"top-start"},v.a.createElement(yt.a,{href:t,className:"mxg-iconButton mxg-file-preview-newTabBtn",target:"_blank",rel:"noopener noreferrer",children:v.a.createElement(Tt.a,{icon:Yr.a,"aria-hidden":"true",alt:"",customStyle:te}),"aria-label":s.ariaOpenAttachmentButton,tabIndex:0,onKeyUp:function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||e.target.click()},disabled:W,size:"large"})))))},io=v.a.memo(ao,oo);function so(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function co(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?so(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):so(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lo=Object(Ot.i)().browser||"",uo=!(!lo||"Internet Explorer"!==lo);var po=Object(qr.a)(),go=Object(xt.a)("div")((function(){return{display:"flex","& .mxg-humanize":{alignSelf:"flex-end",padding:"0px 6px 4px 0px",width:"40px",height:"40px"}}})),fo=Object(xt.a)("div")((function(e){var t=e.theme,n=e.props;return{"& .mxg-message-bubble":{padding:"12px",width:"auto",maxWidth:"75%",whiteSpace:"pre-wrap",wordBreak:"break-word",wordWrap:"break-word",overflowWrap:"break-word"},"& .mxg-humanize":{alignSelf:"flex-end",padding:"0px 6px 4px 0px",width:"40px",height:"40px"},"& .mxg-attachment":{padding:"0",background:"none!important"},"& .mxg-attachment-other":{width:"100%"},"& .mxg-inbound":{borderRadius:"8px 0px 8px 8px",background:t.palette[n.color].main,color:t.palette[n.color].contrastText,"&:-moz-focusring":{outlineColor:function(){return"light"==t.palette.mode?t.palette.getContrastText(t.palette.background.default):"inherit"},outlineStyle:"solid"}},"& .mxg-outbound":{color:"#000",borderRadius:"0px 8px 8px 8px",background:"#ECECEC","&:-moz-focusring":{outlineStyle:"solid"}},"& .mxg-generic-attachment-bubble":{display:"flex",flexDirection:"column"},"& .mxg-generic-attachment-bubble-container":{display:"flex",margin:"0px",padding:"12px",backgroundColor:t.palette[n.color].main,color:t.palette[n.color].contrastText,"&:hover":{backgroundColor:Object(Vn.c)(t.palette[n.color].main,.07)}},"& .mxg-generic-attachment-bubble-withtext":{borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"},"& .mxg-attachment-with-text":{flex:"0 0 75%"},"& .mxg-generic-attachment-body":{display:"flex",flexDirection:"column",padding:"1px 6px",flex:"1 1 auto",minWidth:0,cursor:"pointer"},"& .mxg-generic-attachment-file-data":{display:"flex",flexDirection:"row"},"& .mxg-generic-attachment-filename-container":{display:"flex"},"& .mxg-filename":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},"& .mxg-generic-attachment-filesize":{fontSize:"10px",lineHeight:"16px",flexShrink:"0"},"& .mxg-generic-attachment-type":{fontSize:"10px",lineHeight:"16px",paddingLeft:"6px"},"& .mxg-generic-attachment-text":{marginTop:"1px",padding:"4px 10px 8px 12px",background:t.palette[n.color].main,borderRadius:"0px 0px 8px 8px"},"& .mxg-skeleton-image":{backgroundColor:"#eeeeee"},"& .mxg-image-bubble":{borderRadius:"8px 0px 8px 8px"},"& .mxg-imageText-bubbleContainer":{position:"relative",textAlign:"center"},"& .mxg-imageText":{padding:"4px 10px 8px 10px",background:t.palette[n.color].main,borderRadius:"0px 0px 8px 8px"},"& .mxg-image":{width:uo?"100%":"auto",maxHeight:"100%",maxWidth:"100%",cursor:"pointer",borderTopLeftRadius:"7px",display:"block",minHeight:"3em","&:-moz-focusring":{outlineColor:"#000",outlineStyle:"solid"}},"& .mxg-markdown":{"& pre":{display:"block",padding:"9px",wordBreak:"break-word",wordWrap:"break-word",borderRadius:"4px",border:"1px solid",whiteSpace:"pre-wrap"},"& code":{padding:"0px 6px 2px 6px"}},"& .mxg-emojiOnly":{fontSize:"2.814rem"},"& .mxg-skeleton-video":{backgroundColor:"#eeeeee",width:"100%",height:"25vh",marginBottom:"3px",minHeight:"25vh"},"& .mxg-video-bubble":{borderRadius:"8px 0px 8px 8px"},"& .mxg-video-bubble-container":{position:"relative",textAlign:"center",justifyContent:"center",display:"flex",alignItems:"center"},"& .mxg-video-details":{padding:"4px 10px",background:t.palette[n.color].main,borderTopLeftRadius:"8px",display:"flex",cursor:"pointer"},"& .mxg-video-details-body":{display:"flex",flexDirection:"column",padding:"1px 6px",flex:"1 1 auto",minWidth:0},"& .mxg-video-file-data":{display:"flex",flexDirection:"row"},"& .mxg-video-filename-container":{display:"flex"},"& .mxg-video-filesize":{fontSize:"10px",lineHeight:"16px",flexShrink:"0"},"& .mxg-video":{width:"100%",maxHeight:"100%",maxWidth:"100%",cursor:"pointer","&:-moz-focusring":{outlineColor:"#000",outlineStyle:"solid"}},"& .mxg-media-no-text":{borderRadius:"0px 0px 8px 8px"},"& .mxg-video-text":{marginTop:"-3px",padding:"4px 10px 8px 10px",background:t.palette[n.color].main,borderRadius:"0px 0px 8px 8px"}}})),mo=function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||(e.preventDefault(),"a"===e.target.tagName.toLowerCase()&&e.target.click())},ho=function(e){var t=e.messageId,n=e.ariaSaid,r=e.text,o=!1;return r&&function(e){var t=!1,n=Object(Ot.e)();return e&&n.test(e)&&(t=!0),t}(r)&&(o=!0),v.a.createElement("div",{id:t},v.a.createElement("div",{className:"aria-name cx-messenger-screen-reader","aria-label":n,tabIndex:-1},n),v.a.createElement(it.a,{variant:"body2",onKeyPress:mo,className:"mxg-markdown".concat(o?" mxg-emojiOnly":""),dir:"auto",dangerouslySetInnerHTML:{__html:Object(vn.b)(e.text)}}))},bo=function(e){var t=Object(b.useState)(!1),n=Ge()(t,2),r=n[0],o=n[1],a=e.file,i=e.messageType,s=e.text,c=e.onErrorLoadingFile,l=e.onOpenFilePrev,u=e.FilePrevComp,d=e.bDisableTabStop,p=e.i18n,g=e.onContentAdded,f=e.messageId,m=e.ariaSaid,h=Object(b.useRef)(null),y=p.ariaActionsImagePreviewTitle,x={};Object(vn.d)(a.downloadUrl)||(x.crossOrigin="anonymous");return v.a.createElement("div",{id:f},v.a.createElement("div",{className:"aria-name cx-messenger-screen-reader","aria-label":m,tabIndex:-1},e.ariaSaid),!r&&v.a.createElement(Gn.a,{variant:"rectangular",height:118,width:256,className:"mxg-skeleton-image"}),v.a.createElement("div",{role:"link",tabIndex:d?-1:0,title:y,onKeyPress:function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||l(u,a,i)},className:"mxg-image-bubble"},v.a.createElement("div",{className:"mxg-imageText-bubbleContainer"},v.a.createElement("img",Xe()({src:a.downloadUrl,className:"mxg-image",onLoad:function(){o(!0);var e=setInterval((function(){h.current&&h.current.naturalWidth>0&&h.current.naturalHeight>0&&(clearInterval(e),g()),setTimeout((function(){e&&clearInterval(e)}),1e4)}),20)},onError:function(){c(a),o(!1)},style:r?{}:{display:"none"},onClick:function(e){l(u,a,i),e.preventDefault()},alt:"","aria-label":a.name,ref:h},x))),v.a.createElement(it.a,{variant:"body2",className:"mxg-imageText mxg-markdown",dangerouslySetInnerHTML:{__html:"<span dir='auto'>"+Object(vn.b)(s)+"</span>"}})))},vo=function(e){var t=Object(b.useState)(!1),n=Ge()(t,2),r=n[0],o=n[1],a=Object(b.useState)(!1),i=Ge()(a,2),s=i[0],c=i[1],l=e.file,u=e.messageType,d=e.text,p=e.onMediaLinkExpired,g=(e.removeFocus,e.onOpenFilePrev),f=e.FilePrevComp,m=(e.downloadFile,e.bDisableTabStop),h=e.i18n,y=e.onContentAdded,x=e.messageId,w=e.ariaSaid,O=l.downloadUrl,S=l.size,E=l.name,C=(l.type,l.mime),k=l.updatedTime,R=Object(Ot.f)(S),T=Object(b.useRef)(null),j=Object(b.useRef)(null),D="fullscreenchange";D="Firefox"===lo?"mozfullscreenchange":"webkitfullscreenchange";var P={};Object(vn.d)(O)||(P.crossOrigin="anonymous"),Object(b.useEffect)((function(){return document.addEventListener(D,M,!1),function(){document.removeEventListener(D,M,!1)}}),[]),Object(b.useEffect)((function(){"fetching"===s&&k&&c("fetched")}),[s,k]);var M=function(e){e.target&&e.target.classList.contains("mxg-video")&&e.target.scrollIntoView()};return k&&(P.autoPlay=!0),s&&"fetching"===s&&T.current&&(T.current.style.opacity="0.5",T.current.style.pointerEvents="none"),v.a.createElement("div",{id:x,ref:j},v.a.createElement("div",{className:"aria-name cx-messenger-screen-reader","aria-label":w,tabIndex:-1},e.ariaSaid),v.a.createElement("div",{tabIndex:m?-1:0,className:"mxg-video-bubble",title:h.previewFile},v.a.createElement("div",{className:"mxg-video-details",onClick:function(e){g(f,l,u),e.preventDefault()}},v.a.createElement("div",{className:"mxg-video-icon"},v.a.createElement($n.a,{sx:co({},{width:"40px",height:"40px",display:"flex",alignItems:"inherit",justifyContent:"inherit"})})),v.a.createElement("div",{className:"mxg-video-details-body"},v.a.createElement("div",{className:"mxg-video-filename-container",onKeyDown:function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||(e.preventDefault(),g(f,l,u))},tabIndex:m?-1:0},v.a.createElement(Zr,{className:"mxg-video-filename mxg-filename",text:E})),v.a.createElement("div",{className:"mxg-video-file-data"},S&&v.a.createElement(it.a,{className:"mxg-video-filesize",variant:"body2"},R),v.a.createElement(it.a,{className:"mxg-generic-attachment-type",variant:"body2"},h.videoLabel)))),v.a.createElement("div",{className:"mxg-video-bubble-container"},!r&&v.a.createElement(Gn.a,{variant:"rectangular",className:"mxg-skeleton-video"}),v.a.createElement("video",Xe()({playsInline:!0,src:"".concat(O,"#t=0.001"),key:O,preload:"metadata",controls:!0,className:"mxg-video ".concat(!d&&"mxg-media-no-text"),type:C,onLoadedMetadata:function(){o(!0);var e=setInterval((function(){T.current&&T.current.videoWidth>0&&T.current.videoHeight>0&&(clearInterval(e),y()),setTimeout((function(){e&&clearInterval(e)}),1e4)}),20)},style:r?{}:{display:"none"},onError:function(e){p(l),c("fetching")},"aria-label":E,ref:T},P)),s&&"fetching"===s&&v.a.createElement(_n.a,{"aria-busy":"true",role:"alert","aria-label":h.ariaLoading,sx:{width:"60px",height:"60px",position:"absolute"}})),d&&v.a.createElement(it.a,{variant:"body2",className:"mxg-video-text mxg-markdown",dangerouslySetInnerHTML:{__html:"<span dir='auto'>"+Object(vn.b)(d)+"</span>"}})))},yo=function(e){var t=e.text,n=e.file,r=e.messageId,o=e.messageType,a=e.ariaSaid,i=e.bDisableTabStop,s=e.i18n,c=e.onOpenFilePrev,l=e.FilePrevComp,u=(n.downloadUrl,n.size),d=n.name,p=(n.type,n.mime),g=p&&p.length?Object(Ot.g)(p):"",f=!(!g||"Video"!==g),m=!(!g||"Audio"!==g),h=!(!g||"File"!==g),b=!(!g||"Image"!==g),y=!(!g||-1===["Document","PDF","Presentation","Spreadsheet","Text"].indexOf(g)),x=Object(Ot.f)(u),w={width:"40px",height:"40px",display:"flex",alignItems:"inherit",justifyContent:"inherit"};return v.a.createElement("div",{id:r},v.a.createElement("div",{className:"aria-name cx-messenger-screen-reader","aria-label":a,tabIndex:-1},e.ariaSaid),v.a.createElement("div",{className:"mxg-generic-attachment-bubble"},v.a.createElement(Vt.a,{className:t?"mxg-generic-attachment-bubble-container mxg-generic-attachment-bubble-withtext":"mxg-generic-attachment-bubble-container",variant:"text",onClick:function(e){c(l,n,o),e.preventDefault()},onKeyDown:function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||(e.preventDefault(),c(l,n,o))},title:s.previewFile,tabIndex:i?-1:0,"aria-label":d+" "+x+" "+g},v.a.createElement("div",{className:"mxg-generic-attachment-iconContainer"},f&&v.a.createElement($n.a,{sx:co({},w)}),m&&v.a.createElement(Yn.a,{sx:co({},w)}),b&&v.a.createElement(Qn.a,{sx:co({},w)}),h&&v.a.createElement(Xn.a,{sx:co({},w)}),y&&v.a.createElement(Jn.a,{sx:co({},w)})),v.a.createElement("div",{className:"mxg-generic-attachment-body"},v.a.createElement("div",{className:"mxg-generic-attachment-filename-container"},v.a.createElement(Zr,{className:"mxg-generic-attachment-filename mxg-filename",text:d})),v.a.createElement("div",{className:"mxg-generic-attachment-file-data"},u&&v.a.createElement(it.a,{className:"mxg-generic-attachment-filesize",variant:"body2"},x),g&&v.a.createElement(it.a,{className:"mxg-generic-attachment-type",variant:"body2"},g)))),t&&v.a.createElement(it.a,{variant:"body2",className:"mxg-generic-attachment-text mxg-markdown",dangerouslySetInnerHTML:{__html:"<span dir='auto'>"+Object(vn.b)(t)+"</span>"}})))},xo=function(e){var t=e.message,n=e.time,r=e.transcriptContainerRef,o=e.onOpenFilePrev,a=e.onErrorLoadingFile,i=e.onMediaLinkExpired,s=e.onContentAdded,c=e.onSelection,l=e.downloadFile,u=e.i18n,d=e.bLastMessage,p=e.bDisableTabStop,g=e.disableFocus,f=e.richMediaOptions,m=e.bCard,b=e.bCarousel,y=e.bCobrowse,x=e.direction,w=e.humanizeConfig,O=e.showAgentAvatar,S=e.showBotAvatar,E=(e.participantName,t||{}),C=E.text,k=E.files,R=E.messageType,T=E.id,j=E.originatingEntity,D=w||{},P=(D.agent,D.bot),M=D.enabled,A=(P||{}).name,I=((t||{}).from||{}).name,N=p||g,F=u.ariaBusinessSaid,L=u.ariaYouSaid,B=u.ariaAgentSaid,H=u.ariaBotSaid,K="",z="",q="",U=!1,_=k&&k.length?k[0]:{},W=_.type,V=_.mime;W&&V&&(K=W,z=V);var G,$,Y,Q=!1;if((k||[]).length)switch(K){case"Image":G=!0;break;case"Video":$=!0;break;case"Audio":Y=!0;break;case"File":Q=!0}var X=!!(G||$||Y||Q);($||Y)&&(q=Object(Ot.c)(K,z)),G&&(U=Object(Ot.d)(z));var J=!(!C||!($&&!q||Y||Q)),Z="";(k||[]).length&&(Z=function(e){return v.a.createElement(io,Xe()({},e,{onMediaLinkExpired:i,downloadUrl:k[0].downloadUrl,size:k[0].size,name:k[0].name,mediaType:k[0].type,mimeType:k[0].mime,file:k[0],downloadFile:l,i18n:u,direction:x}))});var ee=function(){var e="";return R&&("outbound"==R?(e=F,M&&("Human"===j&&I&&B?e=B.replace("<%Agent%>",I):"Bot"===j&&A&&H&&(e=H.replace("<%Bot%>",A)))):"inbound"==R&&(e=L)),e},te={display:uo?"-ms-flexbox":"flex",justifyContent:"outbound"===t.messageType?"flex-start":"flex-end"},ne=function(e){var t=e||{},n=t.type,r=t.target;"focus"===n?po.messageOnFocus():"mouseover"===n?r&&r.className&&"function"==typeof r.className.indexOf&&-1!==r.className.indexOf("mxg-message-bubble")&&po.messageOnHover():"touchstart"===n&&po.messageOnTouch()};return v.a.createElement(v.a.Fragment,null,v.a.createElement("div",null,(C&&d||m||b)&&v.a.createElement(zr,Xe()({onSelection:c,options:f},e,{transcriptContainerRef:r,toolTipPlacement:"right-start",oCallbacks:{onTooltipOpen:ne}}))),y&&v.a.createElement(v.a.Fragment,null,v.a.createElement(go,null,M&&v.a.createElement("div",{className:"mxg-humanize"}),v.a.createElement(Wr,Xe()({transcriptContainerRef:r,toolTipPlacement:"outbound"===R?"right-start":"left-start",oCallbacks:{onTooltipOpen:ne,personaLabel:ee}},e)))),(C||!!(k||[]).length)&&v.a.createElement(fo,{style:te,props:e},M&&"outbound"===R&&v.a.createElement("div",{className:"mxg-humanize"},(O||S)&&!b&&!m&&v.a.createElement(hn,{humanizeConfig:w,message:t,showAgentAvatar:O,showBotAvatar:S})),v.a.createElement(Wn.a,{disableInteractive:!0,componentsProps:{tooltip:{sx:function(e){var t;return t={backgroundColor:e.palette.common.white,color:e.palette.common.mediumGrey,boxShadow:e.shadows[1],fontSize:"0.70rem",fontWeight:"400"},h()(t,"boxShadow","none"),h()(t,"padding","0px"),t}},popper:{sx:{zIndex:0}}},enterDelay:500,title:n,PopperProps:{container:r.current},placement:"outbound"===t.messageType?"right-start":"left-start",onOpen:function(e){return ne(e)}},v.a.createElement("div",{className:t.messageType&&"outbound"===t.messageType?"mxg-message-bubble mxg-outbound ".concat(X&&"mxg-attachment"," ").concat(X&&!U&&"mxg-attachment-other"," ").concat(J&&"mxg-attachment-with-text"):"mxg-message-bubble mxg-inbound ".concat(X&&"mxg-attachment","  ").concat(X&&!U&&"mxg-attachment-other"," ").concat(J&&"mxg-attachment-with-text"),tabIndex:N||!C&&(k||[]).length?-1:0,"aria-labelledby":!C&&(k||[]).length?"":T},C&&!(k||[]).length&&v.a.createElement(ho,{ariaSaid:ee(),messageId:T,text:C}),Q&&v.a.createElement(yo,{text:C,file:k[0],messageType:R,onOpenFilePrev:o,FilePrevComp:Z,messageId:T,bDisableTabStop:N,i18n:u,ariaSaid:ee()}),$&&q&&v.a.createElement(vo,{text:C,file:k[0],messageType:R,messageId:T,bDisableTabStop:N,i18n:u,onMediaLinkExpired:i,onOpenFilePrev:o,FilePrevComp:Z,downloadFile:l,ariaSaid:ee(),onContentAdded:s}),($&&!q||Y||G&&!U)&&v.a.createElement(yo,{text:C,file:k[0],messageType:R,messageId:T,bDisableTabStop:N,i18n:u,onOpenFilePrev:o,FilePrevComp:Z,ariaSaid:ee()}),C&&G&&U&&v.a.createElement(bo,{text:C,file:k[0],messageType:R,onOpenFilePrev:o,onErrorLoadingFile:a,FilePrevComp:Z,bDisableTabStop:N,i18n:u,onContentAdded:s,messageId:T,ariaSaid:ee()}),!C&&G&&U&&v.a.createElement(Gr,{file:k[0],messageType:R,bDisableTabStop:N,i18n:u,time:n,FilePrevComp:Z,onContentAdded:s,onOpenFilePrev:o,onErrorLoadingFile:a})))))},wo=xo;xo.propTypes={color:x.a.string,type:x.a.string,message:x.a.object,time:x.a.string,onOpenFilePrev:x.a.func,downloadFile:x.a.func,bDisableTabStop:x.a.bool,i18n:x.a.object.isRequired,richMediaOptions:x.a.object.isRequired,onSelection:x.a.func.isRequired};var Oo,So,Eo=Object(Ot.i)().browser||"",Co=Object(Ot.i)().os||"",ko=!(!Eo||"Internet Explorer"!==Eo),Ro="Android"===Co,To=Object(xt.a)("div")((function(e){var t=e.theme;return{textAlign:"center","&:-moz-focusring":{outlineColor:function(){return"light"==t.palette.mode?t.palette.getContrastText(t.palette.background.default):"inherit"},outlineStyle:"solid"}}})),jo=Object(xt.a)(it.a)((function(e){return{color:e.theme.palette.common.mediumGrey}})),Do=["Video"],Po="";function Mo(e,t){var n=e||{},r=n.showBotAvatar,o=n.showBotName,a=n.showAgentAvatar,i=n.showAgentName,s=n.showCustomerName,c=n.message,l=n.bOfferExpired,u=n.bOfferAttended,d=n.bActiveQuickReply,p=t||{},g=p.showBotAvatar,f=p.showBotName,m=p.showAgentAvatar,h=p.showAgentName,b=p.showCustomerName,v=p.message,y=p.bCard,x=p.bCarousel,w=p.bCobrowse,O=p.humanizeEnabled,S=p.bOfferExpired,E=p.bOfferAttended,C=p.bActiveQuickReply,k=v||{},R=k.files,T=k.updatedTime,j=(c||{}).updatedTime;R&&R.length?(Oo=R[0].type,So=R[0].mime):Oo="",Po="Video"==Oo?Object(Ot.c)(Oo,So):"";var D=!(!!!Do.includes(Oo)||!Po),P=!(!R||!R.length)&&!!R[0].updatedTime;return(!O||C===d&&b===s&&g===r&&f===o&&m===a&&h===i&&E===u&&S===l&&T===j||!1!==D&&!P)&&!!(R&&R.length||y||x||g||f||m||h||w&&E===u&&S===l)}var Ao=function(e){var t,n=e.message,r=(e.files,e.scrollDown),o=e.scrollToMessage,a=e.bDisableTabStop,i=e.disableFocus,s=(e.transcriptRef,e.markdownEnabled),c=e.onScrollDown,l=e.time,u=e.humanizeEnabled,d=e.humanizeConfig,p=e.showAgentName,g=e.showAgentAvatar,f=e.showBotAvatar,m=e.showBotName,h=e.showCustomerName,y=e.i18n,x=e.previousMessage,w=e.bActiveQuickReply,O=((d||{}).bot||{}).name,S=(y||{}).customerDefaultName,E=a||i,C=Object(b.useRef)(null),k=(n||{}).files,R=!(!k||!k.length)&&!!k[0].updatedTime,T=Ro?600:0;Object(b.useEffect)((function(){return r&&!R&&(t=setTimeout((function(){c(C,o)}),T)),R=!1,function(){clearTimeout(t)}}),[]),Genesys("command","Markdown.configure",{disableLinkFocus:E,enabled:s});var j=n||{},D=j.messageType,P=j.from,M=(j.quickReplies,(P||{}).name),A=(x||{}).messageType,I="",N=!1,F=!1;u&&n.messageType;u&&D&&("outbound"==D?"Human"==n.originatingEntity?M&&p?I="".concat(M):M||(I=""):"Bot"==n.originatingEntity&&(I=m&&M?"".concat(M):m&&!M&&O?"".concat(O):""):"inbound"==D&&(F=!0,I="".concat(S," "))),D&&A&&D===A&&(N=!0);var L=Object(xt.a)("div")((function(e){e.theme;return{margin:"0px 0px 4px 0px",padding:"6px 0px 0px 0px",width:"100%",display:"flex",flexDirection:"column-reverse",height:ko?"100%":"auto",scrollMarginBottom:"18px",paddingTop:N?"0px!important":"6px",boxSizing:"border-box"}})),B=Object(xt.a)(it.a)((function(e){return{color:e.theme.palette.common.mediumGrey,"&.customerParticipant":{alignSelf:"flex-end"},"&.paddingAgentName":{paddingLeft:"46px"},"& .ellipsis":{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre",maxWidth:"65%"}}}));return v.a.createElement(L,{className:"mxg-message",ref:C},"system"===n.messageType?v.a.createElement(To,{className:"mxg-system",tabIndex:E?-1:0,"aria-labelledby":"systemMessage"},v.a.createElement(jo,{variant:"caption",id:"systemMessage"},n.text)):v.a.createElement(v.a.Fragment,null,u&&!w&&(p||m||h)&&v.a.createElement(v.a.Fragment,null,v.a.createElement(B,{className:"".concat(F?"customerParticipant":"paddingAgentName"),variant:"caption"},v.a.createElement("span",{className:F?"":"ellipsis"},I),v.a.createElement("span",{className:"".concat(F?"":"ellipsis")},I&&v.a.createElement("span",null,"  "),l))),v.a.createElement(wo,Xe()({},e,{onContentAdded:function(){r&&!R&&c(C,o),R=!1},participantName:I}))))},Io=v.a.memo(Ao,Mo);Ao.propTypes={color:x.a.string,type:x.a.string,message:x.a.object,scrollDown:x.a.bool,scrollToMessage:x.a.bool,bQuickReplies:x.a.bool,time:x.a.string,i18n:x.a.object.isRequired,bDisableTabStop:x.a.bool,disableFocus:x.a.bool,richMediaOptions:x.a.object.isRequired,onSelection:x.a.func.isRequired,onScrollDown:x.a.func.isRequired};n(421),n(602),Object(Ot.i)().browser;var No="Android"===(Object(Ot.i)().os||""),Fo=Object(xt.a)("div")((function(e){var t=e.theme;return{borderRadius:"0px 8px 8px 8px",margin:"0px 0px 6px 0px",padding:"10px 12px",display:"inline-block",scrollMarginBottom:"18px",background:t.palette.common.lightGrey,"&:-moz-focusring":{outlineColor:function(){return"light"==t.palette.mode?t.palette.getContrastText(t.palette.background.default):"inherit"},outlineStyle:"solid"},"& .mxg-typing-indicator-dot":{background:t.palette.common.mediumGrey}}}));function Lo(e){var t,n=e.i18n,r=e.dotsCount,o=e.onScrollDown,a=n.ariaIsTyping,i=Object(b.useRef)(null),s=[],c=No?600:100;if(Object(b.useEffect)((function(){return t=setTimeout((function(){o(i)}),c),function(){clearTimeout(t)}}),[]),r&&r>=3&&r<=5)for(var l=0;l<r;l++)s.push(l);else s=[0,1,2];return v.a.createElement(Fo,{tabIndex:0,ref:i},v.a.createElement("div",{className:"cx-messenger-screen-reader","aria-label":a,tabIndex:-1},a),s.map((function(e){return v.a.createElement("span",{key:e,className:"mxg-typing-indicator-dot",style:{"--animation-order":e}})})))}Lo.propTypes={color:x.a.string,i18n:x.a.object.isRequired,dotsCount:x.a.number,onScrollDown:x.a.func.isRequired};var Bo=Lo,Ho="Android"===(Object(Ot.i)().os||""),Ko=Object(xt.a)("div")((function(e){var t=e.theme;return{margin:"10px",flexDirection:"column-reverse",display:"flex","& .alignButton":{textAlign:"center"},"& .disconnectText":{color:t.palette.common.mediumGrey,textAlign:"center"},"& .disconnectTime":{color:t.palette.common.mediumGrey,paddingBottom:"10px",textAlign:"center"}}}));function zo(e){var t,n=e||{},r=n.color,o=n.oCallbacks,a=n.dateTime,i=n.bDisableTabStop,s=n.disableFocus,c=n.i18n,l=n.bReadOnlySession,u=n.scrollDown,d=n.onScrollDown,p=n.index,g=n.disconnectType,f=(o||{}).onStartNewConversation,m=i||s,h=Object(b.useRef)(null),y=Ho?600:0,x=l&&0==p;return Object(b.useEffect)((function(){return t=setTimeout((function(){u&&d(h)}),y),function(){clearTimeout(t)}}),[]),v.a.createElement(Ko,{tabIndex:m?-1:0,ref:h,className:"mxg-disconnect-message","aria-labelledby":"disconnectMessage_text disconnectMessageSend_text dateTime_text startNewConversation_text"},x&&v.a.createElement("div",{className:"alignButton"},v.a.createElement(Vt.a,{id:"startNewConversation_text",variant:"contained",size:"medium",dir:"auto",color:r,tabIndex:m?-1:0,"aria-label":c&&c.startNewConversation+"-"+c.ariaStartNewConversation||"",onClick:f},c&&c.startNewConversation||"")),v.a.createElement(it.a,{id:"dateTime_text",className:"disconnectTime",component:"div","aria-label":a,variant:"caption",dir:"auto"},a),g&&("boolean"==typeof l?!l:"send"===g.toLowerCase())&&v.a.createElement("div",{className:"disconnectText"},v.a.createElement(it.a,{id:"disconnectMessageSend_text","aria-label":c&&c.disconnectMessageSend||"",variant:"caption",dir:"auto"},c&&c.disconnectMessageSend||"")),v.a.createElement("div",{className:"disconnectText"},v.a.createElement(it.a,{variant:"caption",dir:"auto",id:"disconnectMessage_text"},c&&c.disconnectMessage||"")))}function qo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qo(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}zo.propTypes={onStartNewConversation:x.a.func,participantName:x.a.string,dateTime:x.a.string,i18n:x.a.object.isRequired};var Wo=Object(Ot.i)().browser||"",Vo=!(!Wo||"Internet Explorer"!==Wo),Go=Object(Ot.n)(),$o={position:"absolute",boxSizing:"border-box",overflowY:"auto",overflowX:"hidden",overscrollBehavior:"contain",width:"100%",padding:"0px 16px 6px 16px",height:Vo?"auto":"100%",maxHeight:"calc(100% - 171px)",scrollBehavior:"smooth"},Yo={display:Vo?"-ms-flexbox":"flex",flexDirection:"column-reverse",minHeight:"100%",position:"relative"},Qo={display:"inline-block"},Xo=function(e){var t=Object(xt.a)(it.a)((function(e){return{color:e.theme.palette.common.mediumGrey}})),n=Object(xt.a)("div")((function(e){e.theme;return{textAlign:"center"}})),r=e.oDateDivider;return v.a.createElement(n,null,v.a.createElement(t,{variant:"caption"},ln()(r.$d).format("ll")))},Jo=function(e,t){return!(!t||!e||t.timestamp!=e.timestamp)},Zo=function(e){u()(n,e);var t=_o(n);function n(e){var r;return o()(this,n),r=t.call(this,e),h()(c()(r),"screenReaderTranscriptMessage",(function(){var e=r.props||{},t=e.message,n=e.i18n,o=e.status,a=e.bShowTyping,i=e.bTypingStopped,s=e.humanizeConfig,c=e.disconnectType,l=e.bReadOnlySession,u=s||{},d=u.bot,p=u.enabled,g=(d||{}).name,f=((t||{}).from||{}).name,m=(r.state||{}).newMessage,h="",b=n||{},v=b.cobrowse,y=b.ariaNewMessage,x=b.ariaYouSaid,w=b.ariaBusinessSaid,O=b.ariaAgentSaid,S=b.ariaBotSaid,E=b.ariaIsTyping,C=b.ariaStopTyping,k=b.ariaCarouselMessage,R=b.disconnectMessage,T=b.disconnectMessageSend,j=(v||{}).offerTitle;if(a)h="<div>"+E+"</div>";else if("resetTyping"===o&&i)h="<div>"+C+"</div>";else if(m&&Object.keys(m).length){var D=m.messageType,P=m.originatingEntity,M=m.files,A=m.text,I=m.quickReplies,N=m.card,F=m.coBrowse,L=m.id,B=m.carousel,H=m.presence,K=m.timestamp,z="",q="",U=(B||{}).cards,_=(H||{}).type;if(D&&(D==bn.E?(z=w,p&&("Human"===P&&f&&O?z=O.replace("<%Agent%>",f):"Bot"===P&&g&&S&&(z=S.replace("<%Bot%>",g)))):D==bn.t&&(z=x)),A&&A.match(/<a/)&&(q=A.replaceAll("<a target='_blank'","<a target='_blank' tabindex='-1'")),M&&M.length)M[0].name&&A?h=q?y+" "+z+" "+M[0].name+" "+q:y+" "+z+" "+M[0].name+" "+A:M[0].name&&(h=y+" "+z+" "+M[0].name),h="<div>"+h+"<span aria-hidden='true'>"+L||!1;else if(I&&I.length)h=y+" "+z+(A?" "+A:""),I.forEach((function(e){e.text&&(h=h+" "+e.text)})),h="<div>"+h+"<span aria-hidden='true'>"+L||!1;else if(N&&Object.keys(N).length){var W=(N||{}).title;h=y+" "+z+(A?" "+A:""),W&&(h=h+" "+W),h="<div>"+h+"<span aria-hidden='true'>"+L||!1}else if(B&&Object.keys(B).length&&U&&U.length){h=y+" "+z+(A?" "+A:"");U.length>1?(h=h+" "+k,h=U.length>10?h.replace("<%totalSlides%>",10):h.replace("<%totalSlides%>",U.length)):U.forEach((function(e){e.title&&(h=h+" "+e.title)})),h="<div>"+h+"<span aria-hidden='true'>"+L||!1}else if(F&&Object.keys(F).length){var V=F.type;V&&V==bn.z&&(h="<div>"+y+" "+z+" "+j+"<span aria-hidden='true'>"+L||!1)}else if(_&&_.toLowerCase()==bn.m){var G=ln()(ln()(K).$d).format("LLL");"send"!=c.toLowerCase()||l?("readonly"==c.toLowerCase()||l)&&(h="<div>"+R+" "+G+"<span aria-hidden='true'>"+L||!1):h="<div>"+R+" "+T+" "+G+"<span aria-hidden='true'>"+L||!1}else m.text&&(h=q?"<div>"+y+" "+z+" "+q+"<span aria-hidden='true'>"+L||!1:"<div>"+y+" "+z+" "+m.text+"<span aria-hidden='true'>"+L||!1)}return h})),h()(c()(r),"setMarkdown",function(){var e=Ye()(Ze.a.mark((function e(t){var n,o,a,i,s,c;return Ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.props||{},o=n.awaitMarkdown,e.next=3,o(t);case 3:r.markdownMessages=e.sent,a=r.props||{},i=a.status,s=r.state||{},c=s.newMessage,r.markdownMessages.length&&r.markdownMessages[0].timestamp!==c.timestamp?(r.props.setMarkdownMessages(r.markdownMessages),r.setState((function(){return{newMessage:r.markdownMessages[0],renderHistory:!1}}))):"historyFetched"===i||"restored"===i?r.setState((function(){return{renderHistory:!0}})):r.setState((function(){return{newMessage:{},renderHistory:!1}}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(c()(r),"checkForConversationDisconnectMessage",(function(e){var t=!1;if((r.props||{}).bConversationDisconnectEnabled){var n=e||{},o=n.eventType,a=n.presence;if(o&&o.toLowerCase()===bn.F){var i=(a||{}).type;i&&i.toLowerCase()===bn.m&&(t=!0)}}return t})),r.aValidScrollKeyCodes=[0,1,38,33,void 0],r.bScrollLock=!1,r.transcriptRef=Object(b.createRef)(),r.transcriptContainerRef=Object(b.createRef)(),r.bStarterMessage=!0,r.oDateDivider={},r.oPreviousDate={},r.handleScroll=r.handleScroll.bind(c()(r)),r.markdownMessages=[],r.state={maxHeight:"",renderHistory:!1,newMessage:{}},r}return i()(n,[{key:"getHeight",value:function(e){var t=this.props,n=t.textInputRef,r=(t.headerRef,t.bReadOnlySession),o=(e||{}).iHeaderHeight,a=105,i=66;if(n.current){var s=n.current.offsetHeight;a=s<a?a:s}else r&&(a=0);return o&&(i=o),Number(i)+Number(a)}},{key:"handleScroll",value:function(e){var t,n=this,r=this.props.oCallbacks.fetchHistory,o=this.transcriptRef.current.scrollTop,a=e&&-1!==this.aValidScrollKeyCodes.indexOf(e.which);0==Math.round(o)&&a&&!this.bScrollLock&&(this.bScrollLock=!0,r&&(r(),clearTimeout(t)),t=setTimeout((function(){n.bScrollLock=!1}),2e3))}},{key:"componentDidMount",value:function(){this.props.getComponentMethods(this)}},{key:"updateComponent",value:function(e){var t="calc(100% - "+this.getHeight(e)+"px)";this.state.maxHeight!==t&&this.setState({maxHeight:t})}},{key:"componentWillUnmount",value:function(){this.props.getComponentMethods(null)}},{key:"shouldComponentUpdate",value:function(e,t){var n=e.sendingMessage,r=e.messages,o=e.status,a=e.userTyping,i=e.markdownMessages,s=(e.files,(t||{}).newMessage),c=(this.state||{}).newMessage,l=this.props||{},u=l.awaitMarkdown,d=l.setMarkdownMessages;if(r&&r.length){if(this.markdownMessages.length||i.length!==r.length||(this.markdownMessages=i),"messagesUpdated"===o&&r.length===this.markdownMessages.length){var p=Object(vn.c)(this.markdownMessages,r,"updatedTime");if(p&&p.length)return this.setMarkdown(p),!1;if(Jo(c,s))return!1}else if(r.length!==this.markdownMessages.length){var g=Object(vn.c)(this.markdownMessages,r,"timestamp");if(g&&g.length)return this.setMarkdown(g),!1;if(Jo(c,s))return!1}}else if(!r.length&&(this.markdownMessages.length||i.length))return this.markdownMessages=[],u([]),d([]),!0;return("sending"!==n||"connecting"===o||"reconnecting"===o)&&(!a||!Jo(c,s))}},{key:"render",value:function(){var e=this,t=this.props,n=(t.messages,t.message,t.showProgress),r=t.i18n,o=t.oCallbacks,a=t.status,i=t.pageNumber,s=t.pageSize,c=t.bDisableTabStop,l=t.oDisableInputs,u=t.bShowTyping,d=t.direction,p=t.richMediaOptions,g=t.conversationRef,f=t.bAutoStartEnabled,m=t.markdownEnabled,h=t.cobrowse,b=(t.bConversationDisconnectEnabled,t.bReadOnlySession),y=t.startNewConversation,x=t.messageOutofOrderIndex,w=t.humanizeEnabled,O=t.humanizeConfig,S=t.disconnectType,E=(t.files,this.state),C=E.maxHeight,k=E.newMessage,R=(h||{}).enabled,T=this.props.styles.color,j={messageType:"system",text:r.startConversationMessage,type:"text"},D=o.onMessageAdded,P=o.onOpenFilePrev,M=o.onErrorLoadingFile,A=o.downloadFile,I=o.onMessageSelection,N=o.onMediaLinkExpired,F="fetchingHistory"===a||"historyFetched"===a||"historyComplete"===a,L=!1,B=!1,H=!1,K=!1,z=!1;f&&(j.text=r.autoStartConversationMessage),C&&($o=Uo(Uo({},$o),{},{maxHeight:C}));var q=function(t,n){t&&t.current&&(Go?e.transcriptRef.current.scrollTo(0,e.transcriptRef.current.scrollHeight):t.current.scrollIntoView({behavior:"smooth",block:n?"nearest":"end",inline:"end"}))},U=xe()(this.markdownMessages||[]);"historyFetched"!==a&&"restored"!==a||(this.bStarterMessage=!1),"historyComplete"!==a&&"sessionCleared"!==a||this.bStarterMessage||(this.bStarterMessage=!0),i&&1===i&&s&&(U&&U.length&&U.length<s||Array.isArray(U)&&!U.length)&&(this.bStarterMessage=!0),this.bStarterMessage&&U.push(j),k&&Object.keys(k).length&&D(k);var _=[],W=[],V=[],G=[],$=!1;return v.a.createElement("div",null,n&&v.a.createElement(Wt.a,{variant:"query"}),U&&!!U.length&&v.a.createElement("div",{style:$o,ref:this.transcriptRef,className:"mxg-transcript",onScroll:this.handleScroll,tabIndex:-1},v.a.createElement("div",{style:Yo,ref:this.transcriptContainerRef},u&&v.a.createElement("span",{style:Qo},v.a.createElement(Bo,{dotsCount:3,i18n:r,onScrollDown:q})),U.map((function(t,n){var o="",a={},i=!1,s=!1,u=!1,f=!1,h=t||{},E=h.contentType,C=h.carousel,j=h.messageType,D=h.originatingEntity,Y=h.type,Q=h.from;f=!1,U.length>n+1&&(a=U[n+1]),t.timestamp&&(o=ln()(t.timestamp),0==n?e.oPreviousDate=o:o.$D&&e.oPreviousDate.$D&&e.oPreviousDate.$D!==o.$D&&(f=!0,e.oDateDivider=Uo({},e.oPreviousDate),e.oPreviousDate=o));var X=a,J=X.messageType,Z=X.originatingEntity,ee=X.from;if((j&&J&&j!==J||D&&Z&&D!==Z||function(e,t){var n=!1,r=e||{},o=r.name,a=r.avatar,i=t||{},s=i.name,c=i.avatar;return o&&s&&o!==s||a&&c&&a!==c?n=!0:(o&&s||!a&&!c||a===c)&&(a&&c||!o&&!s||o===s)||(n=!0),n}(Q,ee)||D===Z&&"event"===Y)&&G.push(n+1),w)switch(j){case"inbound":0!=n&&-1===G.indexOf(n)||(z=!0,i=!0);break;case"outbound":var te=function(e,t){var n="";return(e&&t&&"text"===e.toLowerCase()||"structured"===e.toLowerCase())&&(n=t.toLowerCase()),n}(Y,D);"human"===te?0!=n&&-1===G.indexOf(n)||(L=!0,B=!0,s=!0):"bot"===te&&(0!=n&&-1===G.indexOf(n)||(H=!0,K=!0,u=!0))}U.length>n+1&&(a=U[n+1]);var ne=!!t.quickReplies&&!!t.quickReplies.length,re=0==n&&ne||!1,oe=t.contentType&&t.contentType===bn.j||!1,ae=R&&t.eventType&&t.eventType===bn.d||!1,ie=!1,se=!1,ce=!1,le=e.checkForConversationDisconnectMessage(t)||!1;le&&0===n?$=!0:le&&0!==n&&($=!1);var ue=E&&E===bn.k&&C&&Object.keys(C).length>=1||!1,de=!1;if(ae){var pe=(t||{}).coBrowse;if(pe&&Object.keys(pe).length){var ge=pe||{},fe=ge.type,me=ge.sessionId;if(fe&&me)switch(fe){case bn.z:ie=!0,_&&_.length&&-1!==_.indexOf(me)?(0===_.indexOf(me)&&1===n&&(de=!0),se=!0):W&&W.length&&-1!==W.indexOf(me)?(0===W.indexOf(me)&&2===n&&(de=!0),se=!0):V&&V.length&&-1!==V.indexOf(me)?(0===V.indexOf(me)&&1===n&&(de=!0),ce=!0):$&&(V.push(me),ce=!0);break;case bn.B:V.push(me);break;case bn.A:_.push(me);break;case bn.C:W.push(me)}}}var he=!!t.text||!(!t.files||!t.files.length)||oe||ie||ue;return v.a.createElement(v.a.Fragment,{key:t.id||n},f&&v.a.createElement(Xo,{oDateDivider:e.oDateDivider}),he&&v.a.createElement(Io,{key:t.id||n,color:T,messages:U,message:t,previousMessage:a,newMessage:k,bLastMessage:0===n,time:ln()(o.$d).format("LT"),scrollToMessage:!F&&n===x||de,scrollDown:!F&&(0===n||n===x)||de,transcriptContainerRef:e.transcriptContainerRef,onOpenFilePrev:P,onErrorLoadingFile:M,onMediaLinkExpired:N,onSelection:I,downloadFile:A,i18n:r,bDisableTabStop:c,disableFocus:l.bMessageFocus,direction:d,richMediaOptions:p,bQuickReplies:ne,bActiveQuickReply:re,bCard:oe,bCobrowse:ae,bCarousel:ue,bOfferExpired:ce,markdownEnabled:m,conversationRef:g,transcriptRef:e.transcriptRef,onScrollDown:q,bOfferAttended:se,humanizeEnabled:w,humanizeConfig:O,showAgentAvatar:L&&s,showAgentName:B&&s,showBotAvatar:H&&u,showBotName:K&&u,showCustomerName:z&&i}),le&&v.a.createElement(zo,{color:T,index:n,dateTime:ln()(o.$d).format("LLL"),i18n:r,bDisableTabStop:c,disableFocus:l.bMessageFocus,scrollDown:!F&&0===n,onScrollDown:q,bReadOnlySession:b,disconnectType:S,oCallbacks:{onStartNewConversation:y||function(){}}}))})))),v.a.createElement("div",{className:"cx-messenger-screen-reader","aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",tabIndex:-1,dangerouslySetInnerHTML:{__html:Object(vn.b)(this.screenReaderTranscriptMessage())}}))}}]),n}(v.a.Component),ea=function(e){return function(t){return v.a.createElement(wt.a.Consumer,null,(function(n){var r=n.oDisableInputs,o=n.markdownMessages,a=n.setMarkdownMessages;return v.a.createElement(e,Xe()({},t,{oDisableInputs:r,markdownMessages:o,setMarkdownMessages:a}))}))}}(Zo);Zo.propTypes={styles:x.a.object,message:x.a.object,messages:x.a.array,status:x.a.string,bShowTyping:x.a.bool,bTypingStopped:x.a.bool,markdownEnabled:x.a.bool,textInputRef:x.a.object,headerRef:x.a.object,showProgress:x.a.bool.isRequired,i18n:x.a.object.isRequired,oCallbacks:x.a.object,oDisableInputs:x.a.object.isRequired,disableFocus:x.a.bool,richMediaOptions:x.a.object.isRequired,messageOutofOrderIndex:x.a.any,getComponentMethods:x.a.func};var ta=n(561),na=n.n(ta),ra=n(562),oa=n.n(ra),aa=n(563),ia=n.n(aa),sa=n(586),ca=Object(xt.a)("div")((function(e){e.theme;return{position:"absolute",right:"0",background:"white",zIndex:"2",width:"100%",height:"100%",maxHeight:"calc(100% - 66px)"}}));function la(e){var t=e.content,n=e.children;return v.a.createElement(sa.a,{in:!0},v.a.createElement(ca,null,t||n))}la.propTypes={content:x.a.node,headerRef:x.a.object};var ua=n(391),da=n(393),pa=n(324),ga=n(594),fa=n(595);function ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ma(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ba={"&.Cx-MuiList-root":{paddingBottom:"0px"},"& .Cx-MuiListItem-root":{padding:"4px 8px 4px 12px"},"& .Cx-MuiListItem-container":{margin:"0px 12px",borderRadius:"6px",boxShadow:"0px 3px 5px -1px rgba(0,0,0,0.2), 0px 6px 10px 0px rgba(0,0,0,0.14), 0px 1px 18px 0px rgba(0,0,0,0.12)"},"& .Cx-MuiListItemText-primary":{whiteSpace:"nowrap",maxWidth:"80%",overflow:"hidden",textOverflow:"ellipsis"},"& .Cx-MuiListItemSecondaryAction-root":{right:"6px"}},va=!1,ya={width:"70%",height:"70%"},xa={position:"absolute",left:"0px",zIndex:1};function wa(e){var t=e.enableAttachments,n=e.enableMultipleAttachments,r=e.data,o=e.onRemove,a=(e.styles,e.ariaRemove),i=e.disabled,s=e.direction,c=(r.url,r.name),l=r.size,u=r.id,d=r.downloadUrl,p=r.percentage,g=r.type,f=g&&0!==g.length?Object(Ot.g)(g):"File",m=!(!f||-1===["Document","PDF","Presentation","Spreadsheet","Text"].indexOf(f)),h=!(!f||"Image"!==f),b=!(!h||void 0!==t&&(!t||n)),y=!!(h&&t&&n),x=!(!f||"Video"!==f),w=!(!f||"Audio"!==f),O=!(!f||"File"!==f);h&&(va=Object(Ot.d)(g));var S=v.a.useState(!1),E=Ge()(S,2),C=E[0],k=E[1],R=v.a.useState(!1),T=Ge()(R,2),j=T[0],D=T[1],P=j?"indeterminate":"determinate",M=p?Number(p):5;return 100==M&&(d?setTimeout((function(){D(!1)}),600):setTimeout((function(){D(!0)}),600)),v.a.createElement(tn.a,{sx:ba,className:"mxg-attach-file-container"},v.a.createElement(nn.a,{tabIndex:0,"aria-labelledby":"file_details"},v.a.createElement(ua.a,null,v.a.createElement(Sr.a,{sx:{position:"relative",display:"inline-flex",verticalAlign:"middle",textAlign:"center",transform:"rtl"===s?"scaleX(-1)":void 0}},v.a.createElement(_n.a,{variant:P,value:M,size:46,"aria-hidden":"true"}),v.a.createElement(Sr.a,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"}},v.a.createElement(un.a,{variant:"circular",className:"mxg-attach-file-avatar"},d&&h&&va&&v.a.createElement("img",{src:d,style:{width:"100%",height:"100%"},alt:""}),d&&y&&!va&&v.a.createElement(Qn.a,{alt:"",sx:ha({},ya),className:"mxg-attach-file-avatar-image-files"}),!d&&b&&v.a.createElement(ga.a,{alt:"",sx:ha({},ya),className:"mxg-attach-file-avatar-image"}),!d&&y&&v.a.createElement(Qn.a,{alt:"",sx:ha({},ya),className:"mxg-attach-file-avatar-image-files"}),x&&v.a.createElement($n.a,{alt:"",sx:ha({},ya),className:"mxg-attach-file-avatar-video"}),w&&v.a.createElement(Yn.a,{alt:"",sx:ha({},ya),className:"mxg-attach-file-avatar-audio"}),O&&v.a.createElement(Xn.a,{alt:"",sx:ha({},ya),className:"mxg-attach-file-avatar-generic"}),m&&v.a.createElement(Jn.a,{alt:"",sx:ha({},ya),className:"mxg-attach-file-avatar-doc"}))))),v.a.createElement(da.a,{primaryTypographyProps:{dir:"auto"},primary:c,secondary:Object(Ot.f)(l),id:"file_details"}),v.a.createElement(pa.a,null,v.a.createElement(Sr.a,{sx:{position:"relative",display:"inline-flex",transform:"rtl"===s?"scaleX(-1)":void 0}},v.a.createElement(yt.a,{className:"mxg-attach-file-closebtn",children:v.a.createElement(fa.a,{fontSize:"small","aria-hidden":"true",alt:"",sx:{width:"26px",height:"26px",display:"flex",alignItems:"inherit",justifyContent:"inherit"}}),"aria-label":a,onClick:function(e){k(!0),o({id:u})},disabled:!u||i,size:"large"}),C&&v.a.createElement(_n.a,{size:48,thickness:2.6,sx:ha({},xa)})))))}function Oa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}function Sa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sa(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}wa.propTypes={enableAttachments:x.a.bool,enableMultipleAttachments:x.a.bool,data:x.a.object,onRemove:x.a.func.isRequired,ariaRemove:x.a.string,disabled:x.a.bool,direction:x.a.string};var Ca={severity:{offline:"error",reconnecting:"warning",authenticating:"info",reAuthenticating:"info"},i18n:{offline:"disconnected",reconnecting:"reconnecting",authenticating:"authenticating",reAuthenticating:"reAuthenticating"}},ka=h()({inputBox:"".concat("Conversation","-inputBox"),focused:"".concat("Conversation","-focused"),spinner:"".concat("Conversation","-spinner"),inputButton:"".concat("Conversation","-inputButton"),sendIcon:"".concat("Conversation","-sendIcon"),attachIcon:"".concat("Conversation","-attachIcon")},"inputButton","".concat("Conversation","-inputButton")),Ra=Object(xt.a)("div")((function(e){var t;e.theme,e.props;return t={},h()(t,"&.".concat(ka.inputBox),{borderTop:"1px solid #8a8a8a"}),h()(t,"& .".concat(ka.focused),{borderTop:function(e){return"1px solid #333"}}),h()(t,"& .".concat(ka.spinner),{position:"relative",top:"40%",textAlign:"center"}),h()(t,"& .".concat(ka.inputButton),{display:"none"}),h()(t,"& .".concat(ka.sendIcon),{float:"right",marginRight:"6px"}),h()(t,"& .".concat(ka.attachIcon),{float:"left",marginLeft:"4px"}),h()(t,"& .".concat(ka.inputButton),{display:"none"}),t})),Ta={"&.Cx-MuiTextField-root":{backgroundColor:"transparent"},"& .Cx-MuiInputBase-multiline":{padding:"19px 18px 16px!important",borderRadius:"0!important"},"& .Cx-MuiInput-input":{"&::placeholder":{opacity:.65}}},ja={position:"absolute",justifyContent:"center",zIndex:3,width:"92%",margin:"16px"},Da=Object(qr.a)(),Pa=v.a.forwardRef((function(e,t){var n=e.color,r=e.i18n,o=e.sendMessage,a=e.onAttachment,i=e.onRemoveAttachment,s=e.onhandleMxgInput,c=e.enableAttachments,l=e.enableMultipleAttachments,u=e.allowedMediaPresence,d=e.onBlur,p=e.onFocus,g=e.autoFocus,f=e.aFileTypes,m=e.files,h=e.status,b=e.prevStatus,y=(e.error,e.bPreviewOpened),x=e.bPreviewClosed,w=e.bDisableOffline,O=e.inputRef,S=e.oDisableInputs,E=e.bDisabledSend,C=e.maxMessageLength,k=e.direction,R=e.previewMode,T={value:"",bTyping:!1,bAttachFile:!1,bFocused:!1},j=v.a.useState(T),D=Ge()(j,2),P=D[0],M=D[1],A="requestingUpload"==h||"uploadApproved"==h||"uploading"==h||"requestingUpload"==b&&"connected"==h,I=("uploading"==b||"fileUploaded"==b)&&"fileUploaded"==h,N="fileUploaded"==b&&"fileDeleted"==h,F=!!m.name,L=[25,50,75],B="",H=v.a.createRef();f&&f.length&&(f.forEach((function(e){B=B+e+","})),B=B.slice(0,-1));var K=!!(void 0===c||c&&!l||c&&l&&!u),z=!!(c&&l&&u);R&&c&&(K=!1,z=!0);var q=function(){A||(o(P.value,F),M(Ea({},T)),O.current.focus())},U=function(e){var t=e.target,n=t.files;a(n),t.value="",O.current.focus()},_=!0;A||y?_=!0:F&&I?_=!1:(P.bTyping||P.bFocused)&&(_=!P.value&&!F);var W,V={width:"26px",height:"26px",display:"flex",alignItems:"inherit",justifyContent:"inherit"};return v.a.createElement(v.a.Fragment,null,F&&v.a.createElement(wa,{onRemove:function(e){i(e),Da.attachmentremoved(),O.current.focus()},enableAttachments:c,enableMultipleAttachments:l,direction:k,ariaRemove:r.ariaRemoveButton,data:Ea(Ea({},m),{},{id:m.attachmentId}),key:m.attachmentId||Object(Ot.k)(),disabled:w}),v.a.createElement(zn.a,{ref:t,id:"mxg-message-input",color:n,placeholder:r.inputMessagePlaceholder,sx:Ta,multiline:!0,InputProps:{disableUnderline:!0},fullWidth:!0,autoFocus:g,inputRef:O,maxRows:4,value:P.value,inputProps:{"aria-label":P.value||r.inputMessagePlaceholder,maxLength:C},variant:"standard",onChange:function(e){e.persist(),s(e),M((function(t){return Ea(Ea({},t),{},{value:e.target.value,bTyping:!0})}))},onKeyPress:function(e){13!=e.which||e.ctrlKey||e.shiftKey||E||(q(),e.preventDefault())},onFocus:function(e){p(e),M((function(e){return Ea(Ea({},e),{},{bFocused:!0})}))},onBlur:function(e){d(e),F||M((function(e){return Ea(Ea({},e),{},{bFocused:!1})}))},onPaste:function(e){e.clipboardData.files&&e.clipboardData.files.length&&B&&!F&&U({target:e.clipboardData})},disabled:y||S.bTextField||w}),v.a.createElement("span",null,B&&!F&&v.a.createElement("span",null,v.a.createElement("input",{type:"file",className:ka.inputButton,id:"attach-file-button",accept:B,onChange:U,ref:H}),v.a.createElement("label",{htmlFor:"attach-file-button"},v.a.createElement(yt.a,{className:ka.attachIcon,"aria-label":r.ariaAttachButton,title:r.ariaActionsAttachFileTitle,component:"span",onKeyUp:function(e){13!==e.which&&32!==e.which||e.ctrlKey||e.shiftKey||H.current.click()},disabled:y||S.bAttachFileButton||w},K&&v.a.createElement(na.a,{alt:"",sx:Ea({},V)}),z&&v.a.createElement(oa.a,{alt:"",sx:Ea({},V)})))),v.a.createElement(yt.a,{className:"mxg-conversation-sendbtn ".concat(ka.sendIcon),"aria-label":r.ariaSendButton,disabled:_||S.bSendIcon||w||E,onClick:q,size:"large"},v.a.createElement(Tt.a,{icon:sn.a,alt:"",customStyle:V}))),v.a.createElement("div",{className:"cx-messenger-screen-reader","aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",tabIndex:-1},v.a.createElement("span",{tabIndex:-1,dangerouslySetInnerHTML:{__html:Object(vn.b)(function(){if(A){var e="";return L.forEach((function(t){100!=m.percentage&&m.percentage>=t&&m.percentage<=t+5&&(e=100-m.percentage+" "+r.ariaPercentRemaining)})),m.percentage>0?e:r.ariaFileUploading}return I?r.ariaFileUploadComplete:N?r.ariaFileRemoved:y&&"requestingFile"==b&&"messagesUpdated"==h?r.ariaImagePreviewOpened:x&&"messagesUpdated"==b&&"messagesUpdated"==h?r.ariaImagePreviewClosed:""}())}}),v.a.createElement("span",{tabIndex:-1,dangerouslySetInnerHTML:{__html:Object(vn.b)((W=(P||{}).value,W&&W.length===C?r.ariaMessageLengthLimit:""))}})))})),Ma=function(e){u()(n,e);var t=Oa(n);function n(e){var r;o()(this,n),r=t.call(this,e),h()(c()(r),"registerPlugin",(function(){var e=r.props,t=e.setConvPluginRef,n=e.convPluginRef,o=e.payload,a=e.config,i=e.restoring,s=((a||{}).apps||{}).conversations,l=(s||{}).autoStart,u=(s||{}).humanize,d=(l||{}).enabled,p=((u||{}).enabled,c()(r));o&&o.journeyContext&&(p.oMetaData.journeyContext=o.journeyContext),n&&Object.keys(n).length?(p.oConversation=n,p.oMetaData.opened=(new Date).getTime(),n.publish("opened",p.oMetaData),!d||i||p.bSessionActive||n.subscribe("MessagingService.ready",(function(){n.republish("autoStart",p.oMetaData)}))):Genesys("registerPlugin",r.sPluginName,(function(e){e&&Object.keys(e).length&&(p.oConversation=e,t(e),e.ready(),p.oMetaData.opened=(new Date).getTime(),e.publish("opened",p.oMetaData),!d||i||p.bSessionActive||e.subscribe("MessagingService.ready",(function(){e.republish("autoStart",p.oMetaData)})))}))})),h()(c()(r),"generateErrorAlert",(function(e){return Object.assign({},r.oAlerts.error,{message:r.handleErrorMessage(e),alertType:r.sAlertType,onPrimary:function(){r.props.dispatch(ot.clearError()),r.props.closeAlertDialog()}})})),h()(c()(r),"handleMxgInput",(function(e){r.onUserTyping(),r.setState({inputValue:e.target.value,bTyping:!0})})),h()(c()(r),"dispatchMessage",(function(e){switch(Kn()(e)){case"object":if(Object.keys(e).length){var t=e.type;!t||"quickReply"!==t&&"card"!==t&&"cobrowse"!==t?r.props.dispatch(ot.send(e)):(r.props.dispatch(ot.sendTextBack(e)),r.inputRef.current&&r.inputRef.current.focus())}break;default:r.props.dispatch(ot.send({message:e}))}})),h()(c()(r),"sendMessage",(function(e,t){var n=r.props,o=n.payload,a=n.conversationStore||{},i=a.status,s=a.connection;i&&"connected"===i&&s&&"opened"===s&&(r.bSessionActive=!0),(""!==e||t)&&(r.bSessionActive||r.bPendingConnection?(r.dispatchMessage(e),r.setState({inputValue:"",bTyping:!1})):(r.props.dispatch(ot.connect(o)),r.dispatchMessage(e),r.setState({inputValue:"",bTyping:!1})))})),h()(c()(r),"removeAgentIndicator",(function(e){r.setState({bShowAgentTyping:!1,bTypingStopped:!0}),e&&Object.keys(e).length&&r.props.dispatch(ot.clearTypingTimeout())})),h()(c()(r),"onAgentTyping",(function(){var e=r.props.conversationStore,t=r.state,n=t.inputValue,o=t.bShowAgentTyping,a=e.files,i=e.typingNotification,s=!!a.name;""!==n||s?o?r.removeAgentIndicator(i):(r.setState({bTypingStopped:!1}),r.props.dispatch(ot.clearTypingTimeout())):o||r.setState({bShowAgentTyping:!0})})),h()(c()(r),"onUserTyping",(function(){var e=(r.props.config.apps||{}).conversations||{},t=e.showUserTypingIndicator,n=(e.autoStart||{}).enabled;t&&r.bSessionActive&&(n&&!r.bPreventEvent?r.props.dispatch(ot.sendTyping()):n||r.props.dispatch(ot.sendTyping()))})),h()(c()(r),"onAttachment",(function(e){e&&e.length&&r.props.dispatch(ot.requestUpload(e))})),h()(c()(r),"onRemoveAttachment",(function(e){e&&e.id&&r.props.dispatch(ot.deleteFile(e))})),h()(c()(r),"onMessageAdded",(function(e){r.oConversation&&r.oConversation.publish("messageAdded",e)})),h()(c()(r),"onOpenFilePrev",(function(e,t,n){r.OverlayNode=e;var o=r.props.onFilePreviewOpened,a={route:"conversations.filePreview",imagePrevComp:e,file:t};r.props.dispatch(ot.getFile(t)),Da.attachmentClicked(),o(a)})),h()(c()(r),"onErrorLoadingFile",(function(e){e&&r.props.dispatch(ot.refreshFiles([e]))})),h()(c()(r),"onMediaLinkExpired",(function(e){e&&r.props.dispatch(ot.getFile(e))})),h()(c()(r),"onConnectionRestored",(function(e){var t=r.props.conversationStore.connectionStatus;r.bPendingConnection=!1,r.bRestoreFailed&&(r.bRestoreFailed=!1,r.bSessionActive=!0),!r.bSessionActive||t&&"offline"===t?r.props.dispatch(ot.pending()):r.props.dispatch(ot.connected())})),h()(c()(r),"getAlertType",(function(){return"normal"})),h()(c()(r),"fetchHistory",(function(){r.props.dispatch(ot.fetchHistory())})),h()(c()(r),"downloadFile",(function(e){r.props.dispatch(ot.downloadFile(e)),Da.attachmentDownloaded()})),h()(c()(r),"startNewConversation",(function(){((((r.props.config||{}).apps||{}).conversations||{}).conversationDisconnect||{}).enabled&&(r.bResetConversation=!0,r.props.dispatch(ot.resetConversation()))})),h()(c()(r),"resetConversation",(function(){var e=r.props||{},t=e.config,n=e.conversationStore.readOnly,o=(((t||{}).apps||{}).conversations||{}).conversationDisconnect||{},a=o.enabled,i=o.type,s=r.state.bReadOnlySession;!a||"ReadOnly"!=i&&n||(r.bConversationDisconnected=!1,r.bResetConversation=!0,"boolean"==typeof s&&s&&r.setState({bReadOnlySession:!1}))})),h()(c()(r),"onStarted",(function(){var e=(r.oMetaData||{}).started,t=r.state.prevConversationStore.previousStatus,n=r.props.config||{},o=n.apps,a=n.auth,i=(((o||{}).conversations||{}).autoStart||{}).enabled,s=(a||!1).enabled;e&&!r.bResetConversation||t&&(!t||"restored"===t)||(r.bSessionActive=!0,r.oMetaData.started=(new Date).getTime(),r.oConversation&&r.oConversation.publish("started",r.oMetaData),r.bResetConversation&&(i&&s&&setTimeout((function(){r.props.dispatch(ot.openedConversation())}),400),r.bResetConversation=!1),r.bPendingConnection=!1,r.props.bShowAlertDialog&&!r.bRestoreFailed&&(r.props.closeAlertDialog(),r.onConnectionRestored()))})),h()(c()(r),"onRestored",(function(){r.oConversation&&!r.bRestored&&(r.bRestored=!0,r.oConversation.publish("restored",Ea(Ea({},r.oMetaData),{},{messages:r.props.conversationStore.messages})))})),h()(c()(r),"handleErrorMessage",(function(e){var t=r.props,n=t.i18n,o=t.config.fileUpload||{},a=o.enableAttachments,i=o.useSupportedContentProfile,s=(o.modes,(e||{}).errorKey),c="boolean"==typeof a&&!0===a&&"boolean"==typeof i&&!0===i,l=n.errors.generic;if(s)switch(s){case"fileTypeInvalid":l=c?n.errors.fileTypeInvalidMultipleFiles||n.errors.generic:(l=n.errors[s]||n.errors.generic).replace("<%allowedFileTypes%>",r.aAllowedFileTypes);break;case"fileTooLarge":case"fileSizeZero":l=(l=n.errors[s]||n.errors.generic).replace("<%maxFileSizeLimit%>",Object(Ot.f)(r.maxFileSize));break;case"fileNameInvalid":case"fileNameTooLong":case"fileContentInvalid":l=n.errors[s]||n.errors.generic;break;case"messageLengthExceeded":l=(l=n.errors[s]||n.errors.generic).replace("<%maxMessageLength%>",r.maxMessageLength)}return l})),h()(c()(r),"onStartFailed",(function(){var e=r.props,t=(e.i18n,e.conversationStore.error);r.sAlertType="startFailed",r.bPendingConnection?r.props.showAlertDialog(r.oAlerts.startFailed):r.props.showAlertDialog(r.oAlerts.generic),r.oConversation&&r.oConversation.publish("error",{error:t,metadata:r.oMetaData})})),h()(c()(r),"onRestoreFailed",(function(){var e=r.props,t=(e.i18n,e.conversationStore.error);r.sAlertType="restoreFailed",r.props.showAlertDialog(r.generateErrorAlert(t)),r.bRestoreFailed=!0,r.bRestored=!1,r.oConversation&&r.oConversation.publish("error",{error:t,metadata:r.oMetaData})})),h()(c()(r),"onSessionExpired",(function(){r.bSessionActive=!1})),h()(c()(r),"onFetchHistoryFailed",(function(){var e=r.props,t=(e.i18n,e.conversationStore.error);r.sAlertType="fetchHistoryFailed",r.props.showAlertDialog(r.generateErrorAlert(t)),r.oConversation&&r.oConversation.publish("error",{error:t,metadata:r.oMetaData})})),h()(c()(r),"onTextInputFocus",(function(){r.textInput.current&&(r.textInput.current.style.borderTop="1px solid #333")})),h()(c()(r),"onTextInputBlur",(function(){r.textInput.current&&(r.textInput.current.style.borderTop="1px solid #8a8a8a")})),h()(c()(r),"onConversationDisconnected",(function(){var e=((r.props.config.apps||{}).conversations||{}).conversationDisconnect||{},t=e.enabled,n=e.type,o=r.state.bReadOnlySession;t&&n&&(r.bConversationDisconnected||(r.bConversationDisconnected=!0),"ReadOnly"==n&&("boolean"!=typeof o||o||r.setState({bReadOnlySession:!0})))})),h()(c()(r),"onReadOnlySession",(function(){var e=r.props,t=e.config.apps,n=e.conversationStore.readOnly,o=((t||{}).conversations||{}).conversationDisconnect||{},a=o.enabled,i=o.type,s=(r.state.conversationStore||{}).messages,c=r.state.bReadOnlySession,l=!1;if(s&&s.length){var u=s[0],d=u.eventType,p=u.presence;if(d&&"Presence"==d&&p){var g=(p||{}).type;g&&"Disconnect"==g&&(l=!0)}}a&&("ReadOnly"==i||n)&&"boolean"==typeof c&&!c&&l&&r.setState({bReadOnlySession:!0})})),h()(c()(r),"onResetDisconnectSession",(function(){var e=r.state,t=e.bReadOnlySession,n=(e.conversationStore||{}).messages,o=!1;if(n&&n.length){var a=n[0],i=a.eventType,s=a.presence;if(i&&"Presence"==i&&s){var c=(s||{}).type;c&&"Disconnect"==c&&(o=!0)}}o||"boolean"==typeof t&&t&&(r.bConversationDisconnected=!1,r.setState({bReadOnlySession:!1}))})),r.textInput=v.a.createRef(),r.conversationRef=v.a.createRef(),r.inputRef=v.a.createRef(),r.state={inputValue:"",bTyping:!1,file:"",conversationStore:"",prevConversationStore:"",prevMessengerStore:"",prevConfig:"",bShowAgentTyping:!1,bTypingStopped:!1,bReadOnlySession:!1,bCleared:!1},r.bPreviewClosed=!1,r.oDisableInputs=e.oDisableInputs||{},r.sPluginName="Conversations",r.oConversation="",r.sErrorMessage="",r.sAlertType="",r.aAllowedFileTypes=[],r.maxFileSize="",r.onConnectionRestored=r.onConnectionRestored.bind(c()(r)),r.bSessionActive=e.restoring||!1,r.restoring=e.restoring||!1,r.bPendingConnection=!1,r.bRestoreFailed=!1,r.authenticating="",r.bRestored=!1,r.bPreventEvent=!1,r.bConversationDisconnected=!1,r.bResetConversation=!1,r.bDisabledSend=!1,r.childComponent="",r.oMetaData={opened:"",closed:"",started:"",completed:""},r.OverlayNode="";var a=(((e.config||{}).richMedia||{}).quickReply||{}).mode;return r.richMediaOptions={quickReply:{mode:a||"standard"}},r.maxMessageLength=4096,r.oAlerts={generic:{message:e.i18n.errors.generic,primary:e.i18n.okButton,alertType:"generic"},error:{message:"",primary:e.i18n.okButton,alertType:""},startFailed:{message:e.i18n.errors.startFailed,primary:e.i18n.okButton,alertType:"startFailed"}},r}return i()(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.conversationStore,r=n.connection,o=n.status,a=n.resetSession,i=t.open,s=t.config,c=t.getTranscriptComponentMethods,l=t.previousConversationExpired,u=t.verifyStorageAndRemove,d=t.messengerStore,p=t.route,g=t.openConversation,f=t.i18n,m=t.setHomeScreenHeight,h=this.state.bCleared,b=s||{},y=b.apps,x=b.direction,w=(((y||{}).conversations||{}).autoStart||{}).enabled,O=(s.auth||!1).enabled,S=d||{},E=S.route,C=S.file;if(c(this.childComponent),this.registerPlugin(),m&&m({homeScreenHeight:0,bAddTransition:!1}),u(),setTimeout((function(){i&&e.oConversation&&e.oConversation.command("MessengerHelper.setDimension",{conversations:{height:bn.x,width:bn.y,removeClass:["genesys-mxg-homescreen"],addClass:["genesys-mxg-conversation"]}})})),r&&"closed"===r&&this.props.dispatch(ot.reconnect()),"sessionExpired"===o&&(O?this.props.dispatch(ot.restoreAuthSession()):this.props.dispatch(ot.sessionCleared())),w&&O&&this.props.dispatch(ot.openedConversation()),w&&"closed"===r&&!this.bSessionActive&&l&&!a&&this.props.dispatch(ot.connect()),p&&"conversations.conversations"==p&&E&&"conversations.filePreview"==E||"sessionExpired"===o||r&&"closed"===r)g({route:"conversations.conversations"}),this.props.resetRoute();else if(E&&"conversations.filePreview"==E&&C){this.onOpenFilePrev((function(t){return v.a.createElement(io,Xe()({},t,{downloadUrl:C.downloadUrl,size:C.size,name:C.name,mediaType:C.type,mimeType:C.mime,file:C,downloadFile:e.downloadFile,i18n:f,direction:x}))}),C)}this.oConversation&&(this.oConversation.subscribe("Auth.authenticating",(function(){e.authenticating="authenticating"})),this.oConversation.subscribe("Auth.authenticated",(function(){e.authenticating=""})),this.oConversation.subscribe("MessagingService.conversationCleared",(function(){h||e.setState({bCleared:!0})})))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,r=n.open,o=n.bShowAlertDialog,a=n.iHeaderHeight,i=(e||{}).bShowAlertDialog,s=this.state.bTyping;setTimeout((function(){r&&t.oConversation&&!s&&t.oConversation.command("MessengerHelper.setDimension",{conversations:{height:bn.x,width:bn.y,removeClass:["genesys-mxg-homescreen","genesys-mxg-frame-transition"],addClass:["genesys-mxg-conversation"]}})})),(this.bPreviewClosed||i&&i!==o)&&(setTimeout((function(){t.inputRef.current&&t.inputRef.current.focus()}),50),setTimeout((function(){if(t.childComponent){var e="calc(100% - "+t.childComponent.getHeight({iHeaderHeight:a})+"px)";t.childComponent.transcriptRef.current&&(t.childComponent.transcriptRef.current.style.maxHeight=e)}}),200))}},{key:"componentWillUnmount",value:function(){this.oMetaData.closed=(new Date).getTime(),this.oConversation&&this.oConversation.publish("closed",this.oMetaData),this.props.fConversationComponentWillUnmount(this.props.conversationStore),this.props.dispatch(ot.closed()),this.props.enableFocusControls(!0)}},{key:"beforeRender",value:function(){var e=this,t=this.state.prevConversationStore.status,n=(this.state.prevMessengerStore||{}).route,r=(this.state.prevConfig||{}).lang,o=this.props||{},a=o.conversationStore,i=a.status,s=a.message,c=(a.sendingMessage,a.error),l=a.connection,u=a.typingNotification,d=a.resetSession,p=a.readOnly,g=o.messengerStore,f=g.route,m=g.file,h=o.closeMessenger,b=o.i18n,y=(o.openConversation,o.bShowOverlay),x=o.route,w=o.config,O=w.apps,S=w.direction,E=w.lang,C=o.bShowAlertDialog,k=o.closeAlertDialog,R=this.state.bCleared,T=this.state.bShowAgentTyping,j=((O||{}).conversations||{}).showAgentTypingIndicator;if(n&&"conversations.filePreview"===n&&f&&"conversations.conversations"===f&&(this.bPreviewClosed=!0),this.oAlerts={generic:{message:b.errors.generic,primary:b.okButton,alertType:"generic"},error:{message:"",primary:b.okButton,alertType:""},startFailed:{message:b.errors.startFailed,primary:b.okButton,alertType:"startFailed"}},!x&&n&&("conversations.home"===n||"conversations.conversations"===n)&&f&&"conversations.filePreview"==f&&!y&&m){this.onOpenFilePrev((function(t){return v.a.createElement(io,Xe()({},t,{downloadUrl:m.downloadUrl,size:m.size,name:m.name,mediaType:m.type,mimeType:m.mime,file:m,downloadFile:e.downloadFile,i18n:b,direction:S}))}),m)}"pending"===t&&"connecting"===i?this.bPendingConnection=!0:("connecting"===t||"restored"===t||"restoring"===t)&&"connectionFailed"===i||!0===this.props.bShowAlertDialog&&"startFailed"===this.props.sAlertDialogType&&r!==E?this.onStartFailed():"connecting"===t&&"connected"===i||"reconnecting"===t&&"connected"===i||"restoreFailed"===t&&"connected"===i||"requestingUpload"===t&&"connected"===i||"restoring"===t&&"connected"===i||"opened"===t&&"connected"===i||"sessionCleared"===t&&"connected"===i||"allowedfiletypesupdated"===t&&"connected"===i?this.onStarted():"restoring"===t&&"restoreFailed"===i||!0===this.props.bShowAlertDialog&&"restoreFailed"===this.props.sAlertDialogType&&r!==E?this.onRestoreFailed():"connected"===t&&"restored"===i?this.onRestored():"sessionExpired"!==t&&"sessionExpired"===i?(this.onSessionExpired(),C&&k(),h(!0)):t&&"connectionClosed"!==t&&"connectionClosed"===i||"conversationNotFound"===i||R?(C&&k(),h(!0),this.setState({bCleared:!1})):("fetchingHistory"===t&&"fetchHistoryFailed"===i||!0===this.props.bShowAlertDialog&&"fetchHistoryFailed"===this.props.sAlertDialogType&&r!==E)&&this.onFetchHistoryFailed(),"sessionCleared"==i&&d&&"boolean"==typeof d&&l&&"closed"===l&&(this.resetConversation(),this.bSessionActive=!1),c&&Object.keys(c).length&&"restoreFailed"!=c&&"fetchingHistory"!=t&&"fetchHistoryFailed"!==i&&"restoreFailed"!==i&&(!1===this.props.bShowAlertDialog||r!==E)?(this.sAlertType="genericError",this.props.showAlertDialog(this.generateErrorAlert(c))):i&&"connected"===i&&s&&Object.keys(s).length||l&&"opened"===l&&(this.bSessionActive=!0),j&&u&&Object.keys(u).length&&this.onAgentTyping(),u&&!Object.keys(u).length&&T&&this.removeAgentIndicator(),"disconnected"!==t&&"disconnected"==i?this.onConversationDisconnected():"disconnected"==t&&"restored"==i&&this.onResetDisconnectSession(),(i&&"readOnly"==i||p)&&this.onReadOnlySession()}},{key:"render",value:function(){var e=this,t=this.props,n=t.color,r=t.conversationStore,o=t.i18n,a=t.restoring,i=t.headerRef,s=t.config,c=s.fileUpload,l=s.direction,u=s.maxMessageLength,d=s.preview,p=s.cobrowse,g=s.apps,f=t.oDisableInputs,m=t.enableFocusControls,h=t.disableFocusControls,b=t.enableTransition,y=t.awaitMarkdown,x=t.bShowAlertDialog,w=t.overlayNode,O=t.Toaster,S=this.props,E=S.bShowOverlay,C=S.messengerStore,k=this.state,R=k.file,T=k.bShowAgentTyping,j=k.bTypingStopped,D=k.bReadOnlySession,P=r.status,M=r.allowedFileTypes,A=r.maxFileSizeInKB,I=r.allowedMediaPresence,N=r.messages,F=r.sendingMessage,L=(r.pageSize,r.pageNumber,r.files),B=r.error,H=(r.connection,r.connectionStatus),K=r.capabilities,z=r.correctedMessagesOrder,q=r.bRestoring,U=c||{},_=U.enableAttachments,W=U.useSupportedContentProfile,V=U.modes,G="boolean"==typeof _&&!0===_&&"boolean"==typeof W&&!0===W,$="boolean"==typeof _&&!1===_&&"boolean"==typeof W&&!1===W,Y=!!(V&&V.length&&void 0===_||V&&V.length&&"boolean"==typeof _&&!0===_&&("boolean"==typeof W&&!1===W||void 0===W)),Q=(C||{}).route,X=(g||{}).conversations||{},J=X.autoStart,Z=X.markdown,ee=X.conversationDisconnect,te=X.humanize,ne=(te||{}).enabled,re=(J||{}).enabled,oe=(Z||{}).enabled,ae=ee||{},ie=ae.enabled,se=ae.type,ce=!1,le=!1,ue=(K||{}).enableSend,de={color:n};this.OverlayNode=w;var pe=this.OverlayNode,ge=this.inputRef,fe=(this.state.prevConversationStore||{}).status;u&&"number"==typeof u&&(this.maxMessageLength=u),Y&&(this.aAllowedFileTypes&&this.aAllowedFileTypes.length&&(this.aAllowedFileTypes=[]),V.forEach((function(t,n){var r=t.fileTypes,o=t.maxFileSizeKB;r&&(e.aAllowedFileTypes[n]=r),o&&(e.maxFileSize=o*bn.D)}))),this.state.conversationStore&&this.beforeRender(),G?(this.aAllowedFileTypes&&this.aAllowedFileTypes.length&&(this.aAllowedFileTypes=[]),M&&M.length&&(M.includes("*/*")?this.aAllowedFileTypes=["*/*"]:M.forEach((function(t,n){e.aAllowedFileTypes[n]=t}))),this.maxFileSize&&this.maxFileSize.length&&(this.maxFileSize=""),A&&(this.maxFileSize=A*bn.D)):$&&(this.aAllowedFileTypes&&this.aAllowedFileTypes.length&&(this.aAllowedFileTypes=[]),A&&(this.maxFileSize=A*bn.D)),"sending"!==F||"connecting"!==P&&"reconnecting"!==P||(ce=!0),void 0!==fe&&"connecting"!==fe||"connecting"!==P||(ce=!0),"restoring"!==P&&"fetchingHistory"!==P||(ce=!0),"opened"===fe&&"connecting"===P&&(ce=!0),(a||q)&&(ce=!0),x&&(ce=!1);var me=!d&&("offline"===H||"reconnecting"===P),he="";return"reAuthenticating"===P?he=P:this.authenticating&&(he=this.authenticating),"offline"===H?le=!0:"online"===H&&(le=!1),!re||ue||this.bSessionActive?re&&ue&&(this.bDisabledSend=!1,this.bPreventEvent=!1):(ce=!0,this.bDisabledSend=!0,this.bPreventEvent=!0),this.bAttachment=L.name||"",v.a.createElement(St.a,{direction:"left",in:!0,appear:!0,timeout:b?{appear:200,enter:100,exit:0}:0},v.a.createElement(Ut.a,{elevation:0,className:"mxg-conversation",ref:this.conversationRef},v.a.createElement("div",{style:ja},me&&v.a.createElement(Un,{icon:v.a.createElement(ia.a,{fontSize:"small",alt:""}),severity:Ca.severity["reconnecting"===P?P:H]},o.errors[Ca.i18n["reconnecting"===P?P:H]]),he&&v.a.createElement(Un,{severity:Ca.severity[he]},o.info[Ca.i18n[he]]),v.a.createElement("div",null,v.a.createElement(O,{config:this.props.config}))),v.a.createElement("div",{className:"mxg-conversation-container",role:"main"},E&&w&&v.a.createElement(la,{headerRef:i},v.a.createElement(pe,{downloadUrl:R&&R.downloadUrl||L.newDownloadUrl})),v.a.createElement(ea,Xe()({styles:de,messages:N,status:P,getComponentMethods:function(t){return e.childComponent=t},textInputRef:this.textInput,bAutoStartEnabled:re,bConversationDisconnectEnabled:ie,bReadOnlySession:D,disconnectType:se,headerRef:i,showProgress:ce,bShowTyping:T,bTypingStopped:j,i18n:o,bDisableTabStop:E,direction:l,richMediaOptions:this.richMediaOptions,conversationRef:this.conversationRef,cobrowse:p||{},markdownEnabled:oe,awaitMarkdown:y,startNewConversation:this.startNewConversation,correctedMessagesOrder:z,humanizeEnabled:ne,humanizeConfig:ne?te:{},oCallbacks:{onMessageAdded:this.onMessageAdded,fetchHistory:this.fetchHistory,onOpenFilePrev:this.onOpenFilePrev,onErrorLoadingFile:this.onErrorLoadingFile,onMediaLinkExpired:this.onMediaLinkExpired,onMessageSelection:this.sendMessage,downloadFile:this.downloadFile}},r)),!D&&v.a.createElement(Ra,{className:"mxg-input-container ".concat(ka.inputBox," ").concat(this.bAttachment?"mxg-input-attachment":""),ref:this.textInput},v.a.createElement(Pa,{ref:this.textInput,inputRef:ge,sendMessage:this.sendMessage,onAttachment:this.onAttachment,onRemoveAttachment:this.onRemoveAttachment,onhandleMxgInput:this.handleMxgInput,enableAttachments:_,enableMultipleAttachments:W,allowedMediaPresence:I,aFileTypes:this.aAllowedFileTypes,maxFileSize:this.maxFileSize,files:L,color:n,i18n:o,onFocus:this.onTextInputFocus,onBlur:this.onTextInputBlur,autoFocus:!d,previewMode:d,status:P,direction:l,prevStatus:fe,error:B,bPreviewOpened:Q&&"conversations.filePreview"==Q||!1,bPreviewClosed:this.bPreviewClosed,bDisableOffline:le,bDisabledSend:!1,oDisableInputs:f,enableFocusControls:m,disableFocusControls:h,maxMessageLength:this.maxMessageLength})))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{messengerStore:e.messengerStore,conversationStore:e.conversationStore,config:e.config,prevConversationStore:t.conversationStore,prevMessengerStore:t.messengerStore,prevConfig:t.config}}}]),n}(v.a.PureComponent);Ma.propTypes={color:x.a.string,i18n:x.a.object,payload:x.a.object,config:x.a.object.isRequired,dispatch:x.a.func.isRequired,setConvPluginRef:x.a.func.isRequired,convPluginRef:x.a.object,headerRef:x.a.object,fConversationComponentWillUnmount:x.a.func.isRequired,closeMessenger:x.a.func.isRequired,oDisableInputs:x.a.object.isRequired,enableFocusControls:x.a.func,disableFocusControls:x.a.func,enableTransition:x.a.bool.isRequired,verifyStorageAndRemove:x.a.func.isRequired,Toaster:x.a.elementType.isRequired};var Aa=ie((function(e){return{conversationStore:e.conversationStore}}))(function(e){return function(t){return v.a.createElement(wt.a.Consumer,null,(function(n){var r=n.closeMessenger,o=n.oDisableInputs,a=n.disableFocusControls,i=n.enableFocusControls,s=n.verifyStorageAndRemove,c=n.route,l=n.resetRoute,u=n.setHomeScreenHeight,d=n.iHeaderHeight,p=n.bShowAlertDialog,g=n.sAlertDialogType,f=n.showAlertDialog,m=n.closeAlertDialog,h=n.setAlertDialogStatus,b=n.setHeaderDeleteButtonClick,y=n.onHeaderDeleteButtonClick;return v.a.createElement(e,Xe()({},t,{closeMessenger:r,oDisableInputs:o,disableFocusControls:a,enableFocusControls:i,verifyStorageAndRemove:s,route:c,resetRoute:l,setHomeScreenHeight:u,iHeaderHeight:d,bShowAlertDialog:p,sAlertDialogType:g,showAlertDialog:f,closeAlertDialog:m,setAlertDialogStatus:h,setHeaderDeleteButtonClick:b,onHeaderDeleteButtonClick:y}))}))}}(Ma));function Ia(e,t){var n={};return e&&Object.keys(e).forEach((function(r,o){var a=r.split(t),i=Ge()(a,2),s=i[0],c=i[1];c?(n[s]=n[s]||{},n[s][c]=e[r]):n[r]=e[r]})),n}var Na=n(216),Fa=n(33),La=n(14);function Ba(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ba(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ba(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var za=Object(Ot.i)().browser||"",qa=Object(Ot.i)().os||"",Ua=!(!za||"Safari"!==za),_a="iOS"===qa,Wa=!Object(Ot.n)()&&("iOS"===qa||"Mac OS X"===qa||"Android"===qa||"Linux"===qa);Wa=Wa||Object(Ot.m)();var Va=Object(xt.a)("div")((function(e){e.theme;return{overflow:Ua||_a?"hidden":"clip"}})),Ga=Object(Na.a)(),$a=Object(qr.a)(),Ya=function(e){var t=e.config;e.oPlugins.MessagingService||Genesys("loadPlugin","MessagingService",t,(function(){e.setPlugin("MessagingService",{})}))},Qa=et((function(){return Promise.resolve().then(n.bind(null,372))})).KnowledgeSearch,Xa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return xe()(e.querySelectorAll('a, button, input, textarea, select, details,[tabindex]:not([tabindex="-1"])')).filter((function(e){return!e.hasAttribute("disabled")}))},Ja=function(e){u()(n,e);var t=Ka(n);function n(e){var r;o()(this,n),r=t.call(this,e),h()(c()(r),"onConfirmChat",(function(e){e.preventDefault(),r.props.dispatch(tt.confirmChat({route:"conversations.registration"}))})),h()(c()(r),"onSubmit",(function(e){e.preventDefault(),Ya(r.props)})),h()(c()(r),"onFilePreviewOpened",(function(e){var t=e.imagePrevComp;r.props.dispatch(tt.openPreview(e)),r.OverlayNode=t,r.setState((function(){return{bShowOverlay:!0}}))})),h()(c()(r),"handleNavigation",(function(e){var t=(e||{}).route;r.slideDirection="backward",r.bBackwardDirection=!0,t&&"conversations.home"==t?r.props.dispatch(tt.navigateToHome()):(r.props.verifyStorageAndRemove().then((function(){r.props.dispatch(tt.navigateBack())})),"conversations.filePreview"==r.route&&(r.OverlayNode="",r.props.resetRoute(),r.setState((function(){return{bShowOverlay:!1}}))))})),h()(c()(r),"expandMessenger",(function(){r.bCollapsed=!1,(0,r.props.setArticleExpanded)(!0),r.props.oMessenger.command("MessengerHelper.setDimension",{conversations:{height:bn.v,width:bn.w,addClass:["genesys-mxg-expand","genesys-mxg-frame-transition"]}})})),h()(c()(r),"collapseMessenger",(function(){r.bCollapsed=!0,(0,r.props.setArticleExpanded)(!1),r.props.oMessenger.command("MessengerHelper.setDimension",{conversations:{height:bn.x,width:bn.y,removeClass:["genesys-mxg-expand"]}})})),h()(c()(r),"openConversation",(function(e){var t=e.route;r.OverlayNode="",r.state.bShowOverlay&&r.setState((function(){return{bShowOverlay:!1}})),r.props.dispatch(tt.openConversations({route:t}))})),h()(c()(r),"openSearch",(function(e){var t=e.route;r.props.dispatch(nt({route:t}))})),h()(c()(r),"navigateToHome",(function(){r.props.dispatch(tt.navigateToHome({route:"conversations.home"}))})),h()(c()(r),"onError",(function(e){var t=r.props.oPlugins,n=e||{},o=n.errorKey,a=n.errorMessage,i=t.Knowledge||{},s={errorName:o||"Error",errorMessage:a||La.v};Object(Fa.a)(s),i&&Object.keys(i).length&&i.publish("error",e)})),h()(c()(r),"fCLauncherClose",(function(){r.props.dispatch(ot.end())})),h()(c()(r),"fConversationStore",(function(e){r.conversationStore=e})),h()(c()(r),"fSetHeaderDeleteButtonClick",(function(e){r.props.setHeaderDeleteButtonClick((function(){var t=c()(r);t.props.showAlertDialog({message:e.alert.confirmClearConversation,primary:e.sureButton,secondary:e.cancelButton,preventDefault:!0,alertType:"clearConversation",onPrimary:function(e){t.props.setAlertDialogStatus("progress"),t.props.dispatch(ot.clearConversation())},onSecondary:function(e){t.props.closeAlertDialog()}})}))})),h()(c()(r),"getMarkdown",(function(e){return new Promise((function(t,n){Genesys("command","Markdown.parse",{text:e},(function(e){e&&t(e)}),(function(e){n(e)}))}))})),h()(c()(r),"awaitMarkdown",function(){var e=Ye()(Ze.a.mark((function e(t){var n,o,a,i,s;return Ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||t.length){e.next=4;break}r.markdownMessages=[],e.next=13;break;case 4:return n=t.map(function(){var e=Ye()(Ze.a.mark((function e(t){var n,o;return Ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t||{}).text,!t||!n){e.next=8;break}return e.next=4,r.getMarkdown(n);case 4:return o=e.sent,e.abrupt("return",t=Ha(Ha({},t),{},{text:o}));case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=7,Promise.all(n);case 7:if(o=e.sent,a=r.props||{},i=a.conversationStore,s=i.messages,!(o&&o.length||!s.length)){e.next=13;break}return o.map((function(e){if(e&&e.id&&e.updatedTime&&Object(vn.a)(r.markdownMessages,"id",e.id)){var t=s.findIndex((function(t){return t.id===e.id}));r.markdownMessages.splice(t,1,e)}if(e&&e.timestamp&&!Object(vn.a)(r.markdownMessages,"timestamp",e.timestamp)){var n=s.findIndex((function(t){return t.timestamp===e.timestamp}));r.markdownMessages.splice(n,0,e)}})),e.abrupt("return",r.markdownMessages);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),h()(c()(r),"onTransitionEnd",(function(e,t){var n=r.props,o=n.open,a=n.oLauncher;o||a.command("MessengerHelper.setDimension",{conversations:{width:0,height:0,removeClass:["genesys-mxg-conversation"]}})})),h()(c()(r),"fConversationComponentWillUnmount",(function(e){var t=c()(r);r.transcriptComponent="",setTimeout((function(){t.props.fStore({conversationStore:e,messengerStore:t.messengerStore}),t.onTransitionEnd()}))})),h()(c()(r),"expandHeader",(function(){var e=(r.props.config||{}).home;return Ot.b[r.route]?Ot.b[r.route].expandHeader:!!e})),h()(c()(r),"backButton",(function(e,t){var n=!1;return"conversations.filePreview"===r.route&&(n=Ot.b[r.route].backButton),(t||e)&&(n=!!Ot.b[r.route]&&Ot.b[r.route].backButton),n})),h()(c()(r),"deleteButton",(function(){var e=r.props.config||{},t=e.apps,n=(e.route,(((t||{}).conversations||{}).conversationClear||{}).enabled),o=(r.props.conversationStore||{}).messages,a=!1;return n&&Ot.b[r.route]&&Ot.b[r.route].deleteButton&&(o&&o.length||r.markdownMessages.length)&&(a=!0),a})),h()(c()(r),"closeButton",(function(){return!!Ot.b[r.route]&&Ot.b[r.route].closeButton})),h()(c()(r),"showHeaderTitle",(function(){var e=(r.props.config||{}).home;return Ot.b[r.route]?Ot.b[r.route].showHeaderTitle:!!e})),h()(c()(r),"showHeaderSubTitle",(function(){var e=(r.props.config||{}).home;return Ot.b[r.route]?Ot.b[r.route].showHeaderSubTitle:!!e})),h()(c()(r),"resetKnowledgeState",(function(){r.setKnowledgeStore({inputValue:""}),r.setState((function(){return{bShowProgress:!1,knowledge:{results:{}}}}))})),h()(c()(r),"showKnowledgeResults",(function(e,t){r.setKnowledgeStore({inputValue:t}),r.props.dispatch({type:"RESET_CATEGORIES"}),r.setState((function(){return{bShowProgress:!1,knowledge:{results:e}}}))})),h()(c()(r),"showProgress",(function(){r.setState((function(){return{bShowProgress:!0}}))})),h()(c()(r),"stopProgress",(function(){r.setState((function(){return{bShowProgress:!1}}))})),h()(c()(r),"setKnowledgeStore",(function(e){r.knowledgeStore=Ha(Ha({},r.knowledgeStore),e)})),h()(c()(r),"setKnowledgePlugin",(function(e,t){t&&r.props.setPlugin(e,t)})),h()(c()(r),"onHeaderUpdated",(function(e){var t=(e||{}).height;r.props.onHeaderUpdated(e),r.transcriptComponent&&r.transcriptComponent.updateComponent({iHeaderHeight:t})})),h()(c()(r),"handleSearchContentNavigation",(function(e){var t=e||{},n=t.which,o=t.target,a=t.shiftKey;switch(n||""){case 9:if(r.knowledgeWrapperRef.current&&o){var i=r.knowledgeWrapperRef.current.querySelectorAll('*[tabindex="0"]');if(a&&i.length&&o==i[0]){if(r.knowledgeSearchBoxRef.current){e.preventDefault();var s=r.knowledgeSearchBoxRef.current.querySelectorAll('*[tabindex="0"]');s&&s.length?s[s.length-1].focus():r.knowledgeSearchBoxRef.current.querySelector("input").focus()}else if(r.headerRef&&r.headerRef.current){var c=r.headerRef.current.querySelectorAll('*[tabindex="0"]');c&&c.length&&(e.preventDefault(),c[c.length-1].focus())}}else!a&&i.length&&o==i[i.length-1]&&(e.preventDefault(),r.props.launcherRef&&r.props.launcherRef.current&&r.props.launcherRef.current.focus())}}})),h()(c()(r),"handleSearchBoxNavigation",(function(e){var t=(e||{}).which||"";if(t&&9===t&&r.knowledgeWrapperRef&&r.knowledgeWrapperRef.current){var n=r.knowledgeWrapperRef.current.querySelectorAll('*[tabindex="0"]');n&&n.length&&(e.preventDefault(),n[0].focus())}})),h()(c()(r),"isHeaderUpdated",(function(e){r.state.bHeaderUpdated!==e&&r.setState({bHeaderUpdated:e})})),h()(c()(r),"BodyView",(function(e){var t=r.props,n=t.config,o=t.oPlugins,a=(e||{}).oKnowledgeI18n,i=(((n||{}).apps||{}).knowledge||{}).enabled;switch(r.route){case"knowledge.category":case"knowledge.search":return v.a.createElement(v.a.Fragment,null,i&&v.a.isValidElement(v.a.createElement(Qa,null))&&v.a.createElement(b.Suspense,{fallback:v.a.createElement(zt.a,{rows:1,heights:[20,140]})},v.a.createElement(Qa,{showResults:r.showKnowledgeResults,showProgress:r.showProgress,stopProgress:r.stopProgress,config:n,setStore:r.setKnowledgeStore,store:r.knowledgeStore||{},setPlugin:r.setKnowledgePlugin,plugin:o.Knowledge||"",i18n:a,onError:r.onError,knowledgeSearchBoxRef:r.knowledgeSearchBoxRef,handleSearchBoxNavigation:r.handleSearchBoxNavigation,utility:{isMobile:Ot.n,getBrowserandOS:Ot.i}})));default:return null}}));var a=e||{},i=a.data,s=((a.oContextStore||{}).knowledge||{}).results,l=((i||{}).journeyContext||{}).customer,u=(e.config||{}).deploymentId;return r.state={bShowRegForm:!0,iRenderCount:1,knowledge:{results:s||{}},bShowProgress:!1,bHeaderUpdated:!1,bShowOverlay:!1},r.restoring=!1,r.bBackwardDirection=!1,r.bReconnectAfterAutoClose=!1,r.bReconnecting=!1,r.bAutoClosed=!1,r.bUpdateDeleteDialog=!1,r.OverlayNode="",r.conversationStore={},r.knowledgeStore={inputValue:null,customerId:l&&l.id||""},r.headerRef=Object(b.createRef)(),r.messengerRef=Object(b.createRef)(),r.messengerContainerRef=Object(b.createRef)(),r.homeRef=Object(b.createRef)(),r.knowledgeWrapperRef=Object(b.createRef)(),r.knowledgeSearchBoxRef=Object(b.createRef)(),r.transcriptComponent="",r.markdownMessages=[],r.messengerStorage=u?u+":gcmc":"_gcmc",r.subOpenStorage="opn",r.bActivePrevConv=e.activePreviousConversation,r.handleTabKey=r.handleTabKey.bind(c()(r)),r.updateHeight=r.updateHeight.bind(c()(r)),r.slideDirection=null,r.sSlideInLeft="left",r.sSlideInRight="right",r.bCollapsed=!1,r}return i()(n,[{key:"updateView",value:function(){var e=this.props,t=e.messengerStore,n=e.config,r=e.setView,o=n||{},a=o.apps,i=o.home,s=(o.theme||{}).direction,c=((a||{}).knowledge||{}).enabled,l=(t||{}).route,u=l&&l.split("."),d=Ge()(u,3);this.app=d[0],this.view=d[1],this.subView=d[2],r&&r(this.view),"rtl"===s&&(this.sSlideInLeft="right",this.sSlideInRight="left"),this.route=c||i||"conversations.filePreview"===l?"".concat(this.app,".").concat(this.view):"conversations.conversations";var p=this.route.split("."),g=Ge()(p,2);switch(this.app=g[0],this.view=g[1],this.slideDirection=null,this.view){case"home":this.slideDirection="backward",this.bBackwardDirection=!1;break;case"conversations":this.slideDirection="forward";break;case"category":case"search":0==this.bBackwardDirection&&(this.slideDirection="forward");break;case"article":this.slideDirection=null}}},{key:"updateHeight",value:function(){this.setState((function(e){return{iRenderCount:e.iRenderCount++}})),Object(Ot.n)()||document.removeEventListener("keydown",this.handleTabKey,!1)}},{key:"handleTabKey",value:function(e){var t,n,r,o,a;9===e.keyCode&&(t=this.messengerContainerRef.current,n=e,o="",a="",o=(r=Xa(t))[0],a=r[r.length-1],n.shiftKey?document.activeElement===o&&(a.focus(),n.preventDefault()):document.activeElement===a&&(o.focus(),n.preventDefault()))}},{key:"shouldComponentUpdate",value:function(e,t){var n=e||{},r=n.conversationStore,o=n.config,a=this.props||{},i=a.conversationStore,s=a.open,c=a.messengerClosed,l=a.config,u=i||{},d=u.status,p=u.previousStatus,g=u.prevStatus,f=r||{},m=f.status,h=f.previousStatus,b=f.prevStatus,v=f.connection,y=(l||{}).apps,x=(o||{}).apps;if(y&&x){var w=(y||{}).conversations,O=(x||{}).conversations,S=(w||{}).enabled,E=(O||{}).enabled;this.bRegEnabled=w&&w.form,"boolean"!=typeof E||S===E||this.bRegEnabled||(Ya(e),this.props.store&&E&&this.props.dispatch(ot.openWithStore(this.props.store)))}return("connectionClosed"===d||"closed"===d||"closed"!==v)&&("closed"===p||g&&"closed"===g)&&"connectionClosed"===m&&("closed"===h||b&&"closed"===b)&&!c&&s?this.bReconnectAfterAutoClose=!1:!this.bAutoClosed&&s&&(this.bReconnectAfterAutoClose=!0),!0}},{key:"componentDidMount",value:function(){var e=this.props||{},t=e.open,n=(e.messengerClosed,e.conversationStore),r=e.config,o=e.oMessenger,a=e.closeAlertDialog,i=r.i18n,s=r.lang,c=(n||{}).status,l=(r.auth||!1).enabled,u=Ia(i[s].conversations,".");if(Ga.messengerOpen(),this.props.getComponentMethods(this),this.props.setClick(this.fCLauncherClose),t&&this.props.oMessenger.publish("opened"),window.addEventListener("orientationchange",this.updateHeight),window.addEventListener("resize",this.updateHeight),o&&o.subscribe("MessagingService.conversationCleared",(function(){a()})),this.fSetHeaderDeleteButtonClick(u),Object(Ot.n)()){var d=this;this.headerRef.current&&setTimeout((function(){d.updateHeight()}),100)}"sessionExpired"===c&&(l?this.props.dispatch(ot.restoreAuthSession()):this.props.dispatch(ot.sessionCleared()))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props||{},r=n.open,o=n.oMessenger,a=n.activePreviousConversation,i=n.conversationStore,s=n.messengerClosed,c=n.route,l=n.config,u=i||{},d=u.status,p=u.previousStatus,g=u.connection,f=e||{},m=f.open,h=f.conversationStore,b=f.config,v=(h||{}).connection,y=(b||{}).lang,x=l||{},w=x.lang,O=x.i18n;if(w&&"string"==typeof w&&y&&"string"==typeof y)if(w!==y){var S=Ia(O[w].conversations,".");this.bUpdateDeleteDialog=!0,this.fSetHeaderDeleteButtonClick(S)}else this.bUpdateDeleteDialog&&(this.bUpdateDeleteDialog=!1,!0===this.props.bShowAlertDialog&&"clearConversation"===this.props.sAlertDialogType&&this.props.onHeaderDeleteButtonClick());if(c)switch(c){case"conversations.conversations":this.props.resetRoute()}Object(Ot.n)()?document.addEventListener("keydown",this.handleTabKey,!1):document.removeEventListener("keydown",this.handleTabKey,!1),a&&(this.bAutoClosed||r)&&"closed"===g&&"closed"===v&&(this.bReconnectAfterAutoClose||r)?(this.bAutoClosed=!1,this.bReconnecting||(this.bReconnecting=!0,this.props.dispatch(ot.reconnect()))):!this.bAutoClosed&&r&&"opened"===v&&"closed"===g&&"connectionClosed"===d?(this.bAutoClosed=!0,this.bReconnectAfterAutoClose=!1,this.fConversationComponentWillUnmount(i),this.props.closeMessenger(!0),this.bReconnecting&&(this.bReconnecting=!1)):s||"conversationNotFound"!==d&&("sessionExpired"===p||"sessionExpired"!==d)||(this.props.dispatch(ot.sessionCleared()),this.props.closeMessenger(!0),this.bReconnecting&&(this.bReconnecting=!1)),r&&r!=m&&o.publish("opened"),!r&&m&&r!=m&&($a.messengerClosed(),o.publish("closed"),Object(Ot.n)()&&document.removeEventListener("keydown",this.handleTabKey,!1))}},{key:"componentWillMount",value:function(){var e=this.props.config,t=e.apps;e.data;if(t){var n=(t||{}).conversations,r=(n||{}).enabled;this.bRegEnabled=n&&n.form,n&&r&&!this.bRegEnabled&&Ya(this.props),this.props.store&&this.props.dispatch(ot.openWithStore(this.props.store))}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.setContextStore,n=e.open,r=e.oMessenger,o=this.state.knowledge;window.removeEventListener("orientationchange",this.updateHeight),window.removeEventListener("resize",this.updateHeight),o&&t({knowledge:o}),this.props.getComponentMethods(null),n&&($a.messengerClosed(),r.publish("closed"),Object(Ot.n)()&&document.removeEventListener("keydown",this.handleTabKey,!1))}},{key:"render",value:function(){var e=this,t=this.props,n=t.color,r=t.open,o=t.fabVisible,a=t.config,i=t.setConvPluginRef,s=t.convPluginRef,c=t.conversationStore,l=t.messengerStore,u=t.toggleLauncher,d=t.logoutMessenger,p=t.data,g=t.oMessenger,f=t.setContextStore,m=t.route,h=t.sOSBrowser,b=t.Toaster,y=t.bFabVisible,x=a.home,w=a.apps,O=(a.registration,a.i18n),S=a.lang,E=a.fullScreen,C=w||{},k=C.conversations,R=C.knowledge,T=(k||{}).enabled,j=-1!==h.indexOf("mxg-mobile"),D=(R||{}).enabled;tt.setConfig(a),this.updateView(),f({conversationStore:c,messengerStore:l});var P=(!!x||!!D)&&("home"===this.view||"search"===this.view||"article"===this.view||"category"===this.view||m&&"knowledge.search"===m),M=!!T,A=(!this.route||this.route,O[S]),I=Ia(O[S].knowledge,"."),N=Ia(O[S].conversations,"."),F=A[this.view]||A[this.app],L=c||{},B=L.status,H=L.previousStatus,K=L.bRestoring;return this.storage=Object(Ot.j)(a),M&&this.bActivePrevConv&&("restoring"===H&&("connected"===B||"allowedfiletypesupdated"===B)||"connected"===H&&"restored"===B||"disconnected"===H&&"restored"===B||"opened"===H&&"restoring"===B||K)&&(this.restoring=!0,this.bActivePrevConv=!1,g.command(this.storage+".get",{name:this.messengerStorage+this.subOpenStorage}).then((function(t){if(t){var n=t.split(":"),o=Ge()(n,1)[0];o&&"string"==typeof o&&("true"!=o||r||(u(),e.props.dispatch(tt.openConversations({route:"conversations.conversations"}))))}}))),M||"conversations"!=this.view||(x||D)&&this.props.dispatch(tt.navigateToHome()),("restored"===B||"connected"===H&&"restoreFailed"===B)&&(this.restoring=!1),this.restoring&&("allowedfiletypesupdated"===H&&"restoreFailed"===B||"restoreFailed"===H&&"connected"===B)&&(this.restoring=!1),"connected"!==H&&"restored"!==H||"logout"!==B||g.command("LocalStorage.get",{name:this.messengerStorage+this.subOpenStorage}).then((function(e){if(e){var t=e.split(":"),n=Ge()(t,1)[0];n&&"string"==typeof n&&("true"==n||r)&&d()}})),"closed"===H&&"logout"===B&&(r||y)&&d(),r&&v.a.createElement(_t.a,Xe()({maxWidth:"sm",className:"cx-messenger-container ".concat(o?"cx-messenger-with-fab":""," ").concat(E?"mxg-fullscreen":""," ").concat(Wa&&!E&&Object(Ot.m)()&&j?"cx-mxg-tablet-landscape":""," ").concat(Wa&&!E?"cx-messenger-tablet":"").concat(this.view&&"home"==this.view?" cx-mxg-homescreen":""),ref:this.messengerContainerRef},Object(Ot.n)()?{"aria-modal":!0}:{}),v.a.createElement(qt.a,{in:r,timeout:r?"auto":0,addEndListener:this.onTransitionEnd},v.a.createElement(Ut.a,{elevation:2,sx:function(t){return{"&.Cx-MuiPaper-root":{background:"linear-gradient("+t.palette[e.props.color].main+", rgba(0, 0, 0, 0.84) 200%)"}}},ref:this.messengerRef,className:r?"cx-messenger":""},v.a.createElement(en,{container:this.messengerRef,status:this.props.sAlertDialogStatus,color:this.props.color}),P?v.a.createElement(Bn,{knowledgeEnabled:D,knowledge:this.state.knowledge,showProgress:this.state.bShowProgress,config:a,setKnowledgePlugin:this.setKnowledgePlugin,setKnowledgeStore:this.setKnowledgeStore,awaitMarkdown:this.awaitMarkdown,knowledgeStore:this.knowledgeStore,plugins:this.props.oPlugins,slideDirection:this.slideDirection,Toaster:b,i18n:{knowledge:I,conversations:N},onError:this.onError,knowledgeWrapperRef:this.knowledgeWrapperRef,handleSearchContentNavigation:this.handleSearchContentNavigation,homeScreenRef:this.homeRef,headerRef:this.headerRef,color:n,sOSBrowser:this.props.sOSBrowser,updateHomeHeight:this.state.bHeaderUpdated,resetKnowledgeState:this.resetKnowledgeState,bTablet:Wa,bConversationApp:M,openConversation:this.openConversation}):M&&r&&v.a.createElement(Aa,{open:r,color:n,previousConversationExpired:this.props.previousConversationExpired,restoring:!!this.restoring,payload:p,config:a,i18n:N,setConvPluginRef:i,overlayNode:this.OverlayNode,bShowOverlay:this.state.bShowOverlay,onFilePreviewOpened:this.onFilePreviewOpened,openConversation:this.openConversation,convPluginRef:s,awaitMarkdown:this.awaitMarkdown,headerRef:this.headerRef,enableTransition:P||!!D,fConversationComponentWillUnmount:this.fConversationComponentWillUnmount,messengerStore:l,getTranscriptComponentMethods:function(t){return e.transcriptComponent=t},Toaster:b}),r&&v.a.createElement(Kt,{title:F.headerTitle,subTitle:F.headerSubTitle,ariaBack:N.ariaBackButton,ariaExpand:N.ariaExpandButton,ariaClose:N.ariaCloseAttachmentButton,ariaDeleteTitle:N.ariaActionsClearButtonTitle,ariaDeleteLabel:N.ariaActionsClearButtonLabel,color:n,expand:this.expandHeader(),deleteButton:this.deleteButton(),handleDeleteButton:this.onHeaderDeleteButtonClick,backButton:this.backButton(x,D),closeButton:this.closeButton(),showHeaderTitle:this.showHeaderTitle(),showHeaderSubTitle:this.showHeaderSubTitle(),handleNavigation:this.handleNavigation,expandMessenger:this.expandMessenger,collapseMessenger:this.collapseMessenger,config:a,ref:this.headerRef,onHeaderUpdated:this.onHeaderUpdated,ariaMinimize:N.ariaMinimizeButton,launcherRef:this.props.launcherRef,route:this.route,i18n:O,slideDirection:this.slideDirection,homeScreenRef:this.homeRef,messengerRef:this.messengerContainerRef,isHeaderUpdated:this.isHeaderUpdated,bTablet:Wa},D&&("search"===this.view||"category"===this.view)&&v.a.createElement(Va,null,v.a.createElement(St.a,{direction:"forward"==this.slideDirection?this.sSlideInLeft:this.sSlideInRight,in:!0,appear:!0,mountOnEnter:!0,unmountOnExit:!0},v.a.createElement("div",null,this.BodyView({oKnowledgeI18n:I}))))))),v.a.createElement("div",{role:"alert",className:"cx-messenger-screen-reader","aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",tabIndex:-1,"aria-label":function(){var t="";if(x&&"home"===e.view){var n=F||{},r=n.ariaHomeScreenOpenStatus,o=n.headerTitle,a=n.headerSubTitle;t=r||"",e.showHeaderTitle()&&e.showHeaderSubTitle()&&(t="".concat(t," ").concat(o," ").concat(a))}else if("conversations"===e.view){t=(N||{}).ariaMessengerOpenStatus||""}else if(D){var i=I||{},s=i.ariaKnowledgeScreenOpenStatus,c=i.ariaArticleScreenOpenStatus;"search"===e.view?t=s||"":"article"===e.view&&(t=c||"")}return t}()}))}}]),n}(v.a.Component);Ja.propTypes={open:x.a.bool.isRequired,fabVisible:x.a.bool.isRequired,dispatch:x.a.func.isRequired,color:x.a.string.isRequired,config:x.a.object,setClick:x.a.func.isRequired,setConvPluginRef:x.a.func.isRequired,convPluginRef:x.a.object,data:x.a.object,fStore:x.a.func.isRequired,store:x.a.object,oMessenger:x.a.object,launcherRef:x.a.object,oPlugins:x.a.object.isRequired,setPlugin:x.a.func.isRequired,getComponentMethods:x.a.func.isRequired,setContextStore:x.a.func.isRequired,oContextStore:x.a.object.isRequired,sAlertDialogStatus:x.a.string};var Za=ie((function(e){return{messengerStore:e.messengerStore,conversationStore:e.conversationStore}}))(function(e){return function(t){return v.a.createElement(wt.a.Consumer,null,(function(n){var r=n.toggleLauncher,o=n.closeMessenger,a=n.logoutMessenger,i=n.oPlugins,s=n.resetRoute,c=n.setPlugin,l=n.setContextStore,u=n.oContextStore,d=n.setArticleExpanded,p=n.expandedArticle,g=n.route,f=n.setView,m=n.verifyStorageAndRemove,h=n.sAlertDialogStatus,b=n.onHeaderDeleteButtonClick,y=n.setHeaderDeleteButtonClick,x=n.onHeaderUpdated,w=n.showAlertDialog,O=n.closeAlertDialog,S=n.sAlertDialogType,E=n.bShowAlertDialog,C=n.setAlertDialogStatus,k=n.bFabVisible;return v.a.createElement(e,Xe()({},t,{toggleLauncher:r,closeMessenger:o,logoutMessenger:a,oPlugins:i,setPlugin:c,setContextStore:l,oContextStore:u,setArticleExpanded:d,expandedArticle:p,resetRoute:s,route:g,setView:f,verifyStorageAndRemove:m,sAlertDialogStatus:h,onHeaderDeleteButtonClick:b,setHeaderDeleteButtonClick:y,onHeaderUpdated:x,showAlertDialog:w,closeAlertDialog:O,sAlertDialogType:S,bShowAlertDialog:E,setAlertDialogStatus:C,bFabVisible:k}))}))}}(Ja));function ei(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var ti=function(e){u()(n,e);var t=ei(n);function n(e){var r;o()(this,n),r=t.call(this,e),h()(c()(r),"openConversation",(function(e){var t=(r.messengerProps||{}).openConversation;t&&t(e)})),h()(c()(r),"openSearch",(function(e){var t=(r.messengerProps||{}).openSearch;t&&t(e)}));var a=e.store;return r.messengerProps="",a&&Object.keys(a).length?r.store=We({conversationStore:a.conversationStore||void 0}):r.store=We(),r}return i()(n,[{key:"componentDidMount",value:function(){this.props.getComponentMethods(this)}},{key:"componentWillUnmount",value:function(){this.props.getComponentMethods(null)}},{key:"render",value:function(){var e=this;return v.a.createElement(R,{store:this.store},v.a.createElement(Za,{open:this.props.open,activePreviousConversation:this.props.activePreviousConversation,previousConversationExpired:this.props.previousConversationExpired,messengerClosed:this.props.messengerClosed,closeMessenger:this.props.closeMessenger,fabVisible:this.props.fabVisible,color:this.props.color,config:this.props.config,setClick:this.props.setClick,convPluginRef:this.props.convPluginRef,setConvPluginRef:this.props.setConvPluginRef,data:this.props.data,fStore:this.props.fStore,store:this.props.store,Toaster:this.props.Toaster,oLauncher:this.props.oLauncher,oMessenger:this.props.oMessenger,launcherRef:this.props.launcherRef,getComponentMethods:function(t){return e.messengerProps=t},sOSBrowser:this.props.sOSBrowser}))}}]),n}(v.a.Component);ti.propTypes={open:x.a.bool.isRequired,activePreviousConversation:x.a.bool.isRequired,previousConversationExpired:x.a.bool,fabVisible:x.a.bool.isRequired,color:x.a.string.isRequired,config:x.a.object,setClick:x.a.func.isRequired,convPluginRef:x.a.object,setConvPluginRef:x.a.func.isRequired,data:x.a.object,fStore:x.a.func.isRequired,store:x.a.object,oLauncher:x.a.object,oMessenger:x.a.object,launcherRef:x.a.object,getComponentMethods:x.a.func.isRequired};t.default=ti}}]);